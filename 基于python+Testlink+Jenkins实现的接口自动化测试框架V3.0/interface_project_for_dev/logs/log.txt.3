2016-11-30 12:08:56,666 InterfaceUnittestTestCase.py[line: 54] INFO: 服务器返回结果"响应体(body)": 





<!DOCTYPE html>
<link rel="stylesheet" href="/css/bind/banner.css?v=3.8.0-ab8ee" />  
<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
	<meta name="format-detection" content="telephone=no">
	<title>深圳云移</title>
	<link rel="stylesheet" href="/common/css/common-pc.css?v=3.8.0-ab8ee">
	<link rel="stylesheet" href="/component/swiper/css/swiper.css?v=3.8.0-ab8ee">
	<link rel="stylesheet" href="/css/malls/detail.css?v=3.8.0-ab8ee">
</head>
<body>
	<div class="wrapper">

		<!-- banner滚图 -->
		<div class="banner j-banner">
			<div class="swiper-container j-swiper-container">
			  	<div class="swiper-wrapper j-swiper-wrappper"></div>
			</div>
			<div class="pagination"></div>
		</div>

		<!-- 详细商品信息 -->
		<div class="message j-message"></div>

		<!-- 已选 -->
		<div class="choice j-choice dn">
			<span class="key j-choice-key">请选择商品规格</span>
			<span class="value j-choice-value"></span>
			<i class="arrow"></i>
		</div>

		<!-- 图文详情 -->
		<div class="pic-detail j-pic-detail dn">
			<div class="bottom-details">
			</div>
		</div>

		<!-- 选择规格 -->
		<div class="specification j-specification">

			<div class="wrap j-wrap">
				<i class="close j-close"></i>
				<!-- 商品信息 -->
				<div class="mes-wrap">
					<div class="mes j-mes">
						<!-- <img src="" height="160" width="214" alt="" class="pic">
						<div class="describe">
							<h3 class="title">￥<span class="j-price">345</span></h3>
							<p class="text">爱上邓丽君可拉伸的房间爱老师肯定放假阿斯蒂芬阿斯蒂芬</p>
						</div> -->
					</div>
				</div>

				<div class="j-type-num">
					<!-- 规格选择 -->
					<!-- <div class="type">
						<h3 class="title">规格选择</h3>
						<ul class="lists j-type">
							<li data="22"class="item j-item" price="22">颜色</li>
						</ul>
					</div> -->

					<!-- 购买数量 -->
					<div class="num cf">
						<h3 class="title">购买数量</h3>
						<div class="box" unselectable="on" style="-moz-user-select:none;-webkit-user-select:none;" onselectstart="return false;">
							<i class="reduce j-reduce" unselectable="on" style="-moz-user-select:none;-webkit-user-select:none;" onselectstart="return false;">-</i><input type="text" class="text j-text" readonly value="1" unselectable="on" style="-moz-user-select:none;-webkit-user-select:none;" onselectstart="return false;"/><i class="add j-add" unselectable="on" style="-moz-user-select:none;-webkit-user-select:none;" onselectstart="return false;">+</i>
						</div>
					</div>
				</div>

				<!-- 确定按钮 -->
				<a class="sure j-sure">确定</a>
			</div>
		</div>

		<!-- 底部固定栏 -->
		<footer class="footer j-footer">
			<a href="/cart?serial=10549840601068216320" class="cart ">
				<span class="num j-cart-num"></span>
			</a>
			<span class="add-cart j-add-cart">加入购物车</span>
			<span class="buy buy-imdtly j-buy-imdtly">立即购买</span>
		</footer>

		<!-- 提示弹窗 -->
		<div class="popup j-popup">
			<p class="text j-tip-content"></p>
		</div>

	</div>
	<script type="text/javascript">
		// changed by huangtao
		var mallGoodStandardType = "", // 商品类型，1为单规格，2为双规格
			mallGoodsId = "",
			ctx = "",
			serial = "10549840601068216320";
	</script>

	<script src="/plugin/zepto/js/zepto.min.js?v=3.8.0-ab8ee"></script>
	<script src="/common/js/request.js?v=3.8.0-ab8ee"></script>
	<script src="/common/js/extend-number.js?v=3.8.0-ab8ee"></script>
	<script src="/component/iscroll/js/iscroll.js?v=3.8.0-ab8ee"></script>
	<script src="/component/swiper/js/swiper.min.js?v=3.8.0-ab8ee"></script>
	<script src="/js/malls/detail.js?v=3.8.0-ab8ee"></script>
</body>
</html>
2016-11-30 12:08:56,671 InterfaceUnittestTestCase.py[line: 55] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:09:00 GMT'), ('Content-Type', 'text/html;charset=UTF-8'), ('Content-Length', '3931'), ('Connection', 'close'), ('Set-Cookie', 'JSESSIONID=BAB7ABF0C3A39B00AA17D7D1A11ADB85; Path=/; HttpOnly'), ('Content-Language', 'en-US')]
2016-11-30 12:08:56,671 InterfaceUnittestTestCase.py[line: 56] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:08:56,671 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为：立即购买
2016-11-30 12:08:56,671 unittesttestcase.py[line: 292] WARNING: 未检测到从服务器返回中提取内容的要求，请检查是否正确填写预期结果
2016-11-30 12:08:56,672 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:08:56,672 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="get", runtime="2016-11-30 12:08:56",step_action="{'参数': {'serial': '10549840601068216320', 'id': 26838}, 'url': '/goods/item?', '方法': 'get'}", expected_results="{'匹配规则': '包含字符串', '检查': 'body', '条件': [{'模式': '立即购买', '消息': '点击商品时无法打开购买页面'}]}" WHERE executed_history_id = 20161130120835 AND testcase_id = 80 AND step_id = 82 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:08:56,674 testcase.py[line: 163] INFO: 测试用例[id=80, name=test-n-点击商品]执行成功
2016-11-30 12:08:56,674 testplan.py[line: 76] INFO: 正在更新用例执行结果
2016-11-30 12:08:56,674 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 12:08:56" WHERE executed_history_id = 20161130120835 AND testcase_id = 80 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:08:56,799 testplan.py[line: 87] INFO: 正在更新testlink上测试计划[testplan_id=74, bulid_version=v1.0.0],对应用例[testcase_id=80]的执行结果
2016-11-30 12:08:57,083 testplan.py[line: 45] INFO: 获取测试用例信息 [{'is_open': '1', 'summary': '<p>\n\t1、运行时，ulr中的40758966216286146560取自base_info.serial字段</p>\n<p>\n\t&nbsp;</p>\n<p>\n\t&nbsp;</p>\n', 'tc_external_id': '12', 'preconditions': '', 'name': 'test-n-免费领取优惠券', 'version': '1', 'layout': '1', 'testcase_id': '126', 'creation_ts': '2016-07-26 15:06:38', 'modification_ts': '2016-11-29 19:43:22', 'active': '1', 'updater_id': '1', 'id': '127', 'testsuite_id': '125', 'estimated_exec_duration': '', 'importance': '2', 'updater_last_name': 'Administrator', 'updater_first_name': 'Testlink', 'full_tc_external_id': 'wecharno-12', 'author_login': 'admin', 'author_last_name': 'Administrator', 'node_order': '1000', 'updater_login': 'admin', 'status': '1', 'execution_type': '1', 'author_first_name': 'Testlink', 'steps': [{'step_number': '1', 'active': '1', 'execution_type': '1', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行SQl&quot;,</p>\n<p>\n\t&quot;更新&quot;:&quot;UPDATE base_info SET sku_quantity = 1000&nbsp; WHERE serial = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;(\\&quot;40758966216286146560\\&quot;,)&quot;</p>\n<p>\n\t}</p>\n', 'expected_results': '', 'id': '181'}, {'step_number': '2', 'active': '1', 'execution_type': '1', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;更新&quot;:&quot;</p>\n<pre style="background-color:#ffffff;color:#000000;font-family:\'宋体\';font-size:12pt;">\n<span style="color:#008080;font-weight:bold;">UPDATE base_info SET listing = 1  WHERE serial = %s</span>&quot;,\n</pre>\n<p>\n\t&quot;参数&quot;:&quot;(40758966216286146560,)&quot;</p>\n<p>\n\t}</p>\n', 'expected_results': '', 'id': '180'}, {'step_number': '3', 'active': '1', 'execution_type': '1', 'actions': '<p>\n\t{<br />\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;urL&quot;:&quot;/kq/getincoupon/40758966216286146560/[global_openId]&quot;,<br />\n\t&quot;参数&quot;:&quot;&quot;<br />\n\t}</p>\n', 'expected_results': '<p>\n\t{</p>\n<p>\n\t&quot;检查&quot;：&ldquo;body&rdquo;,</p>\n<p>\n\t&quot;匹配规则&quot;：&ldquo;包含字符串&rdquo;,</p>\n<p>\n\t&ldquo;条件&rdquo;：[{&quot;模式&quot;：&ldquo;success\\&quot;:true&quot;,&quot;消息&quot;：&ldquo;<span style="color:#008080;font-weight:bold;">success不为ture,领取卡券失败</span>&rdquo;}]</p>\n<p>\n\t}</p>\n', 'id': '128'}], 'author_id': '1'}]
2016-11-30 12:08:57,287 testplan.py[line: 69] INFO: 记录测试用例到测试用例报表
2016-11-30 12:08:57,288 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130120835', 126, 'test-n-免费领取优惠券', '卡券中心-免费领取卡券接口', 'plan1_of_wechatno', 'pj_wechatno', 'Block', '')
2016-11-30 12:08:57,292 testplan.py[line: 72] INFO: 开始执行测试用例[id=126，name=test-n-免费领取优惠券]
2016-11-30 12:08:57,292 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行SQl","更新":"UPDATE base_info SET sku_quantity = 1000  WHERE serial = %s","参数":"(\"40758966216286146560\",)"}
2016-11-30 12:08:57,292 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：
2016-11-30 12:08:57,292 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 12:08:57,293 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:08:57,293 mydb.py[line: 70] INFO: query：UPDATE base_info SET sku_quantity = 1000  WHERE serial = 40758966216286146560
2016-11-30 12:08:57,905 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:08:57,905 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 12:08:57",step_action="{'参数': ('40758966216286146560',), '更新': 'UPDATE base_info SET sku_quantity = 1000  WHERE serial = %s', '步骤类型': '执行SQl'}", expected_results="" WHERE executed_history_id = 20161130120835 AND testcase_id = 126 AND step_id = 181 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:08:57,912 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行sql","更新":"UPDATE base_info SET listing = 1  WHERE serial = %s","参数":"(40758966216286146560,)"}
2016-11-30 12:08:57,913 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：
2016-11-30 12:08:57,913 testcase.py[line: 55] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:08:57,914 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130120835', 126, 'test-n-免费领取优惠券', 'plan1_of_wechatno', 'pj_wechatno', 180, 2, '', '', '192.168.9.211', '3306', '{"步骤类型":"执行sql","更新":"UPDATE base_info SET listing = 1  WHERE serial = %s","参数":"(40758966216286146560,)"}', '', 'Block', '', '')
2016-11-30 12:08:57,917 testcase.py[line: 77] INFO: 开始执行步骤操作[第2步]
2016-11-30 12:08:57,917 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:08:57,918 mydb.py[line: 70] INFO: query：UPDATE base_info SET listing = 1  WHERE serial = 40758966216286146560
2016-11-30 12:08:57,925 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:08:57,925 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 12:08:57",step_action="{'参数': (40758966216286146560,), '更新': 'UPDATE base_info SET listing = 1  WHERE serial = %s', '步骤类型': '执行sql'}", expected_results="" WHERE executed_history_id = 20161130120835 AND testcase_id = 126 AND step_id = 180 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:08:57,930 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"方法":"post","url":"/kq/getincoupon/40758966216286146560/[global_openId]","参数":""}
2016-11-30 12:08:57,931 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"success\":true","消息":"success不为ture,领取卡券失败"}]}
2016-11-30 12:08:57,931 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:08:57,932 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130120835', 126, 'test-n-免费领取优惠券', 'plan1_of_wechatno', 'pj_wechatno', 128, 3, '', 'http', 'm.test.saofu.cn', 80, '{"方法":"post","url":"/kq/getincoupon/40758966216286146560/[global_openId]","参数":""}', '{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"success\\":true","消息":"success不为ture,领取卡券失败"}]}', 'Block', '', '')
2016-11-30 12:08:57,934 testcase.py[line: 77] INFO: 开始执行步骤操作[第3步]
2016-11-30 12:08:57,935 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_urlencode
2016-11-30 12:08:57,935 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:08:57,935 casestep.py[line: 129] INFO: 找到待替换的全局动态参数：[global_openId]
2016-11-30 12:08:57,936 casestep.py[line: 138] INFO: 转换后的参数体为：/kq/getincoupon/40758966216286146560/ous64uFCCLMyXYDJ-MkNilyCI5CY
2016-11-30 12:08:57,936 InterfaceUnittestTestCase.py[line: 30] INFO: 正在发起POST请求...
2016-11-30 12:08:57,936 httpprotocol.py[line: 74] INFO: 发起的请求为：http://m.test.saofu.cn:80/kq/getincoupon/40758966216286146560/ous64uFCCLMyXYDJ-MkNilyCI5CY
2016-11-30 12:08:57,937 httpprotocol.py[line: 75] INFO: 参数为：b''
2016-11-30 12:08:57,937 httpprotocol.py[line: 76] INFO: 请求头为：{'Cookie': '10549840601068216320=ous64uFCCLMyXYDJ-MkNilyCI5CY'}
2016-11-30 12:08:59,022 InterfaceUnittestTestCase.py[line: 40] INFO: 正在对服务器返回body进行解码
2016-11-30 12:08:59,023 InterfaceUnittestTestCase.py[line: 54] INFO: 服务器返回结果"响应体(body)": {"code":"4001","reason":null,"result":null,"getByWeixin":false,"cardCode":"544773500429","couponWeiXinCustomerId":135541,"jsapi":null,"couponWeixinCustomers":null,"weixinVersion":null,"cardPreprintLogId":null,"jssdk":null,"cwc":{"id":135541,"cw":{"id":1421,"shop":{"id":42,"serial":"10549840601068216320","parent":null,"phoneNumber":null,"email":null,"fullName":null,"name":"深圳云移","logoUrl":"upload/image/2016/10/26/1de0a376-5315-4191-b577-c459edbb1ee1.jpg","printAdUrl":null,"printAdText":null,"createTime":null,"shopType":null,"sblist":null,"idlist":null,"shopAccount":null,"subShops":null,"account":null,"shopRole":null,"suffixShop":null,"thirdAppId":null},"cardId":null,"cardType":"cash","baseInfo":{"id":2001,"frontImageUrl":"http://res.yunnex.com/saofu/coupon/11.png","appid":null,"codeType":2,"title":"接口-代金券","subTitle":"","color":"509fc9","notice":"接口自动化测试专用，烦请勿动","servicePhone":"07556644511","description":"接口自动化测试专用，烦请勿动，勿修改，勿下架","useLimit":1,"getLimit":null,"dateInfoType":1,"dateInfoBeginTimestamp":1469721600000,"dateInfoEndTimestamp":1517328000000,"dateInfoBeginTimestampStr":null,"dateInfoEndTimestampStr":null,"dateInfoFixedTerm":null,"fixedBeginTerm":null,"skuQuantity":1000,"getInType":3,"serial":"40758966216286146560","cardType":1,"listing":1,"canShare":false,"fitAll":true,"coverShow":null,"shopId":42,"checkPass":null,"modifyTime":null,"cardId":null,"couponId":null,"price":null,"allowedScope":"ONLINE","detailImgUrl":"upload/file/2016/09/14/ed0d5ffa-fd1b-46b8-8b9e-236cd9732eda.jpeg","detailTxt":"文字描述","backGroundPicUrl":null,"timeLimitList":[],"cardCouponCardType":null,"gift":null,"cashLeastCost":null,"cashReduceCost":null,"discount":null,"masterCardId":null},"generalCouponDefaultDetail":"","grouponDealDetail":null,"gift":"","cashLeastCost":2,"cashReduceCost":1,"discount":0,"createTime":1469786621000,"checkPass":-1,"delFlag":null,"modifyTime":null,"coverShow":null,"isGoodsCoupon":null,"changeStock":null,"batchVerifyLimit":1,"cashOverlay":true},"customer":{"id":167020,"channel":1,"channelSerial":"ous64uFCCLMyXYDJ-MkNilyCI5CY","shopId":42,"createTime":1477636412000,"mobile":"17817738178","name":"fuyu","sex":1,"weixinNickname":"MrLai","headImgUrl":"http://wx.qlogo.cn/mmopen/JZnr5tqrZvdT3tvbobWgCKXdkUvJnaPrL5qs8HxWruHVzmvMj7NciamlgTP89ibKaGoLpxcW3el6Xs2Wrib8ovicSgPIZ6Kmk1UQ/0","lastUpdateTime":1480478943006,"customerGroupId":100,"groupName":null,"province":"广东","city":"深圳","subscribeTime":1477391385000,"balance":null,"bonus":null,"memberCount":null,"handoutStatus":null,"registerTime":1477636535000,"activeTime":null,"member":true},"serial":"544773500429","createTime":1480478943272,"getedSync":null,"channel":-1,"branchId":-1,"operatorId":0,"lakeUserId":null,"effectTime":null,"expireTime":null,"status":null,"baseInfo":null},"serialList":null,"success":true}
2016-11-30 12:08:59,023 InterfaceUnittestTestCase.py[line: 55] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:09:02 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('Vary', 'Accept-Encoding')]
2016-11-30 12:08:59,023 InterfaceUnittestTestCase.py[line: 56] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:08:59,024 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为：success":true
2016-11-30 12:08:59,024 unittesttestcase.py[line: 292] WARNING: 未检测到从服务器返回中提取内容的要求，请检查是否正确填写预期结果
2016-11-30 12:08:59,024 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:08:59,024 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="post", runtime="2016-11-30 12:08:57",step_action="{'参数': '', 'url': '/kq/getincoupon/40758966216286146560/ous64uFCCLMyXYDJ-MkNilyCI5CY', '方法': 'post'}", expected_results="{'匹配规则': '包含字符串', '检查': 'body', '条件': [{'模式': 'success':true', '消息': 'success不为ture,领取卡券失败'}]}" WHERE executed_history_id = 20161130120835 AND testcase_id = 126 AND step_id = 128 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:08:59,030 testcase.py[line: 163] INFO: 测试用例[id=126, name=test-n-免费领取优惠券]执行成功
2016-11-30 12:08:59,030 testplan.py[line: 76] INFO: 正在更新用例执行结果
2016-11-30 12:08:59,031 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 12:08:57" WHERE executed_history_id = 20161130120835 AND testcase_id = 126 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:08:59,293 testplan.py[line: 87] INFO: 正在更新testlink上测试计划[testplan_id=74, bulid_version=v1.0.0],对应用例[testcase_id=126]的执行结果
2016-11-30 12:08:59,598 testplan.py[line: 45] INFO: 获取测试用例信息 [{'is_open': '1', 'summary': '', 'tc_external_id': '7', 'preconditions': '', 'name': 'test-n-点击立即购买按钮', 'version': '1', 'layout': '1', 'testcase_id': '102', 'creation_ts': '2016-07-20 16:48:26', 'modification_ts': '2016-11-29 18:14:53', 'active': '1', 'updater_id': '1', 'id': '103', 'testsuite_id': '79', 'estimated_exec_duration': '', 'importance': '2', 'updater_last_name': 'Administrator', 'updater_first_name': 'Testlink', 'full_tc_external_id': 'wecharno-7', 'author_login': 'admin', 'author_last_name': 'Administrator', 'node_order': '1001', 'updater_login': 'admin', 'status': '1', 'execution_type': '1', 'author_first_name': 'Testlink', 'steps': [{'step_number': '1', 'active': '1', 'execution_type': '1', 'actions': '<p>\n\t{<br />\n\t&quot;方法&quot;:&quot;get&quot;,<br />\n\t&quot;url&quot;:&quot;/mall/tobuy/1?&quot;,<br />\n\t&quot;参数&quot;:{&quot;mallGoodsId&quot;:&quot;26838&quot;,&quot;amount&quot;:1,&quot;type&quot;:1,&quot;serial&quot;:&quot;[global_serial]&quot;}<br />\n\t}</p>\n', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;:&quot;包含字符串&quot;,</p>\n<p>\n\t&quot;条件&quot;:[{&quot;模式&quot;:&quot;到店支付&quot;,&quot;消息&quot;:&quot;无法打开商品详情&quot;}]</p>\n<p>\n\t}</p>\n', 'id': '104'}], 'author_id': '1'}]
2016-11-30 12:08:59,713 testplan.py[line: 69] INFO: 记录测试用例到测试用例报表
2016-11-30 12:08:59,713 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130120835', 102, 'test-n-点击立即购买按钮', '微商城-模拟点击页面跳转', 'plan1_of_wechatno', 'pj_wechatno', 'Block', '')
2016-11-30 12:08:59,714 testplan.py[line: 72] INFO: 开始执行测试用例[id=102，name=test-n-点击立即购买按钮]
2016-11-30 12:08:59,714 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"方法":"get","url":"/mall/tobuy/1?","参数":{"mallGoodsId":"26838","amount":1,"type":1,"serial":"[global_serial]"}}
2016-11-30 12:08:59,715 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"到店支付","消息":"无法打开商品详情"}]}
2016-11-30 12:08:59,715 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:08:59,715 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130120835', 102, 'test-n-点击立即购买按钮', 'plan1_of_wechatno', 'pj_wechatno', 104, 1, '', 'http', 'm.test.saofu.cn', 80, '{"方法":"get","url":"/mall/tobuy/1?","参数":{"mallGoodsId":"26838","amount":1,"type":1,"serial":"[global_serial]"}}', '{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"到店支付","消息":"无法打开商品详情"}]}', 'Block', '', '')
2016-11-30 12:08:59,716 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 12:08:59,716 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_urlencode
2016-11-30 12:08:59,716 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_serial]
2016-11-30 12:08:59,716 casestep.py[line: 104] INFO: 转换后的参数体为：{'amount': 1, 'serial': '10549840601068216320', 'mallGoodsId': '26838', 'type': 1}
2016-11-30 12:08:59,716 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:08:59,716 InterfaceUnittestTestCase.py[line: 35] INFO: 正在发起GET请求...
2016-11-30 12:08:59,716 httpprotocol.py[line: 56] INFO: 发起的请求为：http://m.test.saofu.cn:80/mall/tobuy/1?amount=1&serial=10549840601068216320&mallGoodsId=26838&type=1
2016-11-30 12:08:59,717 httpprotocol.py[line: 57] INFO: 请求头为：{'Cookie': '10549840601068216320=ous64uFCCLMyXYDJ-MkNilyCI5CY'}
2016-11-30 12:09:00,721 InterfaceUnittestTestCase.py[line: 40] INFO: 正在对服务器返回body进行解码
2016-11-30 12:09:00,721 InterfaceUnittestTestCase.py[line: 54] INFO: 服务器返回结果"响应体(body)": 
	 





<!DOCTYPE html>
<link rel="stylesheet" href="/css/bind/banner.css?v=3.8.0-ab8ee" />  
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no">
<meta http-equiv="Expires" CONTENT="0">
<meta http-equiv="Cache-Control" CONTENT="no-cache">
<meta http-equiv="Pragma" CONTENT="no-cache">
<title>微商城</title>
<link rel="stylesheet" href="/css/mall/pure.css?v=3.8.0-ab8ee">
<link rel="stylesheet" href="/css/mall/grids-core.css?v=3.8.0-ab8ee">
<link rel="stylesheet" href="/css/mall/zepto.alert.css?v=3.8.0-ab8ee">

<link rel="stylesheet" href="/css/mall/mobiscroll.scroller.css?v=3.8.0-ab8ee">
<link rel="stylesheet" href="/css/mall/mobiscroll.scroller.ios7.css?v=3.8.0-ab8ee">
<link rel="stylesheet" href="/css/mall/mobiscroll.animation.css?v=3.8.0-ab8ee">
</head>
<style type="text/css">
* {
	margin: 0;
	padding: 0;
}

html {
	color: #626262;
	overflow-y: auto;
	overflow-x: hidden;
}

body {
	margin-bottom: 20px;
	overflow-y: auto;
	overflow-x: hidden;
}

a {
	text-decoration: none;
}

ol,ul {
	list-style: outside none none;
}

.left {
	float: left;
}

.right {
	float: right;
}

.in-block {
	display: inline-block;
}

.orange {
	color: #c58d04;
}

.grey {
	color: #adadad;
}

.bg-color {
	background: #ececec;
}

#wrapper {
	width: 100%;
	margin: 0 auto;
}

.header {
	width: 100%;
}

.header ul {
	position:relative;
	overflow: hidden;
}

.header ul li {
	width: 50%;
	float: left;
	height: 2.8em;
	line-height: 2.8em;
	background: #fff;
	text-align: center;
	border-bottom:1px solid #f38b44;
	-moz-box-sizing:border-box; /* Firefox */
     -webkit-box-sizing:border-box; /* Safari */
     box-sizing:border-box;
}
.header ul .lines{
	position: absolute;
	width: 1%;
	height: 2.8em;
	line-height: 2.8em;
	border-right: 1px solid #FDE5D4;
	left: 49%;
	top: -1px;
 } 
.header ul li a {
	color: #8b898a;
}

.tab_content>div {
	height: auto;
	font-size: 0.8em;
	margin: 0.5em 0;
}

.empty-p {
	width: 80%;
	float: left;
	padding: 0.5em 0;
}

.has-p {
    width: 100%;
    margin: 0 auto;
    padding: 0 1em;
    height: auto;
    line-height: 2.5em;
    text-align: left;
    box-sizing: border-box;
    -webkit-box-sizing: border-box;
    -webkit-box-sizing: -webkit-border-box;
}
.has-p-one{
    background: url(/images/mall/contact.png) no-repeat left center;
    background-size: 12px 12px;
}
.has-p-two{
    background: url(/images/mall/take.png) no-repeat left 2px;
    background-size: 12px 12px;
}
.has-p-three{
    background: url(/images/mall/time.png) no-repeat left 2px;
    background-size: 12px 12px;
}
.input-right{
    position: relative;
}
.input-right-img{
    width: 1em;
    position: absolute;
    right: 0.6em;
    top: 0.3em;
}
#scheduledTime{
    width:11em;
    height: 2em;
    border:1px solid #a0a0a0;
    border-radius:4px;
    color:#a0a0a0;
    text-indent:.5em
}
.hiddens-p{
    text-overflow:ellipsis; 
    overflow:hidden; 
    white-space:nowrap;  
}

.right-dashed {
	border-left: 1px solid #eee;
	margin-top: 1em;
	padding-bottom:1em;
}

#edit {
	padding: 1em 0 1em 2em;
    width: 10px;
}

.header ul li.active{
    border-bottom: 4px solid #f38b44;
}
.header ul li.active a{
    color: #f38b44!important;
}
.buy_title{
	background:#f3f3f3;
	padding:0.3em 1em;
	margin: 0;
}
.content {
	width: 100%;
	background: #fff;
	overflow: hidden;	
	padding-bottom:8%;
}

.selectList {
	border-bottom: 1px solid #efefef;
	margin: 0 auto;
	overflow: hidden;
	padding: 0.5em 1em;
	font-size: 0.8em;
	clear:both;
}

.selectList img {
    display: inline-block;
    float: left;
    width: 25%;
    border-radius: 4px;
    -webkit-border-radius: 4px;
}

.button {
	display:block;	
	width: 99%;	
	height: 3em;
	color: #fff;
	border: none;
	border-radius: 4px;
	margin:0 auto 0.5em auto;
}

.addbtn {
	background: #33CC66;
}

.btn-wrap-5 {
	padding: 0 1em;
}
.buybtn {
	width: 100%;
	background: #f68d3c;
}

.footer {
	width: 100%;
	background: #fff;
	color: #b6b6b6;
	overflow: hidden;
	text-align: left;
	margin-bottom: 1em;
}

.all-end-button {
	width: 90%;
	margin: 1em auto 0.5em;
}

.all-end-button p:first-child {
	text-align: left;
}

.error-page{
	background: #ddd;
    padding-bottom: 2em;
}
.error-page img{
    margin:0 auto;
	padding-top: 2em;
}
.error-page p{
    text-align:center;
    color:#000;
    width:80%;
    margin:1em auto 2em;
}
#deliverFee{
	text-align:left;
	font-size:0.8em;
	color:#acb0af;
}
.order-div{
    margin-left: 26.8%;            
    position: relative;
}
.order-div>p:last-child{
    width: 100%;
    margin: 0;
    position: absolute;
    bottom: 0;
    left: 0;
}
.m-t-n{
    margin-top: 0;
}
.m-t-n>span{
    display: inline-block;
}
.m-t-n>span:first-child{
    width: 70%;
}
.m-t-n>span:last-child{
    width: 30%;
}
.mtn-span{
    float: right;
}
.t-r-span{
	text-align:right;
}
.ccc{
    color: #ccc;
}
.peisong{
    text-align: right;
    margin-bottom: 0;
    padding-right: 1em;
    padding-top: 0.4em;
}
.peisong-detail{
    color:#000;
}
.peisong-detail input{
    border: none;
}
.peisong-detail div>p{
    padding-left: 1.8em;
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    margin: 0;
    clear:both;
}

.weipay{            
    background: url(/images/weixin2.png) no-repeat left center;
    background-size:1.6em 1.4em; 
}        
.peisong-detail div>p.pay{
    background: url(/images/money2.png) no-repeat left center;
    background-size:1.6em 1.4em; 
}
.peisong-detail div>p.cardpay{
    background: url(/images/cardpay2.png) no-repeat left center;
    background-size:1.6em 1.4em; 
}
.peisong-detail div>p.mdpay{
    background: url(/images/mdpay2.png) no-repeat left center;
    background-size:1.6em 1.4em; 
}

.peisong-detail div[class^="btn-wrap-"] {
	border-bottom: 1px solid #dadada;
	padding: 0 1em;
	height: 3em;
	position: relative;
}

.weipay,.pay,.mdpay,.cardpay{
    position: relative;
}
 .weipay>img,.mdpay>img,.pay>img,.cardpay>img,.zhifu input{
    width: 1.2em;
    height: 1.2em;
    position: absolute;
    right: 0;
    top: 50%;
    transform:translateY(-50%);
}

.pure-img-check {
	background: url(/images/weixuan2.png) no-repeat left center;
    background-size:1.2em 1.2em; 
    float: right;
    height: 1.2em;
    width: 1.2em;
}

.zhifu input{
    display: none;
}
#deliverFeeDiv, #FetchDiv {
	border-bottom: 1px solid #efefef;
    padding: 0.5em 1em;
}
#deliverFeeDiv p, #FetchDiv p{
	text-align:right;
}

#remark {
	padding: 0.5em 1em;
	height: 4em;
	font-size: 1.0em;
}
</style>
<body>
	<div id="wrapper">
		
			
			
			
				
					
					
						
						
						
						
						
					
					
				
				
			
			<div class="header">
				
					<ul class="tab">
						<li class='active' data='#deliverFeeDiv'><a href="#tab1">快递发货</a></li>						
						<li class=''><a href="#tab2">到店自提</a></li>
						<span class="lines"></span>
					</ul>
				
			</div>
			<p class="buy_title"></p>
			
			<div class="tab_container">
				<div id="tab1" class="tab_content pure-g" style="">
					<div class="pure-u-24-24">
						
							
								<div class="has-p">
									<span>联系方式：</span>
									<span class="pure-u-3-5">17817738178<span>(17817738178)</span></span>
								</div>
								<div class="has-p">
									<span>配送地址：</span>
									<span class="pure-u-3-5">天津市县宁河县详细</span>
									<span style="float:right;">
										
											
											
											<a href="/toaddr/1?serial=10549840601068216320&fm=1&mallGoodsId=26838&amount=1&amounts=&cartIds=">
												<img src="/images/enter.png?v=3.8.0-ab8ee" class="pure-img" id="edit">
											</a>
											
										
									</span>
                                </div>
							
							
						
					</div>
				</div>
				<div id="tab2" class="tab_content pure-g" style="display:none">
					<div class="pure-u-24-24">
						
							
								<div class="has-p">
									<span>联系方式：</span>
									<span class="pure-u-3-5">452<span>(17817738178)</span></span>
								</div>
                                <div class="has-p">
                                	<span>门&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;店：</span>
                                	<span class="pure-u-3-5">
                                		广东省深圳市福田区
	                                	
	                                		Biu
	                                	
                                	</span>
									<span style="float:right;">
										
											
											
											<a href="/toaddr/2?serial=10549840601068216320&fm=1&mallGoodsId=26838&amount=1&amounts=&cartIds=">
												<img src="/images/enter.png?v=3.8.0-ab8ee" class="pure-img" id="edit">
											</a>
											
										
									</span>
                                </div>
                               	<div class="has-p">
                               		<span>到店时间：</span>
                               		<span class="input-right">
                               			<input type="text" id="scheduledTime" name="scheduledTime" class="text" placeholder="请选择"/><img src="/images/mall/input-right.png?v=3.8.0-ab8ee" class="input-right-img">
                               		</span>
                               	</div>
							
							
						
					</div>
				</div>
			</div>
			<p class="buy_title"></p>
			
			<div class="content">
				
					
						
							<div class="selectList">
								<img src="http://res.test.saofu.cn/saofu/upload/image/2016/07/18/352c9a44-5fe7-4546-9786-563d8700a773.jpg"> 
								
									
									
										<div class="order-div">
											<p class="m-t-n"><span>接口-测试商品1</span><span class="mtn-span t-r-span">￥0.01</span></p>
											<p><span class="ccc mtn-span">X1</span></p>
                                        </div>	
									
								
							</div>
						
					
					
					
				
				<div id="deliverFeeDiv">
					 
						
						
							<p id="deliverFee">含运费：￥0.01</p>
							<p class="orange">合计：￥0.02</p>
						
					 
				</div>
				<div id="FetchDiv" style="display: none;">
					<p class="orange">合计：￥0.01</p>
				</div>
				<div id="remark">
					<span class="beizhu" style="float:left">备注：</span>
                   	<span class="beizhulan">
                   		<textarea rows="3" placeholder="可于此处给卖家留言备注" style="border:0;width: 85%;"></textarea>
                   	</span>
				</div>
			</div>
			<p class="buy_title"></p>
			<div class="footer">
				<div class="peisong-detail zhifu">
                	
                        <div class="btn-wrap-1">
                         	<p class="weipay">微信支付<span class="pure-img-check"></span>
                             	<input type="radio" name="zhifu" value="1"/>
                         	</p>
                        </div>
                    
                  	
                  	
                        <div class="btn-wrap-2" style="">
                         	<p class="pay">货到付款<span class="pure-img-check"></span>
                             	<input type="radio" name="zhifu" value="3"/>
                         	</p>
                        </div>
                   	
		
                    
                        <div class="btn-wrap-3" style="display:none">
                        	<p class="mdpay">到店支付<span class="pure-img-check"></span>
                        		<input type="radio" name="zhifu" value="2"/>
                        	</p>
                        </div>
                   	
                   	
                   	
                        <div class="btn-wrap-4">
                       		<p class="cardpay">储值卡支付<span class="pure-img-check"></span>
                       			<input type="radio" name="zhifu" value="4"/>
                       		</p>
                        </div>
                   	
                </div>
			</div>
			<div class="btn-wrap-5">
				<input type="button" class="button buybtn submit" value="确认提交" />
			</div>
			
		
	</div>
	<script type="text/javascript" src="/js/zepto.min.js?v=3.8.0-ab8ee"></script>
	<script type="text/javascript" src="/js/touch.js?v=3.8.0-ab8ee"></script>
    
	<script type="text/javascript" src="/js/mall/zepto.alert.js?v=3.8.0-ab8ee"></script>
	<script type="text/javascript" src="/js/mall/mall.js?v=3.8.0-ab8ee"></script>
	<script type="text/javascript" src="/js/mall/mobiscroll.zepto.js?v=3.8.0-ab8ee" ></script>
	<script type="text/javascript" src="/js/mall/mobiscroll.core.js?v=3.8.0-ab8ee"></script>
	<script type="text/javascript" src="/js/mall/mobiscroll.scroller.js?v=3.8.0-ab8ee"></script>
	<script type="text/javascript" src="/js/mall/mobiscroll.datetime.js?v=3.8.0-ab8ee"></script>
	<script type="text/javascript" src="/js/mall/mobiscroll.i18n.zh.js?v=3.8.0-ab8ee"></script>
	<script type="text/javascript">
		$(function() {
			$("input[name='zhifu']:checked").prev('.pure-img').attr('src','/images/check.png');
			var tab = parseInt("1");
			/* if(tab == 1){
				$("#deliverFeeDiv").show();
				$("#FetchDiv").hide();
			} else if (tab == 0){
			    $("#deliverFeeDiv").hide();
				$("#FetchDiv").show();
			} else if(parseInt("1") != 0){
				$("#deliverFeeDiv").hide();
				$("#FetchDiv").show();
			} */
			
			if ("true" == "true" && 1 == 1) {
				$("#deliverFeeDiv").show();
				$("#FetchDiv").hide();
			} else {
				$("#deliverFeeDiv").hide();
				$("#FetchDiv").show();
			}
			
			// 控制显示图片比例
			var img_left_heights = $(".selectList img").width()*(0.75);
			$(".selectList img,.order-div").css('height',img_left_heights);
			
			// 取货日期
			var now = new Date();
            $('#scheduledTime').mobiscroll().datetime({
                minDate: new Date(now.getFullYear(), now.getMonth(), now.getDate(), now.getHours()+1),
                maxDate: new Date(now.getFullYear(), now.getMonth()+3, now.getDate()),
                stepMinute: 30,
                dateOrder :"yymmdd",
                dateFormat:"yy-mm-dd",
                timeWheels:"HHii",
                timeFormat:"HH:ii",
                //invalid: [{ start: '00:00', end: '08:00' },{ start: '22:00', end: '23:59' }],
                theme: 'ios7',
                lang: 'zh',
                display: 'bottom',
                mode: 'mixed'
            });
            $('#scheduledTime').click(function(){
                $('#scheduledTime').mobiscroll('show'); 
                return false;
            });
            
			$("ul li").click(function() {
				$("ul li").removeClass("active");
				$(this).addClass("active");
				if($(this).attr("data")=="#deliverFeeDiv"){
					$("#deliverFeeDiv").show();
					$("#FetchDiv").hide();
				}else{
					$("#deliverFeeDiv").hide();
					$("#FetchDiv").show();
				}
				$(".tab_content").hide();
				var href = $(this).find("a").attr("href");
				$(href).show();
				
				if(href.endWith("tab1")) {
					$(".btn-wrap-2").show();
					$(".btn-wrap-3").hide();
				} else if(href.endWith("tab2")) {
					$(".btn-wrap-2").hide();
					$(".btn-wrap-3").show();
				}
				//清空已选择的支付方式
				$("input[name='zhifu']").prop("checked", false);
				$(".zhifu .pure-img-check").css('background-image','url(/images/weixuan2.png)');
				return false;
			});
			//商户设置的满额包邮价
			/* var noDeliverFee = toPrice(parseFloat("")/100);
			var totalFee = parseFloat("0.01");
			if(totalFee > noDeliverFee){
				$("#deliverFeeDiv .orange").text("合计：￥"+ totalFee);
				$("#deliverFee").text("含运费：￥0.00");
			} */
			$('.zhifu>div').click(function(){
	            $("input[name=zhifu]").prop("checked", false);
	            $(".pure-img-check").css('backgroundImage','url(/images/weixuan2.png)');
	            var img_obj = $(this).find('.pure-img-check');
	            var backgroundImage = img_obj.css('background-image');
	            var input_obj = $(this).find('input');
	            if(backgroundImage.indexOf("weixuan2.png") > 0){
	                img_obj.css('background-image','url(/images/check.png)');
	                input_obj.prop("checked", "checked");
	            }else{
	                img_obj.css('background-image','url(/images/weixuan2.png)');
	                input_obj.prop("checked", false);
	            }
	        });
		});
		
		function validateRemark(){
			if($('.beizhulan textarea').val() != "" && $('.beizhulan textarea').val() != undefined){
				if($('.beizhulan textarea').val().length>30){
					$.dialog({
                        widths : '80%',
                        content : '您输入的备注过长，请不要超过30个字',
                        title : 'no',
                        fullok : function() {
                            return true;
                        },                       
                        lock : true
                    });	
					return false;
				}
				return true;
			}
			return true;
		}
		
		$(".submit").click(function(event){
			var payType = $("input[name='zhifu']:checked").val();
			if(null == payType || "" == payType || typeof(payType) == "undefined") {
       		 $.dialog({
                    widths : '80%',
                    content : '请选择支付方式',
                    title : 'no',
                    fullok : function() {
                        return true;
                    },                       
                    lock : true
                });
       			return;
       		}
			$.dialog({
                content : "确认提交订单？",
                title : "no",
                okText: '取消',
                cancelText : '确定', 
                ok : function() {
                	$(".ft-right").removeAttr("disabled");
                	return;
                },
                cancel : function() {                        	
               		
               		if(payType == 1){
               			if($(this).prop("disabled") == true)
                    		return false;
            			
            			var type = 0;
            			$(".tab_content").each(function(){
            				if($(this).css("display") != "none") {
            					var attrId = $(this).attr("id");
            					if(attrId == "tab1") {
            						type = 1;//快递取货
            					} else if(attrId == "tab2") {
            						type = 2;//门店自提
            					}
            				}
            			});
            			if(type <= 0) {
            				doAlert("no", "无效物流方式");
            				return;
            			}
            			if(type == 1) {
            				if($("#tab1 .pure-u-24-24 .empty-p").length > 0) {
            					$.dialog({
            	                    widths : '80%',
            	                    content : '请编辑收货地址',
            	                    title : 'no',
            	                    fullok : function() {
            	                        return true;
            	                    },                       
            	                    lock : true
            	                });
            					return;
            				}
            			}
            			var _fetchTime = "";
            			if(type == 2) {
            				if($("#tab2 .pure-u-24-24 .empty-p").length > 0) {
            					$.dialog({
            	                    widths : '80%',
            	                    content : '请编辑取货地址',
            	                    title : 'no',
            	                    fullok : function() {
            	                        return true;
            	                    },                       
            	                    lock : true
            	                });
            					return;
            				}
            				_fetchTime = $("#scheduledTime").val();
            				if(null == _fetchTime || "" == _fetchTime || typeof(_fetchTime) == undefined) {
            					$.dialog({
            	                    widths : '80%',
            	                    content : '请选择取货时间',
            	                    title : 'no',
            	                    fullok : function() {
            	                        return true;
            	                    },                       
            	                    lock : true
            	                });
            					return;
            				}
            				var shopBranch = "yunnex.saofu.shop.entity.ShopBranch@3ecbc929";
            				if(shopBranch == "") {
            					$.dialog({
            	                    widths : '80%',
            	                    content : '请编辑取货地址',
            	                    title : 'no',
            	                    fullok : function() {
            	                        return true;
            	                    },                       
            	                    lock : true
            	                });
            					return;
            				}
            			}
            			
            			var _remark = encodeURI($(".beizhulan").find("textarea").val());
            			var params = {
            				serial : "10549840601068216320",
            				openId : "ous64uFCCLMyXYDJ-MkNilyCI5CY",
            				fm : "1",
            				mallGoodsId : "26838",
            				amount : "1",
            				cartIds : "",
            				fetchTime : _fetchTime,
            				remark : _remark
            			};
            			if(parseInt("1") == 1 && parseInt("1") == 2){
            				var standardId = "";
            				if(standardId != null && standardId != undefined){
            					params.standardId = standardId;
            				}
            			}
            			
            			if(validateRemark()){
            				var dialog = $.dialog({
            	                content:'订单提交中',
            	                backgrounds :'#000',
            	                opacitys :'0.7',
            	                widths:'50%',
            	                paddings:'0',
            	                warppadding:'2em 0',
            	                foottop:'0',
            	                lock : true
            	            });
            				$.post("/cmorder/" + type+ "/1", params, function(result){
            					dialog.close();
            					
            					if (!result.success) {
            						doAlert("no", result.message);
            						return;
            					}
            					
            					var strParams = "id=" + result.attach;
            	    			strParams += "&serial=10549840601068216320";
            	    			if(type == 2){
            						strParams += "&shopBranchId="+"1485916459";
            					}
            	    			window.location.href = "/pay/1?showwxpaytitle=1&" + strParams;
            	        	});
            			}
               		}
               		
    				if(payType == 2){
    					if($(this).prop("disabled") == true)
    		        		return false;
    					
    					var shopBranch = "yunnex.saofu.shop.entity.ShopBranch@3ecbc929";
    					if(shopBranch == "") {
    						$.dialog({
        	                    widths : '80%',
        	                    content : '请编辑取货地址',
        	                    title : 'no',
        	                    fullok : function() {
        	                        return true;
        	                    },                       
        	                    lock : true
        	                });
    						return;
    					}
    					
    					if($("#tab2 .pure-u-24-24 .empty-p").length > 0) {
    						$.dialog({
        	                    widths : '80%',
        	                    content : '请编辑取货地址',
        	                    title : 'no',
        	                    fullok : function() {
        	                        return true;
        	                    },                       
        	                    lock : true
        	                });
    						return;
    					}
    					
    					var _fetchTime = $("#scheduledTime").val();
    					if(null == _fetchTime || "" == _fetchTime) {
    						$.dialog({
        	                    widths : '80%',
        	                    content : '请选择取货时间',
        	                    title : 'no',
        	                    fullok : function() {
        	                        return true;
        	                    },                       
        	                    lock : true
        	                });
    						return;
    					}
    					
    					if(validateRemark()){
    						var dialog = $.dialog({
    			                content:'订单提交中',
    			                backgrounds :'#000',
    			                opacitys :'0.7',
    			                widths:'50%',
    			                paddings:'0',
    			                warppadding:'2em 0',
    			                foottop:'0',
    			                lock : true
    			            });
    						
    						var _remark = $(".beizhulan").find("textarea").val();
    						var params = {
    							serial : "10549840601068216320",
    							openId : "ous64uFCCLMyXYDJ-MkNilyCI5CY",
    							fm : "1",
    							mallGoodsId : "26838",
    							amount : "1",
    							cartIds : "",
    							fetchTime : _fetchTime,
    							remark : _remark
    						};
    						if(parseInt("1") == 1 && parseInt("1") == 2){
    							var standardId = "";
    							if(standardId != null && standardId != undefined){
    								params.standardId = standardId;
    							}
    						}
    						$.post("/cmorder/2/2", params, function(result){
    							dialog.close();
    							if (!result.success) {
    								doAlert("no", result.message);
    								return;
    							}
    							window.location.href = "/mall/success/2?serial=10549840601068216320&ptype=" + 1;
    			        	});
    					}
    				}
    				
    				if(payType == 3){
    					if($(this).prop("disabled") == true)
    		        		return false;
    					
    					if($("#tab1 .pure-u-24-24 .empty-p").length > 0) {
    						$.dialog({
        	                    widths : '80%',
        	                    content : '请编辑收货地址',
        	                    title : 'no',
        	                    fullok : function() {
        	                        return true;
        	                    },                       
        	                    lock : true
        	                });
    						return;
    					}
    					
    					
    					if(validateRemark()){
    						var dialog = $.dialog({
    			                content:'订单提交中',
    			                backgrounds :'#000',
    			                opacitys :'0.7',
    			                widths:'50%',
    			                paddings:'0',
    			                warppadding:'2em 0',
    			                foottop:'0',
    			                lock : true
    			            });
    						var _remark = encodeURI($(".beizhulan").find("textarea").val());
    						var params = {
    							serial : "10549840601068216320",
    							openId : "ous64uFCCLMyXYDJ-MkNilyCI5CY",
    							fm : "1",
    							mallGoodsId : "26838",
    							amount : "1",
    							cartIds : "",
    							remark : _remark
    						};
    						if(parseInt("1") == 1 && parseInt("1") == 2){
    							var standardId = "";
    							if(standardId != null && standardId != undefined){
    								params.standardId = standardId;
    							}
    						}
    						$.post("/cmorder/1/3", params, function(result){
    							dialog.close();
    							if (!result.success) {
    								doAlert("no", result.message);
    								return;
    							}
    							window.location.href = "/mall/success/3?serial=10549840601068216320&ptype=" + 1;
    			        	});
    					}
    				}
    				
    				if(payType == 4){
    					if($(this).prop("disabled") == true)
                    		return false;
            			
            			var type = 0;
            			$(".tab_content").each(function(){
            				if($(this).css("display") != "none") {
            					var attrId = $(this).attr("id");
            					if(attrId == "tab1") {
            						type = 1;//快递取货
            					} else if(attrId == "tab2") {
            						type = 2;//门店自提
            					}
            				}
            			});
            			if(type <= 0) {
            				$.dialog({
        	                    widths : '80%',
        	                    content : '无效物流方式',
        	                    title : 'no',
        	                    fullok : function() {
        	                        return true;
        	                    },                       
        	                    lock : true
        	                });
            				return;
            			}
            			if(type == 1) {
            				if($("#tab1 .pure-u-24-24 .empty-p").length > 0) {
            					$.dialog({
            	                    widths : '80%',
            	                    content : '请编辑收货地址',
            	                    title : 'no',
            	                    fullok : function() {
            	                        return true;
            	                    },                       
            	                    lock : true
            	                });
            					return;
            				}
            			}
            			var _fetchTime = "";
            			if(type == 2) {
            				if($("#tab2 .pure-u-24-24 .empty-p").length > 0) {
            					$.dialog({
            	                    widths : '80%',
            	                    content : '请编辑取货地址',
            	                    title : 'no',
            	                    fullok : function() {
            	                        return true;
            	                    },                       
            	                    lock : true
            	                });
            					return;
            				}
            				_fetchTime = $("#scheduledTime").val();
            				if(null == _fetchTime || "" == _fetchTime || typeof(_fetchTime) == undefined) {
            					$.dialog({
            	                    widths : '80%',
            	                    content : '请选择取货时间',
            	                    title : 'no',
            	                    fullok : function() {
            	                        return true;
            	                    },                       
            	                    lock : true
            	                });
            					return;
            				}
            				var shopBranch = "yunnex.saofu.shop.entity.ShopBranch@3ecbc929";
            				if(shopBranch == "") {
            					$.dialog({
            	                    widths : '80%',
            	                    content : '请编辑取货地址',
            	                    title : 'no',
            	                    fullok : function() {
            	                        return true;
            	                    },                       
            	                    lock : true
            	                });
            					return;
            				}
            			}
            			
            			var _remark = encodeURI($(".beizhulan").find("textarea").val());
            			var params = {
            				serial : "10549840601068216320",
            				openId : "ous64uFCCLMyXYDJ-MkNilyCI5CY",
            				fm : "1",
            				mallGoodsId : "26838",
            				amount : "1",
            				cartIds : "",
            				fetchTime : _fetchTime,
            				remark : _remark
            			};
            			if(parseInt("1") == 1 && parseInt("1") == 2){
            				var standardId = "";
            				if(standardId != null && standardId != undefined){
            					params.standardId = standardId;
            				}
            			}
            			
            			if(validateRemark()){
            				var dialog = $.dialog({
            	                content:'订单提交中',
            	                backgrounds :'#000',
            	                opacitys :'0.7',
            	                widths:'50%',
            	                paddings:'0',
            	                warppadding:'2em 0',
            	                foottop:'0',
            	                lock : true
            	            });
            				$.post("/cmorder/" + type+ "/4", params, function(result){
            					dialog.close();
            					
            					if (!result.success) {
            						doAlert("no", result.message);
            						return;
            					}
            					
            					var strParams = "?orderId=" + result.attach;
            					if(type == 2){
            						strParams += "&shopBranchId="+"1485916459";
            					}
            					strParams += "&serial=10549840601068216320";
                				window.location.href = "/pay/5"+strParams;
            	        	});
            			}
            			
    				}
    				
                },
                lock : true
            });
		});
		
		//微信支付
		/* $(".payUseWX").click(function(event) {
			if($(this).prop("disabled") == true)
        		return false;
			
			var type = 0;
			$(".tab_content").each(function(){
				if($(this).css("display") != "none") {
					var attrId = $(this).attr("id");
					if(attrId == "tab1") {
						type = 1;//快递取货
					} else if(attrId == "tab2") {
						type = 2;//门店自提
					}
				}
			});
			if(type <= 0) {
				doAlert("no", "无效物流方式");
				return;
			}
			if(type == 1) {
				if($("#tab1 .pure-u-4-5 .empty-p").length > 0) {
					doAlert("no", "请编辑收货地址");
					return;
				}
			}
			var _fetchTime = "";
			if(type == 2) {
				if($("#tab2 .pure-u-4-5 .empty-p").length > 0) {
					doAlert("no", "请编辑取货地址");
					return;
				}
				_fetchTime = $("#scheduledTime").val();
				if(null == _fetchTime || "" == _fetchTime || typeof(_fetchTime) == undefined) {
					doAlert("no", "请选择取货时间");
					return;
				}
				var shopBranch = "yunnex.saofu.shop.entity.ShopBranch@3ecbc929";
				if(shopBranch == "") {
					doAlert("no", "请编辑取货地址");
					return;
				}
			}
			
			var _remark = encodeURI($(".beizhulan").find("textarea").val());
			var params = {
				serial : "10549840601068216320",
				openId : "ous64uFCCLMyXYDJ-MkNilyCI5CY",
				fm : "1",
				mallGoodsId : "26838",
				amount : "1",
				cartIds : "",
				fetchTime : _fetchTime,
				remark : _remark
			};
			if(parseInt("1") == 1 && parseInt("1") == 2){
				var standardId = "";
				if(standardId != null && standardId != undefined){
					params.standardId = standardId;
				}
			}
			
			if(validateRemark()){
				var dialog = $.dialog({
	                content:'订单提交中',
	                backgrounds :'#000',
	                opacitys :'0.7',
	                widths:'50%',
	                paddings:'0',
	                warppadding:'2em 0',
	                foottop:'0',
	                lock : true
	            });
				$.post("/cmorder/" + type+ "/1", params, function(result){
					dialog.close();
					
					if (!result.success) {
						doAlert("no", result.message);
						return;
					}
					
					var strParams = "id=" + result.attach;
	    			strParams += "&serial=10549840601068216320";
	    			window.location.href = "/pay/1?showwxpaytitle=1&" + strParams;
	        	});
			}
		}); */
		//货到付款
		/* $(".payAfrecv").click(function(event) {
			if($(this).prop("disabled") == true)
        		return false;
			
			if($("#tab1 .pure-u-4-5 .empty-p").length > 0) {
				doAlert("no", "请编辑收货地址");
				return;
			}
			
			
			if(validateRemark()){
				var dialog = $.dialog({
	                content:'订单提交中',
	                backgrounds :'#000',
	                opacitys :'0.7',
	                widths:'50%',
	                paddings:'0',
	                warppadding:'2em 0',
	                foottop:'0',
	                lock : true
	            });
				var _remark = encodeURI($(".beizhulan").find("textarea").val());
				var params = {
					serial : "10549840601068216320",
					openId : "ous64uFCCLMyXYDJ-MkNilyCI5CY",
					fm : "1",
					mallGoodsId : "26838",
					amount : "1",
					cartIds : "",
					remark : _remark
				};
				if(parseInt("1") == 1 && parseInt("1") == 2){
					var standardId = "";
					if(standardId != null && standardId != undefined){
						params.standardId = standardId;
					}
				}
				$.post("/cmorder/1/3", params, function(result){
					dialog.close();
					if (!result.success) {
						doAlert("no", result.message);
						return;
					}
					window.location.href = "/mall/success/3?serial=10549840601068216320&ptype=" + 1;
	        	});
			}
		}); */
		//到店支付
		// $(".payInshop").click(function(event) {
			/* if($(this).prop("disabled") == true)
        		return false;
			
			var shopBranch = "yunnex.saofu.shop.entity.ShopBranch@3ecbc929";
			if(shopBranch == "") {
				doAlert("no", "请编辑取货地址");
				return;
			}
			
			if($("#tab2 .pure-u-4-5 .empty-p").length > 0) {
				doAlert("no", "请编辑取货地址");
				return;
			}
			
			var _fetchTime = $("#scheduledTime").val();
			if(null == _fetchTime || "" == _fetchTime) {
				doAlert("no", "请选择取货时间");
				return;
			}
			
			if(validateRemark()){
				var dialog = $.dialog({
	                content:'订单提交中',
	                backgrounds :'#000',
	                opacitys :'0.7',
	                widths:'50%',
	                paddings:'0',
	                warppadding:'2em 0',
	                foottop:'0',
	                lock : true
	            });
				
				var _remark = $(".beizhulan").find("textarea").val();
				var params = {
					serial : "10549840601068216320",
					openId : "ous64uFCCLMyXYDJ-MkNilyCI5CY",
					fm : "1",
					mallGoodsId : "26838",
					amount : "1",
					cartIds : "",
					fetchTime : _fetchTime,
					remark : _remark
				};
				if(parseInt("1") == 1 && parseInt("1") == 2){
					var standardId = "";
					if(standardId != null && standardId != undefined){
						params.standardId = standardId;
					}
				}
				$.post("/cmorder/2/2", params, function(result){
					dialog.close();
					if (!result.success) {
						doAlert("no", result.message);
						return;
					}
					window.location.href = "/mall/success/2?serial=10549840601068216320&ptype=" + 1;
	        	});
			} */
		// });
	</script>
</body>
</html>
<!--加入判断用户是否关注公众号功能 add by lipengfei at 2015-11-9  -->
  	
	<script type="text/javascript" src="/js/bind/banner.js?v=3.8.0-ab8ee"></script>
	<script type="text/javascript">
		$(function() {
			//var SHOP_SERIAL = getCookie("SHOP_SERIAL");
			var SHOP_SERIAL = "10549840601068216320";
			if(null != SHOP_SERIAL && SHOP_SERIAL != ""){
				$.ajax({
					url : '/saofu_mobile/checkUserBindStatus',
					data : {
						"serial" : SHOP_SERIAL
					},
					type : 'post',
					cache : false,
					dataType : 'json',
					success : function(data) {
						if (data != null) {
							var guildFocusStr = data.guildFocusStr;
							if(guildFocusStr != null && guildFocusStr == "1"){
								var hasBindedShop = data.hasBindedShop;
								if(hasBindedShop == "0"){
									var qrName = data.QRPublicName;
									var qrUrl = data.QRCodeURL;
									if(qrName != "" && qrUrl != ""){
										var params = qrName+"**"+qrUrl;
										followModule(params);
									}
								}
							}
						} 
					},
					error : function() {
					}
				});
			}
		});
				
	</script>

2016-11-30 12:09:00,741 InterfaceUnittestTestCase.py[line: 55] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:09:03 GMT'), ('Content-Type', 'text/html;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('Set-Cookie', 'JSESSIONID=97819A3113B8B86FA652FCB55E7D0705; Path=/; HttpOnly'), ('Content-Language', 'en-US')]
2016-11-30 12:09:00,741 InterfaceUnittestTestCase.py[line: 56] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:09:00,741 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为：到店支付
2016-11-30 12:09:00,741 unittesttestcase.py[line: 292] WARNING: 未检测到从服务器返回中提取内容的要求，请检查是否正确填写预期结果
2016-11-30 12:09:00,742 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:09:00,742 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="get", runtime="2016-11-30 12:08:59",step_action="{'参数': {'amount': 1, 'serial': '10549840601068216320', 'mallGoodsId': '26838', 'type': 1}, 'url': '/mall/tobuy/1?', '方法': 'get'}", expected_results="{'匹配规则': '包含字符串', '检查': 'body', '条件': [{'模式': '到店支付', '消息': '无法打开商品详情'}]}" WHERE executed_history_id = 20161130120835 AND testcase_id = 102 AND step_id = 104 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:09:00,759 testcase.py[line: 163] INFO: 测试用例[id=102, name=test-n-点击立即购买按钮]执行成功
2016-11-30 12:09:00,760 testplan.py[line: 76] INFO: 正在更新用例执行结果
2016-11-30 12:09:00,760 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 12:08:59" WHERE executed_history_id = 20161130120835 AND testcase_id = 102 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:09:00,885 testplan.py[line: 87] INFO: 正在更新testlink上测试计划[testplan_id=74, bulid_version=v1.0.0],对应用例[testcase_id=102]的执行结果
2016-11-30 12:09:01,024 testplan.py[line: 97] INFO: 测试计划[project=pj_wechatno ,testplan=plan1_of_wechatno]已执行完
2016-11-30 12:09:01,157 main.py[line: 136] INFO: 正在读取测项目[id：145, project：pj_pos]的协议，host，端口配置...
2016-11-30 12:09:01,157 main.py[line: 139] INFO: 成功读取配置信息：{"protocol":"https","host":"saofu.client.test.saofu.cn","port":80}
2016-11-30 12:09:01,159 main.py[line: 155] INFO: 正在执行测试项目[id：145, project：pj_pos]
2016-11-30 12:09:01,160 testproject.py[line: 23] INFO: 正在获取测试项目[id：145, name：pj_pos]对应对应的测试计划名称列表
2016-11-30 12:09:01,313 testproject.py[line: 28] INFO: 成功获取项目测试计划名称列表[list=['plan1_of_pos']]
2016-11-30 12:09:01,452 testproject.py[line: 38] INFO: 正在执行项目测试计划[project：pj_pos，testplan：plan1_of_pos]
2016-11-30 12:09:01,452 testplan.py[line: 29] INFO: 正在获取测试计划[project=pj_pos，name=plan1_of_pos]的测试用例
2016-11-30 12:09:01,605 testplan.py[line: 35] INFO: 成功获取测试计划[project=pj_pos，name=plan1_of_pos]的测试用例id：dict_keys(['152', '148'])
2016-11-30 12:09:01,736 testplan.py[line: 45] INFO: 获取测试用例信息 [{'is_open': '1', 'summary': '', 'tc_external_id': '2', 'preconditions': '', 'name': 'test-n-修改积分', 'version': '1', 'layout': '1', 'testcase_id': '152', 'creation_ts': '2016-07-28 12:10:09', 'modification_ts': '2016-11-30 00:19:08', 'active': '1', 'updater_id': '1', 'id': '153', 'testsuite_id': '151', 'estimated_exec_duration': '', 'importance': '2', 'updater_last_name': 'Administrator', 'updater_first_name': 'Testlink', 'full_tc_external_id': 'pj_pos-2', 'author_login': 'admin', 'author_last_name': 'Administrator', 'node_order': '1000', 'updater_login': 'admin', 'status': '1', 'execution_type': '1', 'author_first_name': 'Testlink', 'steps': [{'step_number': '1', 'active': '1', 'execution_type': '1', 'actions': '<p>\n\t<br />\n\t{&quot;函数&quot;：&quot;test_interface_of_json&quot;，</p>\n<p>\n\t&quot;请求头&quot;:{&quot;DeviceId&quot;:&quot;[CaseStep.device_no]&quot;, &quot;SerialNo&quot;:&quot;[CaseStep.serial_no]&quot;, &quot;Content-Type&quot;:&quot;application/json;charset=utf-8&quot;,&quot;ProductVersion&quot;:&quot;[global_product_version]&quot;,&quot;ProtocolVersion&quot;:&quot;[global_product_version]&quot;,&quot;OperatorId&quot;:&quot;[OperatorId]&quot;, &quot;Token&quot;:&quot;[Token]&quot;},</p>\n<p>\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/saofu-client/customer/customer_bonus_update_v3&quot;,<br />\n\t&quot;参数&quot;:{&quot;bonus&quot;:37593,&quot;code&quot;:&quot;17817738178&quot;}<br />\n\t}<br />\n\t&nbsp;</p>\n', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;:&quot;包含字符串&quot;,</p>\n<p>\n\t&quot;条件&quot;:[{&quot;模式&quot;:&quot;success\\&quot;:true&quot;, &quot;消息&quot;:&quot;修改积分失败&quot;}]</p>\n<p>\n\t}</p>\n', 'id': '154'}], 'author_id': '1'}]
2016-11-30 12:09:01,851 testplan.py[line: 69] INFO: 记录测试用例到测试用例报表
2016-11-30 12:09:01,852 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130120835', 152, 'test-n-修改积分', '扫码-修改积分接口', 'plan1_of_pos', 'pj_pos', 'Block', '')
2016-11-30 12:09:01,852 testplan.py[line: 72] INFO: 开始执行测试用例[id=152，name=test-n-修改积分]
2016-11-30 12:09:01,853 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"函数":"test_interface_of_json","请求头":{"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion":"[global_product_version]","ProtocolVersion":"[global_product_version]","OperatorId":"[OperatorId]", "Token":"[Token]"},"方法":"post","url":"/saofu-client/customer/customer_bonus_update_v3","参数":{"bonus":37593,"code":"17817738178"}} 
2016-11-30 12:09:01,853 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"success\":true", "消息":"修改积分失败"}]}
2016-11-30 12:09:01,853 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:09:01,853 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130120835', 152, 'test-n-修改积分', 'plan1_of_pos', 'pj_pos', 154, 1, '', 'https', 'saofu.client.test.saofu.cn', 80, '{"函数":"test_interface_of_json","请求头":{"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion":"[global_product_version]","ProtocolVersion":"[global_product_version]","OperatorId":"[OperatorId]", "Token":"[Token]"},"方法":"post","url":"/saofu-client/customer/customer_bonus_update_v3","参数":{"bonus":37593,"code":"17817738178"}} ', '{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"success\\":true", "消息":"修改积分失败"}]}', 'Block', '', '')
2016-11-30 12:09:01,854 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 12:09:01,854 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_json
2016-11-30 12:09:01,854 casestep.py[line: 104] INFO: 转换后的参数体为：{'code': '17817738178', 'bonus': 37593}
2016-11-30 12:09:01,854 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:09:01,854 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[CaseStep.device_no]
2016-11-30 12:09:01,854 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[CaseStep.serial_no]
2016-11-30 12:09:01,854 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[Token]
2016-11-30 12:09:01,855 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_product_version]
2016-11-30 12:09:01,855 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[OperatorId]
2016-11-30 12:09:01,855 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_product_version]
2016-11-30 12:09:01,855 casestep.py[line: 104] INFO: 转换后的参数体为：{'DeviceId': '182590014248006', 'SerialNo': 'HZ501FZA0F9M07D', 'Token': 'def70e1c-6fdb-48fd-bf9f-b2ce521fedd5', 'ProductVersion': '3.2.12C', 'OperatorId': 1318, 'ProtocolVersion': '3.2.12C', 'Content-Type': 'application/json;charset=utf-8'}
2016-11-30 12:09:01,855 InterfaceUnittestTestCase.py[line: 88] INFO: 正在发起POST请求...
2016-11-30 12:09:01,855 httpprotocol.py[line: 74] INFO: 发起的请求为：https://saofu.client.test.saofu.cn:80/saofu-client/customer/customer_bonus_update_v3
2016-11-30 12:09:01,855 httpprotocol.py[line: 75] INFO: 参数为：b'{"code": "17817738178", "bonus": 37593}'
2016-11-30 12:09:01,855 httpprotocol.py[line: 76] INFO: 请求头为：{'DeviceId': '182590014248006', 'SerialNo': 'HZ501FZA0F9M07D', 'Token': 'def70e1c-6fdb-48fd-bf9f-b2ce521fedd5', 'ProductVersion': '3.2.12C', 'ProtocolVersion': '3.2.12C', 'OperatorId': 1318, 'Content-Type': 'application/json;charset=utf-8'}
2016-11-30 12:09:01,858 httpprotocol.py[line: 86] ERROR: 发送请求失败，原因：<urlopen error TLS/SSL connection has been closed (EOF) (_ssl.c:547)>
2016-11-30 12:09:01,858 testcase.py[line: 111] ERROR: 步骤[1]执行出错,停止执行用例[id=152, name=test-n-修改积分]
2016-11-30 12:09:01,858 testcase.py[line: 118] INFO: 正在更新步骤执行结果
2016-11-30 12:09:01,859 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Error",reason="Traceback (most recent call last):  File E:\Projects\interface_project_for_dev\interface\InterfaceUnittestTestCase.py, line 97, in test_interface_of_json    encoding = chardet.detect(response[0])[encoding]TypeError: NoneType object is not subscriptable", protocol_method="post", runtime="2016-11-30 12:09:01",step_action="{'参数': {'code': '17817738178', 'bonus': 37593}, '方法': 'post', 'url': '/saofu-client/customer/customer_bonus_update_v3', '函数': 'test_interface_of_json', '请求头': {'DeviceId': '182590014248006', 'SerialNo': 'HZ501FZA0F9M07D', 'Token': 'def70e1c-6fdb-48fd-bf9f-b2ce521fedd5', 'ProductVersion': '3.2.12C', 'OperatorId': 1318, 'ProtocolVersion': '3.2.12C', 'Content-Type': 'application/json;charset=utf-8'}}", expected_results="{'匹配规则': '包含字符串', '检查': 'body', '条件': [{'模式': 'success':true', '消息': '修改积分失败'}]}" WHERE executed_history_id = 20161130120835 AND testcase_id = 152 AND step_id = 154 AND project='pj_pos' AND testplan='plan1_of_pos'
2016-11-30 12:09:01,861 testplan.py[line: 76] INFO: 正在更新用例执行结果
2016-11-30 12:09:01,861 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Error", runtime="2016-11-30 12:09:01" WHERE executed_history_id = 20161130120835 AND testcase_id = 152 AND project='pj_pos' AND testplan='plan1_of_pos'
2016-11-30 12:09:01,970 testplan.py[line: 87] INFO: 正在更新testlink上测试计划[testplan_id=146, bulid_version=v1.0.0],对应用例[testcase_id=152]的执行结果
2016-11-30 12:09:02,338 testplan.py[line: 45] INFO: 获取测试用例信息 [{'is_open': '1', 'summary': '', 'tc_external_id': '1', 'preconditions': '<p>\n\t{&quot;isglobal&quot;:1}</p>\n', 'name': 'test-n-登陆掌贝pos机', 'version': '1', 'layout': '1', 'testcase_id': '148', 'creation_ts': '2016-07-27 18:32:10', 'modification_ts': '2016-11-30 00:09:05', 'active': '1', 'updater_id': '1', 'id': '149', 'testsuite_id': '147', 'estimated_exec_duration': '', 'importance': '2', 'updater_last_name': 'Administrator', 'updater_first_name': 'Testlink', 'full_tc_external_id': 'pj_pos-1', 'author_login': 'admin', 'author_last_name': 'Administrator', 'node_order': '1000', 'updater_login': 'admin', 'status': '1', 'execution_type': '1', 'author_first_name': 'Testlink', 'steps': [{'step_number': '1', 'active': '1', 'execution_type': '1', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT branch_id FROM account_operator WHERE id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;(1318,)&quot;</p>\n<p>\n\t}</p>\n', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;branch_id&quot;:1}<br />\n\t}</p>\n', 'id': '183'}, {'step_number': '2', 'active': '1', 'execution_type': '1', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;([CaseStep.branch_id],)&quot;</p>\n<p>\n\t}</p>\n', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;device_no&quot;:1,&quot;serial_no&quot;:2}<br />\n\t}</p>\n', 'id': '182'}, {'step_number': '3', 'active': '1', 'execution_type': '1', 'actions': '<p>\n\t{&ldquo;函数&rdquo;：&ldquo;<span style="background-color:#e4e4ff;">test_interface_of_json</span>&rdquo;，</p>\n<p>\n\t&ldquo;请求头&rdquo;： {&quot;<span style="color:#008080;font-weight:bold;">DeviceId&quot;</span>:&quot;[CaseStep.device_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;SerialNo&quot;</span>:&quot;[CaseStep.serial_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;Content-Type&quot;</span>:&quot;<span style="color:#008080;font-weight:bold;">application/json;charset=utf-8&quot;</span>,<span style="color:#008080;font-weight:bold;">&quot;ProductVersion&quot;</span>: &quot;[global_product_version]&quot;, <span style="color:#008080;font-weight:bold;">&quot;ProtocolVersion&quot;</span>:&quot;[global_protocol_version]&quot;},</p>\n<p>\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/saofu-client/password/login&quot;,<br />\n\t&quot;参数&quot;:{&quot;id&quot;:&quot;1318&quot;,&quot;password&quot;:&quot;e10adc3949ba59abbe56e057f20f883e&quot;}<br />\n\t}</p>\n', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;：&quot;键值相等&quot;,</p>\n<p>\n\t&quot;条件&quot;：[{&quot;模式&quot;：{&quot;success&quot;:true}, &quot;消息&quot;：&ldquo;登录失败，success不为true&rdquo;},{&quot;模式&quot;：｛&quot;message&quot;: &quot;成功&quot;},&quot;消息&quot;：&ldquo;message不为成功&rdquo;}，{&quot;模式&quot;：｛&quot;code&quot;: &quot;4001&quot;},&quot;消息&quot;：&ldquo;code不为4001&rdquo;}],</p>\n<p>\n\t&quot;输出&quot;:{&quot;Token&quot;:{&quot;token&quot;:&quot;value&quot;},&quot;OperatorId&quot;:{&quot;operator&quot;:{&quot;id&quot;:&quot;value&quot;}}}</p>\n<p>\n\t}</p>\n', 'id': '150'}], 'author_id': '1'}]
2016-11-30 12:09:02,338 testplan.py[line: 52] INFO: 用例[id=148, name=test-n-登陆掌贝pos机]为全局初始化用例，已跳过执行
2016-11-30 12:09:02,338 testplan.py[line: 97] INFO: 测试计划[project=pj_pos ,testplan=plan1_of_pos]已执行完
2016-11-30 12:09:02,338 main.py[line: 247] INFO: 接口测试已执行完成，正在关闭数据库连接
2016-11-30 12:09:02,339 htmlreporter.py[line: 37] INFO: 正在查询测试用例总数
2016-11-30 12:09:02,340 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE executed_history_id = %s  data：('20161130120835',)
2016-11-30 12:09:02,343 htmlreporter.py[line: 43] INFO: 正在查询执行通过的用例数
2016-11-30 12:09:02,343 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE runresult = %s AND executed_history_id = %s  data：('Pass', '20161130120835')
2016-11-30 12:09:02,344 htmlreporter.py[line: 49] INFO: 正在查询执行失败的用例数
2016-11-30 12:09:02,344 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE runresult = %s AND executed_history_id = %s  data：('Fail', '20161130120835')
2016-11-30 12:09:02,346 htmlreporter.py[line: 55] INFO: 正在查询执行出错的用例数
2016-11-30 12:09:02,346 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE runresult = %s AND executed_history_id = %s  data：('Error', '20161130120835')
2016-11-30 12:09:02,347 htmlreporter.py[line: 61] INFO: 正在查询未执行的用例数
2016-11-30 12:09:02,347 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE runresult = %s AND executed_history_id = %s  data：('Block', '20161130120835')
2016-11-30 12:09:02,348 htmlreporter.py[line: 72] INFO: 正在查询已运的测试计划
2016-11-30 12:09:02,349 mydb.py[line: 100] INFO: query：SELECT project, testplan FROM testcase_report_tb WHERE executed_history_id = %s GROUP BY project, testplan ORDER BY id ASC  data：('20161130120835',)
2016-11-30 12:09:02,350 htmlreporter.py[line: 98] INFO: 正在查询测试计划[project：pj_pos, testplan：无计划]的测试用例执行结果
2016-11-30 12:09:02,350 mydb.py[line: 100] INFO: query：SELECT id, executed_history_id, testcase_id, testcase_name,testsuit, testplan, project, runresult, runtime FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s GROUP BY testcase_id ORDER BY id ASC  data：('pj_pos', '无计划', '20161130120835')
2016-11-30 12:09:02,352 htmlreporter.py[line: 105] INFO: 正在记录测试测试计划[project：pj_pos, testplan：无计划]的测试用例运行结果到测试报告
2016-11-30 12:09:02,352 htmlreporter.py[line: 98] INFO: 正在查询测试计划[project：pj_wechatno, testplan：plan1_of_wechatno]的测试用例执行结果
2016-11-30 12:09:02,353 mydb.py[line: 100] INFO: query：SELECT id, executed_history_id, testcase_id, testcase_name,testsuit, testplan, project, runresult, runtime FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s GROUP BY testcase_id ORDER BY id ASC  data：('pj_wechatno', 'plan1_of_wechatno', '20161130120835')
2016-11-30 12:09:02,355 htmlreporter.py[line: 105] INFO: 正在记录测试测试计划[project：pj_wechatno, testplan：plan1_of_wechatno]的测试用例运行结果到测试报告
2016-11-30 12:09:02,357 htmlreporter.py[line: 98] INFO: 正在查询测试计划[project：pj_pos, testplan：plan1_of_pos]的测试用例执行结果
2016-11-30 12:09:02,357 mydb.py[line: 100] INFO: query：SELECT id, executed_history_id, testcase_id, testcase_name,testsuit, testplan, project, runresult, runtime FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s GROUP BY testcase_id ORDER BY id ASC  data：('pj_pos', 'plan1_of_pos', '20161130120835')
2016-11-30 12:09:02,358 htmlreporter.py[line: 105] INFO: 正在记录测试测试计划[project：pj_pos, testplan：plan1_of_pos]的测试用例运行结果到测试报告
2016-11-30 12:09:02,359 htmlreporter.py[line: 115] INFO: 正在查询已运的测试计划
2016-11-30 12:09:02,359 mydb.py[line: 100] INFO: query：SELECT project, testplan FROM testcase_report_tb WHERE executed_history_id = %s GROUP BY project, testplan ORDER BY id ASC  data：('20161130120835',)
2016-11-30 12:09:02,360 htmlreporter.py[line: 127] INFO: 正在查询测试计划[project：pj_pos, testplan：无计划]已运行的测试用例
2016-11-30 12:09:02,361 mydb.py[line: 100] INFO: query：SELECT testcase_id, testcase_name, project, testplan FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s  GROUP BY testcase_id ORDER BY id ASC  data：('pj_pos', '无计划', '20161130120835')
2016-11-30 12:09:02,362 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=148]步骤运行结果
2016-11-30 12:09:02,363 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_pos', '无计划', 148, '20161130120835')
2016-11-30 12:09:02,366 htmlreporter.py[line: 127] INFO: 正在查询测试计划[project：pj_wechatno, testplan：plan1_of_wechatno]已运行的测试用例
2016-11-30 12:09:02,366 mydb.py[line: 100] INFO: query：SELECT testcase_id, testcase_name, project, testplan FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s  GROUP BY testcase_id ORDER BY id ASC  data：('pj_wechatno', 'plan1_of_wechatno', '20161130120835')
2016-11-30 12:09:02,368 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=110]步骤运行结果
2016-11-30 12:09:02,368 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 110, '20161130120835')
2016-11-30 12:09:02,370 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=88]步骤运行结果
2016-11-30 12:09:02,370 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 88, '20161130120835')
2016-11-30 12:09:02,373 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=98]步骤运行结果
2016-11-30 12:09:02,373 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 98, '20161130120835')
2016-11-30 12:09:02,375 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=120]步骤运行结果
2016-11-30 12:09:02,375 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 120, '20161130120835')
2016-11-30 12:09:02,378 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=114]步骤运行结果
2016-11-30 12:09:02,378 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 114, '20161130120835')
2016-11-30 12:09:02,382 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=106]步骤运行结果
2016-11-30 12:09:02,382 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 106, '20161130120835')
2016-11-30 12:09:02,384 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=76]步骤运行结果
2016-11-30 12:09:02,385 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 76, '20161130120835')
2016-11-30 12:09:02,387 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=93]步骤运行结果
2016-11-30 12:09:02,387 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 93, '20161130120835')
2016-11-30 12:09:02,391 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=80]步骤运行结果
2016-11-30 12:09:02,391 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 80, '20161130120835')
2016-11-30 12:09:02,394 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=126]步骤运行结果
2016-11-30 12:09:02,395 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 126, '20161130120835')
2016-11-30 12:09:02,398 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=102]步骤运行结果
2016-11-30 12:09:02,398 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 102, '20161130120835')
2016-11-30 12:09:02,400 htmlreporter.py[line: 127] INFO: 正在查询测试计划[project：pj_pos, testplan：plan1_of_pos]已运行的测试用例
2016-11-30 12:09:02,401 mydb.py[line: 100] INFO: query：SELECT testcase_id, testcase_name, project, testplan FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s  GROUP BY testcase_id ORDER BY id ASC  data：('pj_pos', 'plan1_of_pos', '20161130120835')
2016-11-30 12:09:02,403 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=152]步骤运行结果
2016-11-30 12:09:02,403 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_pos', 'plan1_of_pos', 152, '20161130120835')
2016-11-30 12:09:02,405 htmlreporter.py[line: 183] INFO: 正在设置测试报告结果文件名
2016-11-30 12:09:02,405 htmlreporter.py[line: 193] INFO: 测试报告文件名所在路径为：E:\\Projects\\report\\test_report20161130120835.html
2016-11-30 12:09:02,406 htmlreporter.py[line: 186] INFO: 正在生成测试报告
2016-11-30 12:09:02,410 main.py[line: 270] INFO: 生成测试报告成功
2016-11-30 12:09:02,562 main.py[line: 277] INFO: E:\\Projects\\report\\test_report20161130120835.html
2016-11-30 12:09:02,562 main.py[line: 280] INFO: 正在发送测试报告邮件...
2016-11-30 12:09:02,632 main.py[line: 284] INFO: 发送邮件成功
2016-11-30 12:11:06,877 global_var.py[line: 19] INFO: 当前运行环境：测试环境
2016-11-30 12:11:06,877 global_var.py[line: 20] INFO: 正在初始化数据库[名称：SAOFUDB1]对象
2016-11-30 12:11:06,894 global_var.py[line: 27] INFO: 正在初始化数据库[名称：TESTDB]对象
2016-11-30 12:11:06,899 global_var.py[line: 30] INFO: 正在获取testlink
2016-11-30 12:11:06,959 main.py[line: 63] INFO: 正在创建测试用例报告报表
2016-11-30 12:11:06,959 mydb.py[line: 43] INFO: query：CREATE TABLE IF NOT EXISTS testcase_report_tb                                         (id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,                                          executed_history_id varchar(50) NOT NULL,                                          testcase_id int NOT NULL,                                          testcase_name varchar(40) NOT NULL,                                          testsuit varchar(40),                                          testplan varchar(40),                                          project varchar(40),                                          runresult varchar(20),                                          runtime datetime)
2016-11-30 12:11:06,960 main.py[line: 66] INFO: 正在创建测试步骤报告报表
2016-11-30 12:11:06,960 mydb.py[line: 43] INFO: query：CREATE TABLE IF NOT EXISTS case_step_report_tb                                         (id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,                                          executed_history_id varchar(50) NOT NULL,                                          testcase_id int NOT NULL,                                          testcase_name varchar(40) NOT NULL,                                          testplan varchar(40) NOT NULL,                                          project varchar(40) NOT NULL,                                          step_id int,                                          step_num int NOT NULL,                                          step_action varchar(1000),                                           expected_results varchar(1000),                                          runresult varchar(10),                                          reason varchar(2000),                                          protocol_method varchar(40) ,                                          protocol varchar(40),                                          host varchar(40),                                          port int,                                          runtime datetime)
2016-11-30 12:11:06,962 main.py[line: 69] INFO: 正在读取运行模式配置
2016-11-30 12:11:06,964 main.py[line: 76] INFO: 正在运行全局初始化用例……
2016-11-30 12:11:06,965 main.py[line: 78] INFO: 待运行全局初始化用例id列表：[148]
2016-11-30 12:11:07,118 global_function.py[line: 23] INFO: 获取测试用例信息 [{'is_open': '1', 'steps': [{'id': '183', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;branch_id&quot;:1}<br />\n\t}</p>\n', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT branch_id FROM account_operator WHERE id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;(1318,)&quot;</p>\n<p>\n\t}</p>\n', 'step_number': '1', 'active': '1', 'execution_type': '1'}, {'id': '182', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;device_no&quot;:1,&quot;serial_no&quot;:2}<br />\n\t}</p>\n', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;([CaseStep.branch_id],)&quot;</p>\n<p>\n\t}</p>\n', 'step_number': '2', 'active': '1', 'execution_type': '1'}, {'id': '150', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;：&quot;键值相等&quot;,</p>\n<p>\n\t&quot;条件&quot;：[{&quot;模式&quot;：{&quot;success&quot;:true}, &quot;消息&quot;：&ldquo;登录失败，success不为true&rdquo;},{&quot;模式&quot;：｛&quot;message&quot;: &quot;成功&quot;},&quot;消息&quot;：&ldquo;message不为成功&rdquo;}，{&quot;模式&quot;：｛&quot;code&quot;: &quot;4001&quot;},&quot;消息&quot;：&ldquo;code不为4001&rdquo;}],</p>\n<p>\n\t&quot;输出&quot;:{&quot;Token&quot;:{&quot;token&quot;:&quot;value&quot;},&quot;OperatorId&quot;:{&quot;operator&quot;:{&quot;id&quot;:&quot;value&quot;}}}</p>\n<p>\n\t}</p>\n', 'actions': '<p>\n\t{&ldquo;函数&rdquo;：&ldquo;<span style="background-color:#e4e4ff;">test_interface_of_json</span>&rdquo;，</p>\n<p>\n\t&ldquo;请求头&rdquo;： {&quot;<span style="color:#008080;font-weight:bold;">DeviceId&quot;</span>:&quot;[CaseStep.device_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;SerialNo&quot;</span>:&quot;[CaseStep.serial_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;Content-Type&quot;</span>:&quot;<span style="color:#008080;font-weight:bold;">application/json;charset=utf-8&quot;</span>,<span style="color:#008080;font-weight:bold;">&quot;ProductVersion&quot;</span>: &quot;[global_product_version]&quot;, <span style="color:#008080;font-weight:bold;">&quot;ProtocolVersion&quot;</span>:&quot;[global_protocol_version]&quot;},</p>\n<p>\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/saofu-client/password/login&quot;,<br />\n\t&quot;参数&quot;:{&quot;id&quot;:&quot;1318&quot;,&quot;password&quot;:&quot;e10adc3949ba59abbe56e057f20f883e&quot;}<br />\n\t}</p>\n', 'step_number': '3', 'active': '1', 'execution_type': '1'}], 'id': '149', 'testsuite_id': '147', 'updater_id': '1', 'author_last_name': 'Administrator', 'active': '1', 'tc_external_id': '1', 'creation_ts': '2016-07-27 18:32:10', 'name': 'test-n-登陆掌贝pos机', 'updater_login': 'admin', 'execution_type': '1', 'author_id': '1', 'importance': '2', 'modification_ts': '2016-11-30 00:09:05', 'preconditions': '<p>\n\t{&quot;isglobal&quot;:1}</p>\n', 'updater_last_name': 'Administrator', 'version': '1', 'node_order': '1000', 'author_login': 'admin', 'updater_first_name': 'Testlink', 'author_first_name': 'Testlink', 'layout': '1', 'full_tc_external_id': 'pj_pos-1', 'summary': '', 'estimated_exec_duration': '', 'testcase_id': '148', 'status': '1'}]
2016-11-30 12:11:07,238 global_function.py[line: 43] INFO: 正在读取套件[id=147]的协议，host，端口配置...
2016-11-30 12:11:07,968 global_function.py[line: 72] INFO: 记录测试用例到测试用例报表
2016-11-30 12:11:07,969 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 148, 'test-n-登陆掌贝pos机', '登陆接口', '无计划', 'pj_pos', 'Block', '')
2016-11-30 12:11:07,970 global_function.py[line: 75] INFO: 开始执行测试用例[id=148，name=test-n-登陆掌贝pos机]
2016-11-30 12:11:07,970 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行sql","单条查询":"SELECT branch_id FROM account_operator WHERE id = %s","参数":"(1318,)"}
2016-11-30 12:11:07,970 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","输出":{"branch_id":1}}
2016-11-30 12:11:07,970 testcase.py[line: 55] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:07,971 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 148, 'test-n-登陆掌贝pos机', '无计划', 'pj_pos', 183, 1, '', '', '192.168.9.211', '3306', '{"步骤类型":"执行sql","单条查询":"SELECT branch_id FROM account_operator WHERE id = %s","参数":"(1318,)"}', '{"检查":"body","输出":{"branch_id":1}}', 'Block', '', '')
2016-11-30 12:11:07,972 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 12:11:07,973 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:11:07,973 mydb.py[line: 84] INFO: query：SELECT branch_id FROM account_operator WHERE id = %s  data：(1318,)
2016-11-30 12:11:07,977 casestep.py[line: 190] INFO: 数据库服务器返回的查询结果为为 query_result:(1485916418,), flag:True
2016-11-30 12:11:07,977 casestep.py[line: 192] INFO: 正在保存服务器返回结果到自定义变量
2016-11-30 12:11:07,977 casestep.py[line: 227] INFO: 提取的输出结果(key-value对)为:[{'branch_id': 1485916418}]
2016-11-30 12:11:07,977 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:07,977 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 12:11:07",step_action="{'参数': (1318,), '步骤类型': '执行sql', '单条查询': 'SELECT branch_id FROM account_operator WHERE id = %s'}", expected_results="{'检查': 'body', '输出': {'branch_id': 1}}" WHERE executed_history_id = 20161130121106 AND testcase_id = 148 AND step_id = 183 AND project='pj_pos' AND testplan='无计划'
2016-11-30 12:11:07,980 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行sql","单条查询":"SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s","参数":"([CaseStep.branch_id],)"}
2016-11-30 12:11:07,980 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","输出":{"device_no":1,"serial_no":2}}
2016-11-30 12:11:07,981 testcase.py[line: 55] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:07,981 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 148, 'test-n-登陆掌贝pos机', '无计划', 'pj_pos', 182, 2, '', '', '192.168.9.211', '3306', '{"步骤类型":"执行sql","单条查询":"SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s","参数":"([CaseStep.branch_id],)"}', '{"检查":"body","输出":{"device_no":1,"serial_no":2}}', 'Block', '', '')
2016-11-30 12:11:07,982 testcase.py[line: 77] INFO: 开始执行步骤操作[第2步]
2016-11-30 12:11:07,982 casestep.py[line: 115] INFO: 找到待替换的非全局动态参数：[CaseStep.branch_id]
2016-11-30 12:11:07,982 casestep.py[line: 138] INFO: 转换后的参数体为：(1485916418,)
2016-11-30 12:11:07,983 mydb.py[line: 84] INFO: query：SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s  data：(1485916418,)
2016-11-30 12:11:07,986 casestep.py[line: 190] INFO: 数据库服务器返回的查询结果为为 query_result:('182590014248006', 'HZ501FZA0F9M07D'), flag:True
2016-11-30 12:11:07,986 casestep.py[line: 192] INFO: 正在保存服务器返回结果到自定义变量
2016-11-30 12:11:07,987 casestep.py[line: 227] INFO: 提取的输出结果(key-value对)为:[{'branch_id': 1485916418}, {'device_no': '182590014248006'}, {'serial_no': 'HZ501FZA0F9M07D'}]
2016-11-30 12:11:07,987 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:07,987 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 12:11:07",step_action="{'参数': (1485916418,), '步骤类型': '执行sql', '单条查询': 'SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s'}", expected_results="{'检查': 'body', '输出': {'device_no': 1, 'serial_no': 2}}" WHERE executed_history_id = 20161130121106 AND testcase_id = 148 AND step_id = 182 AND project='pj_pos' AND testplan='无计划'
2016-11-30 12:11:07,990 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"函数":"test_interface_of_json","请求头": {"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion": "[global_product_version]", "ProtocolVersion":"[global_protocol_version]"},"方法":"post","url":"/saofu-client/password/login","参数":{"id":"1318","password":"e10adc3949ba59abbe56e057f20f883e"}}
2016-11-30 12:11:07,990 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"键值相等","条件":[{"模式":{"success":true}, "消息":"登录失败,success不为true"},{"模式":{"message": "成功"},"消息":"message不为成功"},{"模式":{"code": "4001"},"消息":"code不为4001"}],"输出":{"Token":{"token":"value"},"OperatorId":{"operator":{"id":"value"}}}}
2016-11-30 12:11:07,990 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:07,990 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 148, 'test-n-登陆掌贝pos机', '无计划', 'pj_pos', 150, 3, '', 'https', 'saofu.client.test.saofu.cn', 443, '{"函数":"test_interface_of_json","请求头": {"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion": "[global_product_version]", "ProtocolVersion":"[global_protocol_version]"},"方法":"post","url":"/saofu-client/password/login","参数":{"id":"1318","password":"e10adc3949ba59abbe56e057f20f883e"}}', '{"检查":"body","匹配规则":"键值相等","条件":[{"模式":{"success":true}, "消息":"登录失败,success不为true"},{"模式":{"message": "成功"},"消息":"message不为成功"},{"模式":{"code": "4001"},"消息":"code不为4001"}],"输出":{"Token":{"token":"value"},"OperatorId":{"operator":{"id":"value"}}}}', 'Block', '', '')
2016-11-30 12:11:07,992 testcase.py[line: 77] INFO: 开始执行步骤操作[第3步]
2016-11-30 12:11:07,992 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_json
2016-11-30 12:11:07,992 casestep.py[line: 104] INFO: 转换后的参数体为：{'id': '1318', 'password': 'e10adc3949ba59abbe56e057f20f883e'}
2016-11-30 12:11:07,992 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:11:07,992 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[CaseStep.device_no]
2016-11-30 12:11:07,993 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_protocol_version]
2016-11-30 12:11:07,993 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[CaseStep.serial_no]
2016-11-30 12:11:07,993 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_product_version]
2016-11-30 12:11:07,993 casestep.py[line: 104] INFO: 转换后的参数体为：{'DeviceId': '182590014248006', 'Content-Type': 'application/json;charset=utf-8', 'ProtocolVersion': '4.0', 'SerialNo': 'HZ501FZA0F9M07D', 'ProductVersion': '3.2.12C'}
2016-11-30 12:11:07,993 InterfaceUnittestTestCase.py[line: 88] INFO: 正在发起POST请求...
2016-11-30 12:11:07,993 httpprotocol.py[line: 74] INFO: 发起的请求为：https://saofu.client.test.saofu.cn:443/saofu-client/password/login
2016-11-30 12:11:07,994 httpprotocol.py[line: 75] INFO: 参数为：b'{"id": "1318", "password": "e10adc3949ba59abbe56e057f20f883e"}'
2016-11-30 12:11:07,994 httpprotocol.py[line: 76] INFO: 请求头为：{'DeviceId': '182590014248006', 'Content-Type': 'application/json;charset=utf-8', 'ProtocolVersion': '4.0', 'SerialNo': 'HZ501FZA0F9M07D', 'ProductVersion': '3.2.12C'}
2016-11-30 12:11:08,990 InterfaceUnittestTestCase.py[line: 98] INFO: 正在对服务器返回body进行解码
2016-11-30 12:11:08,991 InterfaceUnittestTestCase.py[line: 112] INFO: 服务器返回结果"响应体(body)": {"attach":["flag_appointment","flag_app_xiaoer","flag_cardcupon","flag_cash","flag_help_center","flag_info_center","flag_in_shop","flag_lake","flag_mt_wm","flag_order","flag_qrscan","flag_queue","flag_zhanggui"],"branchSerial":"cao","code":"4001","merchantKey":"10549840601068216320","message":"成功","operator":{"id":1318,"name":"接口测试","number":"1"},"reason":"成功","shopId":"1485916418","success":true,"token":"09e39fe9-0722-47f5-8480-b07661907830"}
2016-11-30 12:11:08,991 InterfaceUnittestTestCase.py[line: 113] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:11:12 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('EXCLUDE_ENCRYPT', 'true'), ('Vary', 'Accept-Encoding')]
2016-11-30 12:11:08,991 InterfaceUnittestTestCase.py[line: 114] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:11:08,991 unittesttestcase.py[line: 106] INFO: 要匹配的字典key,value层级为：['success', True]
2016-11-30 12:11:08,991 unittesttestcase.py[line: 109] INFO: 找到的对应字典层级的最后值为：True
2016-11-30 12:11:08,992 unittesttestcase.py[line: 106] INFO: 要匹配的字典key,value层级为：['message', '成功']
2016-11-30 12:11:08,992 unittesttestcase.py[line: 109] INFO: 找到的对应字典层级的最后值为：成功
2016-11-30 12:11:08,992 unittesttestcase.py[line: 106] INFO: 要匹配的字典key,value层级为：['code', '4001']
2016-11-30 12:11:08,992 unittesttestcase.py[line: 109] INFO: 找到的对应字典层级的最后值为：4001
2016-11-30 12:11:08,992 unittesttestcase.py[line: 225] INFO: 要提取的字典key,value层级为：['operator', 'id', 'value']
2016-11-30 12:11:08,992 unittesttestcase.py[line: 239] INFO: 找到的对应字典层级的key的值为：1318
2016-11-30 12:11:08,992 unittesttestcase.py[line: 263] INFO: 获取到的变量的值为：1318
2016-11-30 12:11:08,992 unittesttestcase.py[line: 225] INFO: 要提取的字典key,value层级为：['token', 'value']
2016-11-30 12:11:08,993 unittesttestcase.py[line: 239] INFO: 找到的对应字典层级的key的值为：09e39fe9-0722-47f5-8480-b07661907830
2016-11-30 12:11:08,993 unittesttestcase.py[line: 263] INFO: 获取到的变量的值为：09e39fe9-0722-47f5-8480-b07661907830
2016-11-30 12:11:08,993 unittesttestcase.py[line: 290] INFO: 提取的输出结果(key-value对)为:[{'OperatorId': 1318}, {'Token': '09e39fe9-0722-47f5-8480-b07661907830'}]
2016-11-30 12:11:08,993 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:08,993 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="post", runtime="2016-11-30 12:11:07",step_action="{'函数': 'test_interface_of_json', '方法': 'post', '参数': {'id': '1318', 'password': 'e10adc3949ba59abbe56e057f20f883e'}, 'url': '/saofu-client/password/login', '请求头': {'DeviceId': '182590014248006', 'Content-Type': 'application/json;charset=utf-8', 'ProtocolVersion': '4.0', 'SerialNo': 'HZ501FZA0F9M07D', 'ProductVersion': '3.2.12C'}}", expected_results="{'条件': [{'消息': '登录失败,success不为true', '模式': {'success': True}}, {'消息': 'message不为成功', '模式': {'message': '成功'}}, {'消息': 'code不为4001', '模式': {'code': '4001'}}], '检查': 'body', '输出': {'OperatorId': {'operator': {'id': 'value'}}, 'Token': {'token': 'value'}}, '匹配规则': '键值相等'}" WHERE executed_history_id = 20161130121106 AND testcase_id = 148 AND step_id = 150 AND project='pj_pos' AND testplan='无计划'
2016-11-30 12:11:08,996 testcase.py[line: 163] INFO: 测试用例[id=148, name=test-n-登陆掌贝pos机]执行成功
2016-11-30 12:11:08,996 global_function.py[line: 79] INFO: 正在更新用例执行结果
2016-11-30 12:11:08,996 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 12:11:07" WHERE executed_history_id = 20161130121106 and testcase_id = 148 AND project='pj_pos' AND testplan='无计划'
2016-11-30 12:11:08,998 global_function.py[line: 86] INFO: 指定用例[148]已执行完
2016-11-30 12:11:08,998 main.py[line: 81] INFO: 用例[148]运行结果：('Pass', '')
2016-11-30 12:11:08,998 main.py[line: 84] INFO: 按项目运行测试
2016-11-30 12:11:08,999 main.py[line: 120] INFO: 运行指定项目
2016-11-30 12:11:09,151 main.py[line: 136] INFO: 正在读取测项目[id：73, project：pj_wechatno]的协议，host，端口配置...
2016-11-30 12:11:09,151 main.py[line: 139] INFO: 成功读取配置信息：{"protocol":"http","host":"m.test.saofu.cn","port":80} 
2016-11-30 12:11:09,153 main.py[line: 155] INFO: 正在执行测试项目[id：73, project：pj_wechatno]
2016-11-30 12:11:09,153 testproject.py[line: 23] INFO: 正在获取测试项目[id：73, name：pj_wechatno]对应对应的测试计划名称列表
2016-11-30 12:11:09,287 testproject.py[line: 28] INFO: 成功获取项目测试计划名称列表[list=['plan1_of_wechatno']]
2016-11-30 12:11:09,409 testproject.py[line: 38] INFO: 正在执行项目测试计划[project：pj_wechatno，testplan：plan1_of_wechatno]
2016-11-30 12:11:09,409 testplan.py[line: 29] INFO: 正在获取测试计划[project=pj_wechatno，name=plan1_of_wechatno]的测试用例
2016-11-30 12:11:09,536 testplan.py[line: 35] INFO: 成功获取测试计划[project=pj_wechatno，name=plan1_of_wechatno]的测试用例id：dict_keys(['110', '106', '126', '98', '120', '88', '76', '114', '80', '102', '93'])
2016-11-30 12:11:09,666 testplan.py[line: 45] INFO: 获取测试用例信息 [{'is_open': '1', 'steps': [{'id': '112', 'expected_results': '<p>\n\t{&quot;output_arg1&quot;:&quot;CMOrder.attach&quot;}</p>\n', 'actions': '<p>\n\t{<br />\n\t&quot;style&quot;:&quot;testcase&quot;,<br />\n\t<br />\n\t&quot;testcase_id&quot;:114,<br />\n\t<br />\n\t&quot;testcase_name&quot;:&quot;test-n-提交储值卡支付订单-pay5重定向&quot;<br />\n\t}</p>\n', 'step_number': '1', 'active': '1', 'execution_type': '1'}, {'id': '119', 'expected_results': '<p>\n\t{&quot;success&quot;:1, &quot;receipt_fee&quot;:&quot;动态校验&quot;, &quot;balance&quot;:&quot;动态校验&quot;, &quot;bonus&quot;:&quot;动态校验&quot;, &quot;sum_amount_expend&quot;:&quot;动态校验&quot;,&nbsp; &quot;sum_bonus_expend&quot;:&quot;动态校验&quot;, &quot;balance_total&quot;:&quot;动态校验&quot;}</p>\n', 'actions': '<p>\n\t{<br />\n\t&quot;class&quot;:&quot;CardPay&quot;,<br />\n\t&quot;function&quot;:&quot;test_account_pay_without_discount&quot;,<br />\n\t&quot;method&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/pay/card/doconfirm&quot;,<br />\n\t&quot;params&quot;:{&quot;orderId&quot;:&quot;[var]&quot;, &quot;openId&quot;:&quot;[global_openId]&quot;, &quot;productOrderId&quot;:&quot;[CMOrder.attach]&quot;,&quot;customerId&quot;:&quot;[var]&quot;, &quot;type&quot;:1, &quot;cardId&quot;:&quot;&quot;,&quot;customerName&quot;:&quot;[var]&quot;, &quot;shopId&quot;:&quot;[var]&quot;, &quot;yhCardId&quot;:-1,&quot;yhCardType&quot;:-1}<br />\n\t}</p>\n', 'step_number': '3', 'active': '1', 'execution_type': '1'}], 'id': '111', 'testsuite_id': '109', 'updater_id': '1', 'author_last_name': 'Administrator', 'active': '0', 'tc_external_id': '9', 'creation_ts': '2016-07-22 14:48:17', 'name': 'test-n-储值卡支付-不使用优惠，会员账户支付', 'updater_login': 'admin', 'execution_type': '1', 'author_id': '1', 'importance': '2', 'modification_ts': '2016-07-29 17:13:06', 'preconditions': '', 'updater_last_name': 'Administrator', 'version': '1', 'node_order': '2', 'author_login': 'admin', 'updater_first_name': 'Testlink', 'author_first_name': 'Testlink', 'layout': '1', 'full_tc_external_id': 'wecharno-9', 'summary': '<p>\n\t消费不赠送积分,单规格商品</p>\n', 'estimated_exec_duration': '', 'testcase_id': '110', 'status': '1'}]
2016-11-30 12:11:09,783 testplan.py[line: 69] INFO: 记录测试用例到测试用例报表
2016-11-30 12:11:09,783 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 110, 'test-n-储值卡支付-不使用优惠，会员账户支付', '微商城-储值卡支付接口', 'plan1_of_wechatno', 'pj_wechatno', 'Block', '')
2016-11-30 12:11:09,785 testplan.py[line: 72] INFO: 开始执行测试用例[id=110，name=test-n-储值卡支付-不使用优惠，会员账户支付]
2016-11-30 12:11:09,785 testcase.py[line: 27] WARNING: 用例[name=test-n-储值卡支付-不使用优惠，会员账户支付]处于禁用状态[active=0]，不执行
2016-11-30 12:11:09,785 testplan.py[line: 76] INFO: 正在更新用例执行结果
2016-11-30 12:11:09,786 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Block", runtime="2016-11-30 12:11:09" WHERE executed_history_id = 20161130121106 AND testcase_id = 110 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:09,906 testplan.py[line: 87] INFO: 正在更新testlink上测试计划[testplan_id=74, bulid_version=v1.0.0],对应用例[testcase_id=110]的执行结果
2016-11-30 12:11:10,068 testplan.py[line: 45] INFO: 获取测试用例信息 [{'is_open': '1', 'steps': [{'id': '108', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;匹配规则&quot;:&quot;包含字符串&quot;,<br />\n\t&quot;条件&quot;:[{&quot;模式&quot;:&quot;\\&quot;success\\&quot;:true&quot;, &quot;消息&quot;:&quot;创建储值卡支付订单失败，success不为True&quot;}],</p>\n<p>\n\t&quot;输出&quot;:{&quot;success&quot;: &quot;\\&quot;success\\&quot;:(.+?),&quot;,&quot;attach&quot;:&quot;attach\\&quot;:\\&quot;(.+?)\\&quot;&quot;}<br />\n\t}</p>\n', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;请求头&quot;：{&quot;Content-Type&quot;:&quot;application/x-www-form-urlencoded&quot;,&quot;charset&quot;:&quot;utf-8&quot;},<br />\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/cmorder/1/4&quot;,<br />\n\t&quot;参数&quot;:{&quot;serial&quot;:&quot;[global_serial]&quot;,&quot;openId&quot;:&quot;[global_openId]&quot;,&quot;fm&quot;:1,&quot;mallGoodsId&quot;:&quot;26838&quot;, &quot;amount&quot;:1,&quot;cartIds&quot;:&quot;&quot;,&quot;fetchTime&quot;:&quot;&quot;, &quot;remark&quot;:&quot;&quot;}<br />\n\t}</p>\n', 'step_number': '1', 'active': '1', 'execution_type': '1'}], 'id': '107', 'testsuite_id': '105', 'updater_id': '1', 'author_last_name': 'Administrator', 'active': '1', 'tc_external_id': '8', 'creation_ts': '2016-07-21 11:26:32', 'name': 'test-n-创建储值卡支付订单', 'updater_login': 'admin', 'execution_type': '1', 'author_id': '1', 'importance': '2', 'modification_ts': '2016-11-29 17:33:09', 'preconditions': '', 'updater_last_name': 'Administrator', 'version': '1', 'node_order': '1000', 'author_login': 'admin', 'updater_first_name': 'Testlink', 'author_first_name': 'Testlink', 'layout': '1', 'full_tc_external_id': 'wecharno-8', 'summary': '', 'estimated_exec_duration': '', 'testcase_id': '106', 'status': '1'}]
2016-11-30 12:11:10,194 testplan.py[line: 69] INFO: 记录测试用例到测试用例报表
2016-11-30 12:11:10,194 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 106, 'test-n-创建储值卡支付订单', '微商城-创建储值卡支付订单接口', 'plan1_of_wechatno', 'pj_wechatno', 'Block', '')
2016-11-30 12:11:10,195 testplan.py[line: 72] INFO: 开始执行测试用例[id=106，name=test-n-创建储值卡支付订单]
2016-11-30 12:11:10,195 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"请求头":{"Content-Type":"application/x-www-form-urlencoded","charset":"utf-8"},"方法":"post","url":"/cmorder/1/4","参数":{"serial":"[global_serial]","openId":"[global_openId]","fm":1,"mallGoodsId":"26838", "amount":1,"cartIds":"","fetchTime":"", "remark":""}}
2016-11-30 12:11:10,195 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"\"success\":true", "消息":"创建储值卡支付订单失败,success不为True"}],"输出":{"success": "\"success\":(.+?),","attach":"attach\":\"(.+?)\""}}
2016-11-30 12:11:10,196 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:10,196 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 106, 'test-n-创建储值卡支付订单', 'plan1_of_wechatno', 'pj_wechatno', 108, 1, '', 'http', 'm.test.saofu.cn', 80, '{"请求头":{"Content-Type":"application/x-www-form-urlencoded","charset":"utf-8"},"方法":"post","url":"/cmorder/1/4","参数":{"serial":"[global_serial]","openId":"[global_openId]","fm":1,"mallGoodsId":"26838", "amount":1,"cartIds":"","fetchTime":"", "remark":""}}', '{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"\\"success\\":true", "消息":"创建储值卡支付订单失败,success不为True"}],"输出":{"success": "\\"success\\":(.+?),","attach":"attach\\":\\"(.+?)\\""}}', 'Block', '', '')
2016-11-30 12:11:10,197 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 12:11:10,197 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_urlencode
2016-11-30 12:11:10,197 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_openId]
2016-11-30 12:11:10,197 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_serial]
2016-11-30 12:11:10,197 casestep.py[line: 104] INFO: 转换后的参数体为：{'cartIds': '', 'openId': 'ous64uFCCLMyXYDJ-MkNilyCI5CY', 'amount': 1, 'fm': 1, 'mallGoodsId': '26838', 'remark': '', 'fetchTime': '', 'serial': '10549840601068216320'}
2016-11-30 12:11:10,197 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:11:10,198 casestep.py[line: 104] INFO: 转换后的参数体为：{'Content-Type': 'application/x-www-form-urlencoded', 'charset': 'utf-8'}
2016-11-30 12:11:10,198 InterfaceUnittestTestCase.py[line: 30] INFO: 正在发起POST请求...
2016-11-30 12:11:10,198 httpprotocol.py[line: 74] INFO: 发起的请求为：http://m.test.saofu.cn:80/cmorder/1/4
2016-11-30 12:11:10,198 httpprotocol.py[line: 75] INFO: 参数为：b'cartIds=&openId=ous64uFCCLMyXYDJ-MkNilyCI5CY&amount=1&fm=1&mallGoodsId=26838&remark=&fetchTime=&serial=10549840601068216320'
2016-11-30 12:11:10,198 httpprotocol.py[line: 76] INFO: 请求头为：{'Content-Type': 'application/x-www-form-urlencoded', 'charset': 'utf-8', 'Cookie': '10549840601068216320=ous64uFCCLMyXYDJ-MkNilyCI5CY'}
2016-11-30 12:11:13,419 InterfaceUnittestTestCase.py[line: 40] INFO: 正在对服务器返回body进行解码
2016-11-30 12:11:13,421 InterfaceUnittestTestCase.py[line: 54] INFO: 服务器返回结果"响应体(body)": {"success":true,"message":null,"attach":"20803813611848552448"}
2016-11-30 12:11:13,421 InterfaceUnittestTestCase.py[line: 55] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:11:16 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('Vary', 'Accept-Encoding')]
2016-11-30 12:11:13,421 InterfaceUnittestTestCase.py[line: 56] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:11:13,422 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为："success":true
2016-11-30 12:11:13,422 unittesttestcase.py[line: 278] INFO: 获取到的变量的值为：['true']
2016-11-30 12:11:13,422 unittesttestcase.py[line: 278] INFO: 获取到的变量的值为：['20803813611848552448']
2016-11-30 12:11:13,422 unittesttestcase.py[line: 290] INFO: 提取的输出结果(key-value对)为:[{'OperatorId': 1318}, {'Token': '09e39fe9-0722-47f5-8480-b07661907830'}, {'success_1': 'true'}, {'attach_1': '20803813611848552448'}]
2016-11-30 12:11:13,423 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:13,423 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="post", runtime="2016-11-30 12:11:10",step_action="{'参数': {'cartIds': '', 'openId': 'ous64uFCCLMyXYDJ-MkNilyCI5CY', 'amount': 1, 'fm': 1, 'mallGoodsId': '26838', 'remark': '', 'fetchTime': '', 'serial': '10549840601068216320'}, '方法': 'post', 'url': '/cmorder/1/4', '请求头': {'Content-Type': 'application/x-www-form-urlencoded', 'charset': 'utf-8'}}", expected_results="{'条件': [{'消息': '创建储值卡支付订单失败,success不为True', '模式': ''success':true'}], '检查': 'body', '输出': {'success': ''success':(.+?),', 'attach': 'attach':'(.+?)''}, '匹配规则': '包含字符串'}" WHERE executed_history_id = 20161130121106 AND testcase_id = 106 AND step_id = 108 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:13,426 testcase.py[line: 163] INFO: 测试用例[id=106, name=test-n-创建储值卡支付订单]执行成功
2016-11-30 12:11:13,426 testplan.py[line: 76] INFO: 正在更新用例执行结果
2016-11-30 12:11:13,426 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 12:11:10" WHERE executed_history_id = 20161130121106 AND testcase_id = 106 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:13,554 testplan.py[line: 87] INFO: 正在更新testlink上测试计划[testplan_id=74, bulid_version=v1.0.0],对应用例[testcase_id=106]的执行结果
2016-11-30 12:11:13,839 testplan.py[line: 45] INFO: 获取测试用例信息 [{'is_open': '1', 'steps': [{'id': '181', 'expected_results': '', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行SQl&quot;,</p>\n<p>\n\t&quot;更新&quot;:&quot;UPDATE base_info SET sku_quantity = 1000&nbsp; WHERE serial = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;(\\&quot;40758966216286146560\\&quot;,)&quot;</p>\n<p>\n\t}</p>\n', 'step_number': '1', 'active': '1', 'execution_type': '1'}, {'id': '180', 'expected_results': '', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;更新&quot;:&quot;</p>\n<pre style="background-color:#ffffff;color:#000000;font-family:\'宋体\';font-size:12pt;">\n<span style="color:#008080;font-weight:bold;">UPDATE base_info SET listing = 1  WHERE serial = %s</span>&quot;,\n</pre>\n<p>\n\t&quot;参数&quot;:&quot;(40758966216286146560,)&quot;</p>\n<p>\n\t}</p>\n', 'step_number': '2', 'active': '1', 'execution_type': '1'}, {'id': '128', 'expected_results': '<p>\n\t{</p>\n<p>\n\t&quot;检查&quot;：&ldquo;body&rdquo;,</p>\n<p>\n\t&quot;匹配规则&quot;：&ldquo;包含字符串&rdquo;,</p>\n<p>\n\t&ldquo;条件&rdquo;：[{&quot;模式&quot;：&ldquo;success\\&quot;:true&quot;,&quot;消息&quot;：&ldquo;<span style="color:#008080;font-weight:bold;">success不为ture,领取卡券失败</span>&rdquo;}]</p>\n<p>\n\t}</p>\n', 'actions': '<p>\n\t{<br />\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;urL&quot;:&quot;/kq/getincoupon/40758966216286146560/[global_openId]&quot;,<br />\n\t&quot;参数&quot;:&quot;&quot;<br />\n\t}</p>\n', 'step_number': '3', 'active': '1', 'execution_type': '1'}], 'id': '127', 'testsuite_id': '125', 'updater_id': '1', 'author_last_name': 'Administrator', 'active': '1', 'tc_external_id': '12', 'creation_ts': '2016-07-26 15:06:38', 'name': 'test-n-免费领取优惠券', 'updater_login': 'admin', 'execution_type': '1', 'author_id': '1', 'importance': '2', 'modification_ts': '2016-11-29 19:43:22', 'preconditions': '', 'updater_last_name': 'Administrator', 'version': '1', 'node_order': '1000', 'author_login': 'admin', 'updater_first_name': 'Testlink', 'author_first_name': 'Testlink', 'layout': '1', 'full_tc_external_id': 'wecharno-12', 'summary': '<p>\n\t1、运行时，ulr中的40758966216286146560取自base_info.serial字段</p>\n<p>\n\t&nbsp;</p>\n<p>\n\t&nbsp;</p>\n', 'estimated_exec_duration': '', 'testcase_id': '126', 'status': '1'}]
2016-11-30 12:11:13,970 testplan.py[line: 69] INFO: 记录测试用例到测试用例报表
2016-11-30 12:11:13,971 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 126, 'test-n-免费领取优惠券', '卡券中心-免费领取卡券接口', 'plan1_of_wechatno', 'pj_wechatno', 'Block', '')
2016-11-30 12:11:13,973 testplan.py[line: 72] INFO: 开始执行测试用例[id=126，name=test-n-免费领取优惠券]
2016-11-30 12:11:13,973 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行SQl","更新":"UPDATE base_info SET sku_quantity = 1000  WHERE serial = %s","参数":"(\"40758966216286146560\",)"}
2016-11-30 12:11:13,973 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：
2016-11-30 12:11:13,973 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 12:11:13,974 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:11:13,974 mydb.py[line: 70] INFO: query：UPDATE base_info SET sku_quantity = 1000  WHERE serial = 40758966216286146560
2016-11-30 12:11:14,451 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:14,451 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 12:11:13",step_action="{'参数': ('40758966216286146560',), '更新': 'UPDATE base_info SET sku_quantity = 1000  WHERE serial = %s', '步骤类型': '执行SQl'}", expected_results="" WHERE executed_history_id = 20161130121106 AND testcase_id = 126 AND step_id = 181 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:14,457 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行sql","更新":"UPDATE base_info SET listing = 1  WHERE serial = %s","参数":"(40758966216286146560,)"}
2016-11-30 12:11:14,457 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：
2016-11-30 12:11:14,457 testcase.py[line: 55] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:14,458 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 126, 'test-n-免费领取优惠券', 'plan1_of_wechatno', 'pj_wechatno', 180, 2, '', '', '192.168.9.211', '3306', '{"步骤类型":"执行sql","更新":"UPDATE base_info SET listing = 1  WHERE serial = %s","参数":"(40758966216286146560,)"}', '', 'Block', '', '')
2016-11-30 12:11:14,460 testcase.py[line: 77] INFO: 开始执行步骤操作[第2步]
2016-11-30 12:11:14,461 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:11:14,461 mydb.py[line: 70] INFO: query：UPDATE base_info SET listing = 1  WHERE serial = 40758966216286146560
2016-11-30 12:11:14,468 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:14,468 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 12:11:14",step_action="{'参数': (40758966216286146560,), '更新': 'UPDATE base_info SET listing = 1  WHERE serial = %s', '步骤类型': '执行sql'}", expected_results="" WHERE executed_history_id = 20161130121106 AND testcase_id = 126 AND step_id = 180 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:14,475 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"方法":"post","url":"/kq/getincoupon/40758966216286146560/[global_openId]","参数":""}
2016-11-30 12:11:14,475 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"success\":true","消息":"success不为ture,领取卡券失败"}]}
2016-11-30 12:11:14,475 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:14,476 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 126, 'test-n-免费领取优惠券', 'plan1_of_wechatno', 'pj_wechatno', 128, 3, '', 'http', 'm.test.saofu.cn', 80, '{"方法":"post","url":"/kq/getincoupon/40758966216286146560/[global_openId]","参数":""}', '{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"success\\":true","消息":"success不为ture,领取卡券失败"}]}', 'Block', '', '')
2016-11-30 12:11:14,479 testcase.py[line: 77] INFO: 开始执行步骤操作[第3步]
2016-11-30 12:11:14,479 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_urlencode
2016-11-30 12:11:14,480 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:11:14,480 casestep.py[line: 129] INFO: 找到待替换的全局动态参数：[global_openId]
2016-11-30 12:11:14,480 casestep.py[line: 138] INFO: 转换后的参数体为：/kq/getincoupon/40758966216286146560/ous64uFCCLMyXYDJ-MkNilyCI5CY
2016-11-30 12:11:14,481 InterfaceUnittestTestCase.py[line: 30] INFO: 正在发起POST请求...
2016-11-30 12:11:14,481 httpprotocol.py[line: 74] INFO: 发起的请求为：http://m.test.saofu.cn:80/kq/getincoupon/40758966216286146560/ous64uFCCLMyXYDJ-MkNilyCI5CY
2016-11-30 12:11:14,481 httpprotocol.py[line: 75] INFO: 参数为：b''
2016-11-30 12:11:14,482 httpprotocol.py[line: 76] INFO: 请求头为：{'Cookie': '10549840601068216320=ous64uFCCLMyXYDJ-MkNilyCI5CY'}
2016-11-30 12:11:15,574 InterfaceUnittestTestCase.py[line: 40] INFO: 正在对服务器返回body进行解码
2016-11-30 12:11:15,574 InterfaceUnittestTestCase.py[line: 54] INFO: 服务器返回结果"响应体(body)": {"code":"4001","reason":null,"result":null,"getByWeixin":false,"cardCode":"519880500426","couponWeiXinCustomerId":135542,"jsapi":null,"couponWeixinCustomers":null,"weixinVersion":null,"cardPreprintLogId":null,"jssdk":null,"cwc":{"id":135542,"cw":{"id":1421,"shop":{"id":42,"serial":"10549840601068216320","parent":null,"phoneNumber":null,"email":null,"fullName":null,"name":"深圳云移","logoUrl":"upload/image/2016/10/26/1de0a376-5315-4191-b577-c459edbb1ee1.jpg","printAdUrl":null,"printAdText":null,"createTime":null,"shopType":null,"sblist":null,"idlist":null,"shopAccount":null,"subShops":null,"account":null,"shopRole":null,"suffixShop":null,"thirdAppId":null},"cardId":null,"cardType":"cash","baseInfo":{"id":2001,"frontImageUrl":"http://res.yunnex.com/saofu/coupon/11.png","appid":null,"codeType":2,"title":"接口-代金券","subTitle":"","color":"509fc9","notice":"接口自动化测试专用，烦请勿动","servicePhone":"07556644511","description":"接口自动化测试专用，烦请勿动，勿修改，勿下架","useLimit":1,"getLimit":null,"dateInfoType":1,"dateInfoBeginTimestamp":1469721600000,"dateInfoEndTimestamp":1517328000000,"dateInfoBeginTimestampStr":null,"dateInfoEndTimestampStr":null,"dateInfoFixedTerm":null,"fixedBeginTerm":null,"skuQuantity":1000,"getInType":3,"serial":"40758966216286146560","cardType":1,"listing":1,"canShare":false,"fitAll":true,"coverShow":null,"shopId":42,"checkPass":null,"modifyTime":null,"cardId":null,"couponId":null,"price":null,"allowedScope":"ONLINE","detailImgUrl":"upload/file/2016/09/14/ed0d5ffa-fd1b-46b8-8b9e-236cd9732eda.jpeg","detailTxt":"文字描述","backGroundPicUrl":null,"timeLimitList":[],"cardCouponCardType":null,"gift":null,"cashLeastCost":null,"cashReduceCost":null,"discount":null,"masterCardId":null},"generalCouponDefaultDetail":"","grouponDealDetail":null,"gift":"","cashLeastCost":2,"cashReduceCost":1,"discount":0,"createTime":1469786621000,"checkPass":-1,"delFlag":null,"modifyTime":null,"coverShow":null,"isGoodsCoupon":null,"changeStock":null,"batchVerifyLimit":1,"cashOverlay":true},"customer":{"id":167020,"channel":1,"channelSerial":"ous64uFCCLMyXYDJ-MkNilyCI5CY","shopId":42,"createTime":1477636412000,"mobile":"17817738178","name":"fuyu","sex":1,"weixinNickname":"MrLai","headImgUrl":"http://wx.qlogo.cn/mmopen/JZnr5tqrZvdT3tvbobWgCKXdkUvJnaPrL5qs8HxWruHVzmvMj7NciamlgTP89ibKaGoLpxcW3el6Xs2Wrib8ovicSgPIZ6Kmk1UQ/0","lastUpdateTime":1480479079560,"customerGroupId":100,"groupName":null,"province":"广东","city":"深圳","subscribeTime":1477391385000,"balance":null,"bonus":null,"memberCount":null,"handoutStatus":null,"registerTime":1477636535000,"activeTime":null,"member":true},"serial":"519880500426","createTime":1480479079881,"getedSync":null,"channel":-1,"branchId":-1,"operatorId":0,"lakeUserId":null,"effectTime":null,"expireTime":null,"status":null,"baseInfo":null},"serialList":null,"success":true}
2016-11-30 12:11:15,574 InterfaceUnittestTestCase.py[line: 55] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:11:18 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('Vary', 'Accept-Encoding')]
2016-11-30 12:11:15,575 InterfaceUnittestTestCase.py[line: 56] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:11:15,575 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为：success":true
2016-11-30 12:11:15,575 unittesttestcase.py[line: 292] WARNING: 未检测到从服务器返回中提取内容的要求，请检查是否正确填写预期结果
2016-11-30 12:11:15,575 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:15,575 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="post", runtime="2016-11-30 12:11:14",step_action="{'方法': 'post', 'url': '/kq/getincoupon/40758966216286146560/ous64uFCCLMyXYDJ-MkNilyCI5CY', '参数': ''}", expected_results="{'条件': [{'消息': 'success不为ture,领取卡券失败', '模式': 'success':true'}], '检查': 'body', '匹配规则': '包含字符串'}" WHERE executed_history_id = 20161130121106 AND testcase_id = 126 AND step_id = 128 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:15,578 testcase.py[line: 163] INFO: 测试用例[id=126, name=test-n-免费领取优惠券]执行成功
2016-11-30 12:11:15,578 testplan.py[line: 76] INFO: 正在更新用例执行结果
2016-11-30 12:11:15,579 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 12:11:13" WHERE executed_history_id = 20161130121106 AND testcase_id = 126 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:15,698 testplan.py[line: 87] INFO: 正在更新testlink上测试计划[testplan_id=74, bulid_version=v1.0.0],对应用例[testcase_id=126]的执行结果
2016-11-30 12:11:15,983 testplan.py[line: 45] INFO: 获取测试用例信息 [{'is_open': '1', 'steps': [{'id': '101', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;code&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;:&quot;包含字符串&quot;,</p>\n<p>\n\t&quot;条件&quot;:[{&quot;模式&quot;:&quot;200&quot;,&quot;消息&quot;:&quot;把商品移出购物车中失败&quot;}]</p>\n<p>\n\t}</p>\n', 'actions': '<p>\n\t{<br />\n\t&quot;方法&quot;:&quot;get&quot;,<br />\n\t&quot;url&quot;:&quot;/cartlist?&quot;,<br />\n\t&quot;参数&quot;:{&quot;serial&quot;:&quot;[global_serial]&quot;,&quot;openId&quot;:&quot;[global_openId]&quot;}<br />\n\t}<br />\n\t&nbsp;</p>\n', 'step_number': '2', 'active': '1', 'execution_type': '1'}], 'id': '99', 'testsuite_id': '97', 'updater_id': '1', 'author_last_name': 'Administrator', 'active': '1', 'tc_external_id': '6', 'creation_ts': '2016-07-20 15:50:42', 'name': 'test-n-查看购物车商品列表', 'updater_login': 'admin', 'execution_type': '1', 'author_id': '1', 'importance': '2', 'modification_ts': '2016-11-29 18:13:45', 'preconditions': '', 'updater_last_name': 'Administrator', 'version': '1', 'node_order': '1000', 'author_login': 'admin', 'updater_first_name': 'Testlink', 'author_first_name': 'Testlink', 'layout': '1', 'full_tc_external_id': 'wecharno-6', 'summary': '', 'estimated_exec_duration': '', 'testcase_id': '98', 'status': '1'}]
2016-11-30 12:11:16,131 testplan.py[line: 69] INFO: 记录测试用例到测试用例报表
2016-11-30 12:11:16,131 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 98, 'test-n-查看购物车商品列表', '微商城-查看购物车商品列表接口', 'plan1_of_wechatno', 'pj_wechatno', 'Block', '')
2016-11-30 12:11:16,133 testplan.py[line: 72] INFO: 开始执行测试用例[id=98，name=test-n-查看购物车商品列表]
2016-11-30 12:11:16,133 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"方法":"get","url":"/cartlist?","参数":{"serial":"[global_serial]","openId":"[global_openId]"}} 
2016-11-30 12:11:16,133 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"code","匹配规则":"包含字符串","条件":[{"模式":"200","消息":"把商品移出购物车中失败"}]}
2016-11-30 12:11:16,133 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:16,133 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 98, 'test-n-查看购物车商品列表', 'plan1_of_wechatno', 'pj_wechatno', 101, 2, '', 'http', 'm.test.saofu.cn', 80, '{"方法":"get","url":"/cartlist?","参数":{"serial":"[global_serial]","openId":"[global_openId]"}} ', '{"检查":"code","匹配规则":"包含字符串","条件":[{"模式":"200","消息":"把商品移出购物车中失败"}]}', 'Block', '', '')
2016-11-30 12:11:16,135 testcase.py[line: 77] INFO: 开始执行步骤操作[第2步]
2016-11-30 12:11:16,135 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_urlencode
2016-11-30 12:11:16,135 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_openId]
2016-11-30 12:11:16,136 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_serial]
2016-11-30 12:11:16,136 casestep.py[line: 104] INFO: 转换后的参数体为：{'openId': 'ous64uFCCLMyXYDJ-MkNilyCI5CY', 'serial': '10549840601068216320'}
2016-11-30 12:11:16,136 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:11:16,136 InterfaceUnittestTestCase.py[line: 35] INFO: 正在发起GET请求...
2016-11-30 12:11:16,137 httpprotocol.py[line: 56] INFO: 发起的请求为：http://m.test.saofu.cn:80/cartlist?openId=ous64uFCCLMyXYDJ-MkNilyCI5CY&serial=10549840601068216320
2016-11-30 12:11:16,137 httpprotocol.py[line: 57] INFO: 请求头为：{'Cookie': '10549840601068216320=ous64uFCCLMyXYDJ-MkNilyCI5CY'}
2016-11-30 12:11:16,181 InterfaceUnittestTestCase.py[line: 40] INFO: 正在对服务器返回body进行解码
2016-11-30 12:11:16,181 InterfaceUnittestTestCase.py[line: 54] INFO: 服务器返回结果"响应体(body)": []
2016-11-30 12:11:16,181 InterfaceUnittestTestCase.py[line: 55] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:11:19 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('Vary', 'Accept-Encoding')]
2016-11-30 12:11:16,182 InterfaceUnittestTestCase.py[line: 56] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:11:16,182 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为：200
2016-11-30 12:11:16,182 unittesttestcase.py[line: 292] WARNING: 未检测到从服务器返回中提取内容的要求，请检查是否正确填写预期结果
2016-11-30 12:11:16,182 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:16,182 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="get", runtime="2016-11-30 12:11:16",step_action="{'方法': 'get', 'url': '/cartlist?', '参数': {'openId': 'ous64uFCCLMyXYDJ-MkNilyCI5CY', 'serial': '10549840601068216320'}}", expected_results="{'条件': [{'消息': '把商品移出购物车中失败', '模式': '200'}], '检查': 'code', '匹配规则': '包含字符串'}" WHERE executed_history_id = 20161130121106 AND testcase_id = 98 AND step_id = 101 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:16,185 testcase.py[line: 163] INFO: 测试用例[id=98, name=test-n-查看购物车商品列表]执行成功
2016-11-30 12:11:16,185 testplan.py[line: 76] INFO: 正在更新用例执行结果
2016-11-30 12:11:16,186 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 12:11:16" WHERE executed_history_id = 20161130121106 AND testcase_id = 98 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:16,318 testplan.py[line: 87] INFO: 正在更新testlink上测试计划[testplan_id=74, bulid_version=v1.0.0],对应用例[testcase_id=98]的执行结果
2016-11-30 12:11:16,557 testplan.py[line: 45] INFO: 获取测试用例信息 [{'is_open': '1', 'steps': [{'id': '122', 'expected_results': '<p>\n\t{&quot;success&quot;:1,&quot;output_arg1&quot;:&quot;CMOrder.attach&quot;}</p>\n', 'actions': '<p>\n\t{<br />\n\t&quot;class&quot;:&quot;CMOrder&quot;,<br />\n\t&quot;function&quot;:&quot;test_create_mall_order&quot;,<br />\n\t&quot;method&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/cmorder/1/4&quot;,<br />\n\t&quot;params&quot;:{&quot;serial&quot;:&quot;[global_serial]&quot;,&quot;openId&quot;:&quot;[global_openId]&quot;,&quot;fm&quot;:1,&quot;mallGoodsId&quot;:&quot;26838&quot;, &quot;amount&quot;:2,&quot;cartIds&quot;:&quot;&quot;,&quot;fetchTime&quot;:&quot;&quot;, &quot;remark&quot;:&quot;&quot;}<br />\n\t}</p>\n', 'step_number': '1', 'active': '1', 'execution_type': '1'}, {'id': '123', 'expected_results': '<p>\n\t{&quot;button_name&quot;:&quot;确认支付&quot;, &quot;page_title&quot;:&quot;储值卡&quot;}</p>\n', 'actions': '<p>\n\t{<br />\n\t&quot;class&quot;:&quot;Pay5&quot;,<br />\n\t&quot;function&quot;:&quot;test_pay5&quot;,<br />\n\t&quot;method&quot;:&quot;get&quot;,<br />\n\t&quot;url&quot;:&quot;/pay/5?&quot;,<br />\n\t&quot;params&quot;:{&quot;orderId&quot;:&quot;[CMOrder.attach]&quot;,&quot;serial&quot;:&quot;[global_serial]&quot;}<br />\n\t}</p>\n', 'step_number': '2', 'active': '1', 'execution_type': '1'}, {'id': '124', 'expected_results': '<p>\n\t{</p>\n<p>\n\t&quot;getByWeixin&quot;: 0, &quot;codeType&quot;: 2, &quot;title&quot;: &quot;动态校验&quot;, &quot;subTitle&quot;: &quot;动态校验&quot;, &quot;notice&quot;: &quot;动态校验&quot;, &quot;description&quot;: &quot;动态校验&quot;,&quot;useLimit&quot;:&quot;动态校验&quot;,&nbsp; &quot;dateInfoType&quot;: &quot;动态校验&quot;, &quot;cardType&quot;: 1,&quot;listing&quot;: 1, &quot;fitAll&quot;: 1,&quot;detailTxt&quot;: &quot;动态校验&quot;,&quot;servicePhone&quot;:&quot;动态校验&quot;,&quot;cashLeastCost&quot;: &quot;动态校验&quot;,&quot;cashReduceCost&quot;: &quot;动态校验&quot;,&quot;discount&quot;: 0,&quot;channel&quot;: -1,&quot;branchId&quot;: -1,&quot;success&quot;: 1, &quot;skuQuantity&quot;:&quot;动态校验&quot;,&quot;output_arg1&quot;:&quot;GetInCoupon.card_code&quot;</p>\n<p>\n\t}</p>\n', 'actions': '<p>\n\t{<br />\n\t&quot;class&quot;:&quot;GetInCoupon&quot;,<br />\n\t&quot;function&quot;:&quot;test_get_in_coupon&quot;,<br />\n\t&quot;method&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/kq/getincoupon/40758966216286146560/[global_openId]&quot;,<br />\n\t&quot;params&quot;:&quot;&quot;<br />\n\t}</p>\n', 'step_number': '3', 'active': '1', 'execution_type': '1'}, {'id': '129', 'expected_results': '<p>\n\t{&quot;success&quot;:1, &quot;receipt_fee&quot;:&quot;动态校验&quot;, &quot;balance&quot;:&quot;动态校验&quot;, &quot;bonus&quot;:&quot;动态校验&quot;, &quot;sum_amount_expend&quot;:&quot;动态校验&quot;,&nbsp; &quot;sum_bonus_expend&quot;:&quot;动态校验&quot;, &quot;balance_total&quot;:&quot;动态校验&quot;,&quot;coupon_weixin_verification_record&quot;:1}</p>\n', 'actions': '<p>\n\t{<br />\n\t&quot;class&quot;:&quot;CardPay&quot;,<br />\n\t&quot;function&quot;:&quot;test_account_pay_with_cash_discount&quot;,<br />\n\t&quot;method&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/pay/card/doconfirm&quot;,<br />\n\t&quot;params&quot;:{&quot;orderId&quot;:&quot;[var]&quot;, &quot;openId&quot;:&quot;[global_openId]&quot;, &quot;productOrderId&quot;:&quot;[CMOrder.attach]&quot;,&quot;customerId&quot;:&quot;[var]&quot;, &quot;type&quot;:1, &quot;cardId&quot;:&quot;&quot;,&quot;customerName&quot;:&quot;[var]&quot;, &quot;shopId&quot;:&quot;[var]&quot;, &quot;yhCardId&quot;:&quot;[GetInCoupon.card_code]&quot;,&quot;yhCardType&quot;:&quot;CASH&quot;}<br />\n\t}</p>\n', 'step_number': '4', 'active': '1', 'execution_type': '1'}], 'id': '121', 'testsuite_id': '109', 'updater_id': '1', 'author_last_name': 'Administrator', 'active': '0', 'tc_external_id': '11', 'creation_ts': '2016-07-26 12:12:10', 'name': 'test-n-储值卡支付-仅使用代金券优惠，会员账户支付', 'updater_login': 'admin', 'execution_type': '1', 'author_id': '1', 'importance': '2', 'modification_ts': '2016-07-29 18:31:36', 'preconditions': '', 'updater_last_name': 'Administrator', 'version': '1', 'node_order': '3', 'author_login': 'admin', 'updater_first_name': 'Testlink', 'author_first_name': 'Testlink', 'layout': '1', 'full_tc_external_id': 'wecharno-11', 'summary': '<p>\n\t消费不赠送积分,单规格商品</p>\n<p>\n\tulr中的40758966216286146560取自base_info.serial字段</p>\n', 'estimated_exec_duration': '', 'testcase_id': '120', 'status': '1'}]
2016-11-30 12:11:16,689 testplan.py[line: 69] INFO: 记录测试用例到测试用例报表
2016-11-30 12:11:16,690 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 120, 'test-n-储值卡支付-仅使用代金券优惠，会员账户支付', '微商城-储值卡支付接口', 'plan1_of_wechatno', 'pj_wechatno', 'Block', '')
2016-11-30 12:11:16,691 testplan.py[line: 72] INFO: 开始执行测试用例[id=120，name=test-n-储值卡支付-仅使用代金券优惠，会员账户支付]
2016-11-30 12:11:16,691 testcase.py[line: 27] WARNING: 用例[name=test-n-储值卡支付-仅使用代金券优惠，会员账户支付]处于禁用状态[active=0]，不执行
2016-11-30 12:11:16,691 testplan.py[line: 76] INFO: 正在更新用例执行结果
2016-11-30 12:11:16,691 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Block", runtime="2016-11-30 12:11:16" WHERE executed_history_id = 20161130121106 AND testcase_id = 120 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:16,816 testplan.py[line: 87] INFO: 正在更新testlink上测试计划[testplan_id=74, bulid_version=v1.0.0],对应用例[testcase_id=120]的执行结果
2016-11-30 12:11:16,943 testplan.py[line: 45] INFO: 获取测试用例信息 [{'is_open': '1', 'steps': [{'id': '175', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;customer_id&quot;:1}</p>\n<p>\n\t}</p>\n', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT id FROM customer WHERE channel_serial=%s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;(\\&quot;[global_openId]\\&quot;,)&quot;</p>\n<p>\n\t}</p>\n', 'step_number': '1', 'active': '1', 'execution_type': '1'}, {'id': '174', 'expected_results': '', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;更新&quot;:&quot;UPDATE mall_shopping_cart SET amount = 0 WHERE customer_id = %s and closed=1&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;([CaseStep.customer_id],)&quot;</p>\n<p>\n\t}</p>\n', 'step_number': '2', 'active': '1', 'execution_type': '1'}, {'id': '90', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;匹配规则&quot;:&quot;键值相等&quot;,<br />\n\t&quot;条件&quot;:[{&quot;模式&quot;:{&quot;success&quot;:true}, &quot;消息&quot;:&quot;把商品加如购物车失败，success不为true&quot;}]</p>\n<p>\n\t}</p>\n', 'actions': '<p>\n\t{<br />\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/addtocart&quot;,<br />\n\t&quot;参数&quot;:{&quot;mallGoodsId&quot;:26838,&quot;standardId&quot;:&quot;undefined&quot;,&quot;amount&quot;:1,&quot;serial&quot;:&quot;[global_serial]&quot;,&quot;openId&quot;:&quot;[global_openId]&quot;}<br />\n\t}</p>\n', 'step_number': '3', 'active': '1', 'execution_type': '1'}, {'id': '176', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;strIds&quot;:1}<br />\n\t}</p>\n', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT id FROM mall_shopping_cart WHERE customer_id = %s and closed=%s ORDER BY id DESC LIMIT 1&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;([CaseStep.customer_id],1)&quot;</p>\n<p>\n\t}</p>\n', 'step_number': '4', 'active': '1', 'execution_type': '1'}, {'id': '177', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;:&quot;包含字符串&quot;,</p>\n<p>\n\t&quot;条件&quot;:[{&quot;模式&quot;:&quot;\\&quot;amount\\&quot;:1&quot;,&quot;消息&quot;:&quot;购物车中商品总数错误&quot;}, {&quot;模式&quot;:&quot;\\&quot;id\\&quot;:26838&quot;,&quot;消息&quot;:&quot;购物车中商品缺失&quot;}]</p>\n<p>\n\t}</p>\n', 'actions': '<p>\n\t{<br />\n\t&quot;方法&quot;:&quot;get&quot;,<br />\n\t&quot;url&quot;:&quot;/cartlist?&quot;,<br />\n\t&quot;参数&quot;:{&quot;serial&quot;:&quot;[global_serial]&quot;,&quot;openId&quot;:&quot;[global_openId]&quot;}<br />\n\t}<br />\n\t&nbsp;</p>\n', 'step_number': '5', 'active': '1', 'execution_type': '1'}], 'id': '89', 'testsuite_id': '87', 'updater_id': '1', 'author_last_name': 'Administrator', 'active': '1', 'tc_external_id': '4', 'creation_ts': '2016-07-20 12:07:40', 'name': 'test-n-把商品加入购物车', 'updater_login': 'admin', 'execution_type': '1', 'author_id': '1', 'importance': '2', 'modification_ts': '2016-11-29 17:58:09', 'preconditions': '', 'updater_last_name': 'Administrator', 'version': '1', 'node_order': '1000', 'author_login': 'admin', 'updater_first_name': 'Testlink', 'author_first_name': 'Testlink', 'layout': '1', 'full_tc_external_id': 'wecharno-4', 'summary': '', 'estimated_exec_duration': '', 'testcase_id': '88', 'status': '1'}]
2016-11-30 12:11:17,103 testplan.py[line: 69] INFO: 记录测试用例到测试用例报表
2016-11-30 12:11:17,104 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 88, 'test-n-把商品加入购物车', '微商城-把商品加入购物车接口', 'plan1_of_wechatno', 'pj_wechatno', 'Block', '')
2016-11-30 12:11:17,106 testplan.py[line: 72] INFO: 开始执行测试用例[id=88，name=test-n-把商品加入购物车]
2016-11-30 12:11:17,106 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行sql","单条查询":"SELECT id FROM customer WHERE channel_serial=%s","参数":"(\"[global_openId]\",)"}
2016-11-30 12:11:17,106 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","输出":{"customer_id":1}}
2016-11-30 12:11:17,106 testcase.py[line: 55] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:17,106 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 88, 'test-n-把商品加入购物车', 'plan1_of_wechatno', 'pj_wechatno', 175, 1, '', '', '192.168.9.211', '3306', '{"步骤类型":"执行sql","单条查询":"SELECT id FROM customer WHERE channel_serial=%s","参数":"(\\"[global_openId]\\",)"}', '{"检查":"body","输出":{"customer_id":1}}', 'Block', '', '')
2016-11-30 12:11:17,108 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 12:11:17,108 casestep.py[line: 129] INFO: 找到待替换的全局动态参数：[global_openId]
2016-11-30 12:11:17,108 casestep.py[line: 138] INFO: 转换后的参数体为：("ous64uFCCLMyXYDJ-MkNilyCI5CY",)
2016-11-30 12:11:17,108 mydb.py[line: 84] INFO: query：SELECT id FROM customer WHERE channel_serial=%s  data：('ous64uFCCLMyXYDJ-MkNilyCI5CY',)
2016-11-30 12:11:17,112 casestep.py[line: 190] INFO: 数据库服务器返回的查询结果为为 query_result:(167020,), flag:True
2016-11-30 12:11:17,112 casestep.py[line: 192] INFO: 正在保存服务器返回结果到自定义变量
2016-11-30 12:11:17,113 casestep.py[line: 227] INFO: 提取的输出结果(key-value对)为:[{'branch_id': 1485916418}, {'device_no': '182590014248006'}, {'serial_no': 'HZ501FZA0F9M07D'}, {'customer_id': 167020}]
2016-11-30 12:11:17,113 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:17,113 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 12:11:17",step_action="{'参数': ('ous64uFCCLMyXYDJ-MkNilyCI5CY',), '步骤类型': '执行sql', '单条查询': 'SELECT id FROM customer WHERE channel_serial=%s'}", expected_results="{'检查': 'body', '输出': {'customer_id': 1}}" WHERE executed_history_id = 20161130121106 AND testcase_id = 88 AND step_id = 175 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:17,116 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行sql","更新":"UPDATE mall_shopping_cart SET amount = 0 WHERE customer_id = %s and closed=1","参数":"([CaseStep.customer_id],)"}
2016-11-30 12:11:17,116 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：
2016-11-30 12:11:17,116 testcase.py[line: 55] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:17,116 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 88, 'test-n-把商品加入购物车', 'plan1_of_wechatno', 'pj_wechatno', 174, 2, '', '', '192.168.9.211', '3306', '{"步骤类型":"执行sql","更新":"UPDATE mall_shopping_cart SET amount = 0 WHERE customer_id = %s and closed=1","参数":"([CaseStep.customer_id],)"}', '', 'Block', '', '')
2016-11-30 12:11:17,118 testcase.py[line: 77] INFO: 开始执行步骤操作[第2步]
2016-11-30 12:11:17,118 casestep.py[line: 115] INFO: 找到待替换的非全局动态参数：[CaseStep.customer_id]
2016-11-30 12:11:17,118 casestep.py[line: 138] INFO: 转换后的参数体为：(167020,)
2016-11-30 12:11:17,118 mydb.py[line: 70] INFO: query：UPDATE mall_shopping_cart SET amount = 0 WHERE customer_id = 167020 and closed=1
2016-11-30 12:11:17,122 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:17,122 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 12:11:17",step_action="{'参数': (167020,), '更新': 'UPDATE mall_shopping_cart SET amount = 0 WHERE customer_id = %s and closed=1', '步骤类型': '执行sql'}", expected_results="" WHERE executed_history_id = 20161130121106 AND testcase_id = 88 AND step_id = 174 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:17,125 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"方法":"post","url":"/addtocart","参数":{"mallGoodsId":26838,"standardId":"undefined","amount":1,"serial":"[global_serial]","openId":"[global_openId]"}}
2016-11-30 12:11:17,126 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"键值相等","条件":[{"模式":{"success":true}, "消息":"把商品加如购物车失败,success不为true"}]}
2016-11-30 12:11:17,126 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:17,126 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 88, 'test-n-把商品加入购物车', 'plan1_of_wechatno', 'pj_wechatno', 90, 3, '', 'http', 'm.test.saofu.cn', 80, '{"方法":"post","url":"/addtocart","参数":{"mallGoodsId":26838,"standardId":"undefined","amount":1,"serial":"[global_serial]","openId":"[global_openId]"}}', '{"检查":"body","匹配规则":"键值相等","条件":[{"模式":{"success":true}, "消息":"把商品加如购物车失败,success不为true"}]}', 'Block', '', '')
2016-11-30 12:11:17,129 testcase.py[line: 77] INFO: 开始执行步骤操作[第3步]
2016-11-30 12:11:17,129 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_urlencode
2016-11-30 12:11:17,129 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_openId]
2016-11-30 12:11:17,129 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_serial]
2016-11-30 12:11:17,129 casestep.py[line: 104] INFO: 转换后的参数体为：{'mallGoodsId': 26838, 'amount': 1, 'openId': 'ous64uFCCLMyXYDJ-MkNilyCI5CY', 'serial': '10549840601068216320', 'standardId': 'undefined'}
2016-11-30 12:11:17,129 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:11:17,130 InterfaceUnittestTestCase.py[line: 30] INFO: 正在发起POST请求...
2016-11-30 12:11:17,130 httpprotocol.py[line: 74] INFO: 发起的请求为：http://m.test.saofu.cn:80/addtocart
2016-11-30 12:11:17,130 httpprotocol.py[line: 75] INFO: 参数为：b'mallGoodsId=26838&amount=1&openId=ous64uFCCLMyXYDJ-MkNilyCI5CY&serial=10549840601068216320&standardId=undefined'
2016-11-30 12:11:17,130 httpprotocol.py[line: 76] INFO: 请求头为：{'Cookie': '10549840601068216320=ous64uFCCLMyXYDJ-MkNilyCI5CY'}
2016-11-30 12:11:17,791 InterfaceUnittestTestCase.py[line: 40] INFO: 正在对服务器返回body进行解码
2016-11-30 12:11:17,792 InterfaceUnittestTestCase.py[line: 54] INFO: 服务器返回结果"响应体(body)": {"success":true,"message":null,"attach":1}
2016-11-30 12:11:17,793 InterfaceUnittestTestCase.py[line: 55] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:11:21 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('Vary', 'Accept-Encoding')]
2016-11-30 12:11:17,793 InterfaceUnittestTestCase.py[line: 56] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:11:17,794 unittesttestcase.py[line: 106] INFO: 要匹配的字典key,value层级为：['success', True]
2016-11-30 12:11:17,794 unittesttestcase.py[line: 109] INFO: 找到的对应字典层级的最后值为：True
2016-11-30 12:11:17,795 unittesttestcase.py[line: 292] WARNING: 未检测到从服务器返回中提取内容的要求，请检查是否正确填写预期结果
2016-11-30 12:11:17,796 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:17,796 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="post", runtime="2016-11-30 12:11:17",step_action="{'方法': 'post', 'url': '/addtocart', '参数': {'mallGoodsId': 26838, 'amount': 1, 'openId': 'ous64uFCCLMyXYDJ-MkNilyCI5CY', 'serial': '10549840601068216320', 'standardId': 'undefined'}}", expected_results="{'条件': [{'消息': '把商品加如购物车失败,success不为true', '模式': {'success': True}}], '检查': 'body', '匹配规则': '键值相等'}" WHERE executed_history_id = 20161130121106 AND testcase_id = 88 AND step_id = 90 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:17,807 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行sql","单条查询":"SELECT id FROM mall_shopping_cart WHERE customer_id = %s and closed=%s ORDER BY id DESC LIMIT 1","参数":"([CaseStep.customer_id],1)"}
2016-11-30 12:11:17,807 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","输出":{"strIds":1}}
2016-11-30 12:11:17,808 testcase.py[line: 55] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:17,808 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 88, 'test-n-把商品加入购物车', 'plan1_of_wechatno', 'pj_wechatno', 176, 4, '', '', '192.168.9.211', '3306', '{"步骤类型":"执行sql","单条查询":"SELECT id FROM mall_shopping_cart WHERE customer_id = %s and closed=%s ORDER BY id DESC LIMIT 1","参数":"([CaseStep.customer_id],1)"}', '{"检查":"body","输出":{"strIds":1}}', 'Block', '', '')
2016-11-30 12:11:17,816 testcase.py[line: 77] INFO: 开始执行步骤操作[第4步]
2016-11-30 12:11:17,816 casestep.py[line: 115] INFO: 找到待替换的非全局动态参数：[CaseStep.customer_id]
2016-11-30 12:11:17,817 casestep.py[line: 138] INFO: 转换后的参数体为：(167020,1)
2016-11-30 12:11:17,817 mydb.py[line: 84] INFO: query：SELECT id FROM mall_shopping_cart WHERE customer_id = %s and closed=%s ORDER BY id DESC LIMIT 1  data：(167020, 1)
2016-11-30 12:11:17,821 casestep.py[line: 190] INFO: 数据库服务器返回的查询结果为为 query_result:(18631,), flag:True
2016-11-30 12:11:17,821 casestep.py[line: 192] INFO: 正在保存服务器返回结果到自定义变量
2016-11-30 12:11:17,821 casestep.py[line: 227] INFO: 提取的输出结果(key-value对)为:[{'branch_id': 1485916418}, {'device_no': '182590014248006'}, {'serial_no': 'HZ501FZA0F9M07D'}, {'customer_id': 167020}, {'strIds': 18631}]
2016-11-30 12:11:17,822 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:17,822 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 12:11:17",step_action="{'参数': (167020, 1), '步骤类型': '执行sql', '单条查询': 'SELECT id FROM mall_shopping_cart WHERE customer_id = %s and closed=%s ORDER BY id DESC LIMIT 1'}", expected_results="{'检查': 'body', '输出': {'strIds': 1}}" WHERE executed_history_id = 20161130121106 AND testcase_id = 88 AND step_id = 176 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:17,827 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"方法":"get","url":"/cartlist?","参数":{"serial":"[global_serial]","openId":"[global_openId]"}} 
2016-11-30 12:11:17,827 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"\"amount\":1","消息":"购物车中商品总数错误"}, {"模式":"\"id\":26838","消息":"购物车中商品缺失"}]}
2016-11-30 12:11:17,827 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:17,828 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 88, 'test-n-把商品加入购物车', 'plan1_of_wechatno', 'pj_wechatno', 177, 5, '', 'http', 'm.test.saofu.cn', 80, '{"方法":"get","url":"/cartlist?","参数":{"serial":"[global_serial]","openId":"[global_openId]"}} ', '{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"\\"amount\\":1","消息":"购物车中商品总数错误"}, {"模式":"\\"id\\":26838","消息":"购物车中商品缺失"}]}', 'Block', '', '')
2016-11-30 12:11:17,832 testcase.py[line: 77] INFO: 开始执行步骤操作[第5步]
2016-11-30 12:11:17,832 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_urlencode
2016-11-30 12:11:17,832 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_openId]
2016-11-30 12:11:17,832 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_serial]
2016-11-30 12:11:17,833 casestep.py[line: 104] INFO: 转换后的参数体为：{'openId': 'ous64uFCCLMyXYDJ-MkNilyCI5CY', 'serial': '10549840601068216320'}
2016-11-30 12:11:17,833 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:11:17,833 InterfaceUnittestTestCase.py[line: 35] INFO: 正在发起GET请求...
2016-11-30 12:11:17,834 httpprotocol.py[line: 56] INFO: 发起的请求为：http://m.test.saofu.cn:80/cartlist?openId=ous64uFCCLMyXYDJ-MkNilyCI5CY&serial=10549840601068216320
2016-11-30 12:11:17,834 httpprotocol.py[line: 57] INFO: 请求头为：{'Cookie': '10549840601068216320=ous64uFCCLMyXYDJ-MkNilyCI5CY'}
2016-11-30 12:11:17,892 InterfaceUnittestTestCase.py[line: 40] INFO: 正在对服务器返回body进行解码
2016-11-30 12:11:17,892 InterfaceUnittestTestCase.py[line: 54] INFO: 服务器返回结果"响应体(body)": [{"id":18631,"customer":null,"mallGoods":{"id":26838,"name":"接口-测试商品1","privateSerial":null,"price":1,"oriPrice":0,"description":"接口测试专用,烦请勿删,勿操作","iconUrl":"http://res.test.saofu.cn/saofu/upload/image/2016/07/18/352c9a44-5fe7-4546-9786-563d8700a773.jpg,","shop":null,"shopId":null,"mallGoodsCate":null,"servicePhone":null,"createTime":null,"expirTime":null,"cannotUseTime":null,"useTime":null,"preRemind":null,"rules":null,"detail":null,"status":1,"branch":null,"transientPrice":0.0,"transientOriPrice":0.0,"cateId":0,"cwId":null,"skuQuantity":null,"istop":0,"soldCount":0,"delFlag":null,"standard":1,"relType":null,"relBranchList":null,"mallGoodsStandards":null,"soldAllCount":0,"standardLowPrice":0.0,"standardTopPrice":0.0,"standardAllSku":null,"outerId":null,"rank":null,"mallGoodsCatagoryId":null,"business":null,"baiduSyncStatus":null,"meituanSyncStatus":null,"elemeSyncStatus":null,"dishCount":null,"lunchBoxCount":null,"isSku":0,"cateName":null,"waimaiChannel":null,"goodsCopyId":null,"syncStatus":0,"hasActivity":0,"orderNum":0,"mallGoodsMultistageStandards":null,"mallGoodsStandard":null,"theFirst":false,"theLast":false},"mallGoodsStandard":null,"amount":1,"shop":null,"shopBranchId":null,"closed":null,"cateringType":null}]
2016-11-30 12:11:17,892 InterfaceUnittestTestCase.py[line: 55] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:11:21 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('Vary', 'Accept-Encoding')]
2016-11-30 12:11:17,892 InterfaceUnittestTestCase.py[line: 56] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:11:17,892 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为："amount":1
2016-11-30 12:11:17,892 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为："id":26838
2016-11-30 12:11:17,893 unittesttestcase.py[line: 292] WARNING: 未检测到从服务器返回中提取内容的要求，请检查是否正确填写预期结果
2016-11-30 12:11:17,893 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:17,893 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="get", runtime="2016-11-30 12:11:17",step_action="{'方法': 'get', 'url': '/cartlist?', '参数': {'openId': 'ous64uFCCLMyXYDJ-MkNilyCI5CY', 'serial': '10549840601068216320'}}", expected_results="{'条件': [{'消息': '购物车中商品总数错误', '模式': ''amount':1'}, {'消息': '购物车中商品缺失', '模式': ''id':26838'}], '检查': 'body', '匹配规则': '包含字符串'}" WHERE executed_history_id = 20161130121106 AND testcase_id = 88 AND step_id = 177 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:17,896 testcase.py[line: 163] INFO: 测试用例[id=88, name=test-n-把商品加入购物车]执行成功
2016-11-30 12:11:17,896 testplan.py[line: 76] INFO: 正在更新用例执行结果
2016-11-30 12:11:17,896 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 12:11:17" WHERE executed_history_id = 20161130121106 AND testcase_id = 88 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:18,040 testplan.py[line: 87] INFO: 正在更新testlink上测试计划[testplan_id=74, bulid_version=v1.0.0],对应用例[testcase_id=88]的执行结果
2016-11-30 12:11:18,368 testplan.py[line: 45] INFO: 获取测试用例信息 [{'is_open': '1', 'steps': [{'id': '78', 'expected_results': '<p>\n\t｛&ldquo;检查&rdquo;:&ldquo;BODY&rdquo;，</p>\n<p>\n\t&ldquo;匹配规则&rdquo;：&ldquo;包含字符串&rdquo;，</p>\n<p>\n\t&ldquo;条件&rdquo;：【｛&ldquo;模式&rdquo;：&ldquo;\\&quot;currentPage\\&quot;:1&rdquo;，&ldquo;消息&rdquo;：&ldquo;接口返回错误&rdquo;｝，｛&ldquo;模式&rdquo;：&ldquo;\\&quot;pageStartRow\\&quot;:0&quot;，&ldquo;消息&rdquo;：&ldquo;接口返回错误&rdquo;｝】</p>\n<p>\n\t｝</p>\n', 'actions': '<p>\n\t{<br />\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/goods/plist&quot;,<br />\n\t&quot;参数&quot;:{&quot;page_size&quot;:&quot;10&quot;,&quot;page_no&quot;:&quot;1&quot;,&quot;cateIds&quot;:&quot;&quot;,&quot;orderBy&quot;:&quot;&quot;,&quot;serial&quot;:&quot;[global_serial]&quot;,&quot;name&quot;:&quot;&quot;}<br />\n\t}</p>\n', 'step_number': '1', 'active': '1', 'execution_type': '2'}], 'id': '77', 'testsuite_id': '75', 'updater_id': '1', 'author_last_name': 'Administrator', 'active': '1', 'tc_external_id': '1', 'creation_ts': '2016-07-18 15:52:00', 'name': 'test-n-显示默认页面', 'updater_login': 'admin', 'execution_type': '2', 'author_id': '1', 'importance': '2', 'modification_ts': '2016-11-29 18:17:12', 'preconditions': '', 'updater_last_name': 'Administrator', 'version': '1', 'node_order': '1000', 'author_login': 'admin', 'updater_first_name': 'Testlink', 'author_first_name': 'Testlink', 'layout': '1', 'full_tc_external_id': 'wecharno-1', 'summary': '', 'estimated_exec_duration': '', 'testcase_id': '76', 'status': '1'}]
2016-11-30 12:11:18,481 testplan.py[line: 69] INFO: 记录测试用例到测试用例报表
2016-11-30 12:11:18,481 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 76, 'test-n-显示默认页面', '微商城-显示商品列表接口', 'plan1_of_wechatno', 'pj_wechatno', 'Block', '')
2016-11-30 12:11:18,483 testplan.py[line: 72] INFO: 开始执行测试用例[id=76，name=test-n-显示默认页面]
2016-11-30 12:11:18,483 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"方法":"post","url":"/goods/plist","参数":{"page_size":"10","page_no":"1","cateIds":"","orderBy":"","serial":"[global_serial]","name":""}}
2016-11-30 12:11:18,483 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"BODY","匹配规则":"包含字符串","条件":[{"模式":"\"currentPage\":1","消息":"接口返回错误"},{"模式":"\"pageStartRow\":0","消息":"接口返回错误"}]}
2016-11-30 12:11:18,483 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:18,483 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 76, 'test-n-显示默认页面', 'plan1_of_wechatno', 'pj_wechatno', 78, 1, '', 'http', 'm.test.saofu.cn', 80, '{"方法":"post","url":"/goods/plist","参数":{"page_size":"10","page_no":"1","cateIds":"","orderBy":"","serial":"[global_serial]","name":""}}', '{"检查":"BODY","匹配规则":"包含字符串","条件":[{"模式":"\\"currentPage\\":1","消息":"接口返回错误"},{"模式":"\\"pageStartRow\\":0","消息":"接口返回错误"}]}', 'Block', '', '')
2016-11-30 12:11:18,485 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 12:11:18,485 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_urlencode
2016-11-30 12:11:18,485 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_serial]
2016-11-30 12:11:18,485 casestep.py[line: 104] INFO: 转换后的参数体为：{'cateIds': '', 'name': '', 'page_size': '10', 'orderBy': '', 'page_no': '1', 'serial': '10549840601068216320'}
2016-11-30 12:11:18,485 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:11:18,485 InterfaceUnittestTestCase.py[line: 30] INFO: 正在发起POST请求...
2016-11-30 12:11:18,486 httpprotocol.py[line: 74] INFO: 发起的请求为：http://m.test.saofu.cn:80/goods/plist
2016-11-30 12:11:18,486 httpprotocol.py[line: 75] INFO: 参数为：b'cateIds=&name=&page_size=10&orderBy=&page_no=1&serial=10549840601068216320'
2016-11-30 12:11:18,486 httpprotocol.py[line: 76] INFO: 请求头为：{'Cookie': '10549840601068216320=ous64uFCCLMyXYDJ-MkNilyCI5CY'}
2016-11-30 12:11:19,375 InterfaceUnittestTestCase.py[line: 40] INFO: 正在对服务器返回body进行解码
2016-11-30 12:11:19,375 InterfaceUnittestTestCase.py[line: 54] INFO: 服务器返回结果"响应体(body)": {"dataList":[{"id":27066,"name":"多，1,1","privateSerial":null,"price":0,"oriPrice":0,"description":"123","iconUrl":"http://res.test.saofu.cn/saofu/upload/image/2016/11/25/870d7765-ac84-4b6a-bd86-0108cbe11fbc.jpg","shop":{"id":42,"serial":null,"parent":null,"phoneNumber":null,"email":null,"fullName":null,"name":null,"logoUrl":null,"printAdUrl":null,"printAdText":null,"createTime":null,"shopType":null,"sblist":null,"idlist":null,"shopAccount":null,"subShops":null,"account":null,"shopRole":null,"suffixShop":null,"thirdAppId":null},"shopId":null,"mallGoodsCate":{"id":302,"name":null,"delFlag":null,"shop":null,"orderNum":null,"branchId":null,"goodsAmount":0,"oldName":null,"goodsSoldOutAmount":0,"theFirst":false,"theLast":false},"servicePhone":null,"createTime":null,"expirTime":null,"cannotUseTime":null,"useTime":null,"preRemind":null,"rules":null,"detail":null,"status":1,"branch":null,"transientPrice":0.0,"transientOriPrice":0.0,"cateId":0,"cwId":null,"skuQuantity":null,"istop":0,"soldCount":0,"delFlag":null,"standard":2,"relType":null,"relBranchList":null,"mallGoodsStandards":null,"soldAllCount":1,"standardLowPrice":100.0,"standardTopPrice":0.0,"standardAllSku":null,"outerId":null,"rank":null,"mallGoodsCatagoryId":null,"business":null,"baiduSyncStatus":null,"meituanSyncStatus":null,"elemeSyncStatus":null,"dishCount":null,"lunchBoxCount":null,"isSku":0,"cateName":null,"waimaiChannel":null,"goodsCopyId":null,"syncStatus":0,"hasActivity":0,"orderNum":0,"mallGoodsMultistageStandards":null,"mallGoodsStandard":null,"theFirst":false,"theLast":false},{"id":26942,"name":"lin测试","privateSerial":null,"price":0,"oriPrice":0,"description":"lin测试","iconUrl":"http://res.test.saofu.cn/saofu/upload/file/2016/10/31/54a9e36a-d950-4e0d-ba50-bf1e1c4bd347.png","shop":{"id":42,"serial":null,"parent":null,"phoneNumber":null,"email":null,"fullName":null,"name":null,"logoUrl":null,"printAdUrl":null,"printAdText":null,"createTime":null,"shopType":null,"sblist":null,"idlist":null,"shopAccount":null,"subShops":null,"account":null,"shopRole":null,"suffixShop":null,"thirdAppId":null},"shopId":null,"mallGoodsCate":{"id":278,"name":null,"delFlag":null,"shop":null,"orderNum":null,"branchId":null,"goodsAmount":0,"oldName":null,"goodsSoldOutAmount":0,"theFirst":false,"theLast":false},"servicePhone":null,"createTime":null,"expirTime":null,"cannotUseTime":null,"useTime":null,"preRemind":null,"rules":null,"detail":null,"status":1,"branch":null,"transientPrice":0.0,"transientOriPrice":0.0,"cateId":0,"cwId":null,"skuQuantity":null,"istop":0,"soldCount":0,"delFlag":null,"standard":2,"relType":null,"relBranchList":null,"mallGoodsStandards":null,"soldAllCount":0,"standardLowPrice":100.0,"standardTopPrice":0.0,"standardAllSku":null,"outerId":null,"rank":null,"mallGoodsCatagoryId":null,"business":null,"baiduSyncStatus":null,"meituanSyncStatus":null,"elemeSyncStatus":null,"dishCount":null,"lunchBoxCount":null,"isSku":0,"cateName":null,"waimaiChannel":null,"goodsCopyId":null,"syncStatus":0,"hasActivity":0,"orderNum":0,"mallGoodsMultistageStandards":null,"mallGoodsStandard":null,"theFirst":false,"theLast":false},{"id":27065,"name":"ceshi","privateSerial":null,"price":100,"oriPrice":0,"description":"23414","iconUrl":"http://res.test.saofu.cn/saofu/upload/image/2016/11/25/a6eca60b-84d1-45b8-aa75-981e63870e19.jpg","shop":{"id":42,"serial":null,"parent":null,"phoneNumber":null,"email":null,"fullName":null,"name":null,"logoUrl":null,"printAdUrl":null,"printAdText":null,"createTime":null,"shopType":null,"sblist":null,"idlist":null,"shopAccount":null,"subShops":null,"account":null,"shopRole":null,"suffixShop":null,"thirdAppId":null},"shopId":null,"mallGoodsCate":{"id":278,"name":null,"delFlag":null,"shop":null,"orderNum":null,"branchId":null,"goodsAmount":0,"oldName":null,"goodsSoldOutAmount":0,"theFirst":false,"theLast":false},"servicePhone":null,"createTime":null,"expirTime":null,"cannotUseTime":null,"useTime":null,"preRemind":null,"rules":null,"detail":null,"status":1,"branch":null,"transientPrice":0.0,"transientOriPrice":0.0,"cateId":0,"cwId":null,"skuQuantity":129,"istop":0,"soldCount":3,"delFlag":null,"standard":1,"relType":null,"relBranchList":null,"mallGoodsStandards":null,"soldAllCount":3,"standardLowPrice":0.0,"standardTopPrice":0.0,"standardAllSku":null,"outerId":null,"rank":null,"mallGoodsCatagoryId":null,"business":null,"baiduSyncStatus":null,"meituanSyncStatus":null,"elemeSyncStatus":null,"dishCount":null,"lunchBoxCount":null,"isSku":0,"cateName":null,"waimaiChannel":null,"goodsCopyId":null,"syncStatus":0,"hasActivity":0,"orderNum":0,"mallGoodsMultistageStandards":null,"mallGoodsStandard":null,"theFirst":false,"theLast":false},{"id":27064,"name":"一级规格","privateSerial":null,"price":100,"oriPrice":0,"description":"为二位","iconUrl":"http://res.test.saofu.cn/saofu/upload/image/2016/11/25/029c689e-0ece-4fe7-991f-494554e1170b.jpg","shop":{"id":42,"serial":null,"parent":null,"phoneNumber":null,"email":null,"fullName":null,"name":null,"logoUrl":null,"printAdUrl":null,"printAdText":null,"createTime":null,"shopType":null,"sblist":null,"idlist":null,"shopAccount":null,"subShops":null,"account":null,"shopRole":null,"suffixShop":null,"thirdAppId":null},"shopId":null,"mallGoodsCate":{"id":301,"name":null,"delFlag":null,"shop":null,"orderNum":null,"branchId":null,"goodsAmount":0,"oldName":null,"goodsSoldOutAmount":0,"theFirst":false,"theLast":false},"servicePhone":null,"createTime":null,"expirTime":null,"cannotUseTime":null,"useTime":null,"preRemind":null,"rules":null,"detail":null,"status":1,"branch":null,"transientPrice":0.0,"transientOriPrice":0.0,"cateId":0,"cwId":null,"skuQuantity":10,"istop":0,"soldCount":2,"delFlag":null,"standard":1,"relType":null,"relBranchList":null,"mallGoodsStandards":null,"soldAllCount":4,"standardLowPrice":0.0,"standardTopPrice":0.0,"standardAllSku":null,"outerId":null,"rank":null,"mallGoodsCatagoryId":null,"business":null,"baiduSyncStatus":null,"meituanSyncStatus":null,"elemeSyncStatus":null,"dishCount":null,"lunchBoxCount":null,"isSku":0,"cateName":null,"waimaiChannel":null,"goodsCopyId":null,"syncStatus":0,"hasActivity":0,"orderNum":0,"mallGoodsMultistageStandards":null,"mallGoodsStandard":null,"theFirst":false,"theLast":false},{"id":27063,"name":"试下系统异常","privateSerial":null,"price":1200,"oriPrice":0,"description":"sdfsa","iconUrl":"http://res.test.saofu.cn/saofu/upload/image/2016/11/24/1c2a40e9-b541-48fe-baba-cbd0c726fe23.jpg","shop":{"id":42,"serial":null,"parent":null,"phoneNumber":null,"email":null,"fullName":null,"name":null,"logoUrl":null,"printAdUrl":null,"printAdText":null,"createTime":null,"shopType":null,"sblist":null,"idlist":null,"shopAccount":null,"subShops":null,"account":null,"shopRole":null,"suffixShop":null,"thirdAppId":null},"shopId":null,"mallGoodsCate":{"id":301,"name":null,"delFlag":null,"shop":null,"orderNum":null,"branchId":null,"goodsAmount":0,"oldName":null,"goodsSoldOutAmount":0,"theFirst":false,"theLast":false},"servicePhone":null,"createTime":null,"expirTime":null,"cannotUseTime":null,"useTime":null,"preRemind":null,"rules":null,"detail":null,"status":1,"branch":null,"transientPrice":0.0,"transientOriPrice":0.0,"cateId":0,"cwId":null,"skuQuantity":6,"istop":0,"soldCount":6,"delFlag":null,"standard":1,"relType":null,"relBranchList":null,"mallGoodsStandards":null,"soldAllCount":6,"standardLowPrice":0.0,"standardTopPrice":0.0,"standardAllSku":null,"outerId":null,"rank":null,"mallGoodsCatagoryId":null,"business":null,"baiduSyncStatus":null,"meituanSyncStatus":null,"elemeSyncStatus":null,"dishCount":null,"lunchBoxCount":null,"isSku":0,"cateName":null,"waimaiChannel":null,"goodsCopyId":null,"syncStatus":0,"hasActivity":0,"orderNum":0,"mallGoodsMultistageStandards":null,"mallGoodsStandard":null,"theFirst":false,"theLast":false},{"id":27056,"name":"背心1","privateSerial":null,"price":0,"oriPrice":0,"description":"1","iconUrl":"http://res.test.saofu.cn/saofu/upload/file/2016/11/23/202647db-56de-43dc-bed7-484ea86e8160.png","shop":{"id":42,"serial":null,"parent":null,"phoneNumber":null,"email":null,"fullName":null,"name":null,"logoUrl":null,"printAdUrl":null,"printAdText":null,"createTime":null,"shopType":null,"sblist":null,"idlist":null,"shopAccount":null,"subShops":null,"account":null,"shopRole":null,"suffixShop":null,"thirdAppId":null},"shopId":null,"mallGoodsCate":{"id":297,"name":null,"delFlag":null,"shop":null,"orderNum":null,"branchId":null,"goodsAmount":0,"oldName":null,"goodsSoldOutAmount":0,"theFirst":false,"theLast":false},"servicePhone":null,"createTime":null,"expirTime":null,"cannotUseTime":null,"useTime":null,"preRemind":null,"rules":null,"detail":null,"status":1,"branch":null,"transientPrice":0.0,"transientOriPrice":0.0,"cateId":0,"cwId":null,"skuQuantity":null,"istop":0,"soldCount":0,"delFlag":null,"standard":2,"relType":null,"relBranchList":null,"mallGoodsStandards":null,"soldAllCount":67,"standardLowPrice":20.0,"standardTopPrice":0.0,"standardAllSku":null,"outerId":null,"rank":null,"mallGoodsCatagoryId":null,"business":null,"baiduSyncStatus":null,"meituanSyncStatus":null,"elemeSyncStatus":null,"dishCount":null,"lunchBoxCount":null,"isSku":0,"cateName":null,"waimaiChannel":null,"goodsCopyId":null,"syncStatus":0,"hasActivity":0,"orderNum":0,"mallGoodsMultistageStandards":null,"mallGoodsStandard":null,"theFirst":false,"theLast":false},{"id":27059,"name":"0A","privateSerial":null,"price":0,"oriPrice":0,"description":"1","iconUrl":"http://res.test.saofu.cn/saofu/upload/file/2016/11/23/2d4d68bf-5060-4e6e-b97c-27c0c013149d.png","shop":{"id":42,"serial":null,"parent":null,"phoneNumber":null,"email":null,"fullName":null,"name":null,"logoUrl":null,"printAdUrl":null,"printAdText":null,"createTime":null,"shopType":null,"sblist":null,"idlist":null,"shopAccount":null,"subShops":null,"account":null,"shopRole":null,"suffixShop":null,"thirdAppId":null},"shopId":null,"mallGoodsCate":{"id":297,"name":null,"delFlag":null,"shop":null,"orderNum":null,"branchId":null,"goodsAmount":0,"oldName":null,"goodsSoldOutAmount":0,"theFirst":false,"theLast":false},"servicePhone":null,"createTime":null,"expirTime":null,"cannotUseTime":null,"useTime":null,"preRemind":null,"rules":null,"detail":null,"status":1,"branch":null,"transientPrice":0.0,"transientOriPrice":0.0,"cateId":0,"cwId":null,"skuQuantity":null,"istop":0,"soldCount":0,"delFlag":null,"standard":2,"relType":null,"relBranchList":null,"mallGoodsStandards":null,"soldAllCount":41,"standardLowPrice":20.0,"standardTopPrice":0.0,"standardAllSku":null,"outerId":null,"rank":null,"mallGoodsCatagoryId":null,"business":null,"baiduSyncStatus":null,"meituanSyncStatus":null,"elemeSyncStatus":null,"dishCount":null,"lunchBoxCount":null,"isSku":0,"cateName":null,"waimaiChannel":null,"goodsCopyId":null,"syncStatus":0,"hasActivity":0,"orderNum":0,"mallGoodsMultistageStandards":null,"mallGoodsStandard":null,"theFirst":false,"theLast":false},{"id":27057,"name":"裙子","privateSerial":null,"price":0,"oriPrice":0,"description":"1","iconUrl":"http://res.test.saofu.cn/saofu/upload/image/2016/11/23/13dbced7-faae-4e13-aebe-6f69d72dc7e0.jpg","shop":{"id":42,"serial":null,"parent":null,"phoneNumber":null,"email":null,"fullName":null,"name":null,"logoUrl":null,"printAdUrl":null,"printAdText":null,"createTime":null,"shopType":null,"sblist":null,"idlist":null,"shopAccount":null,"subShops":null,"account":null,"shopRole":null,"suffixShop":null,"thirdAppId":null},"shopId":null,"mallGoodsCate":{"id":297,"name":null,"delFlag":null,"shop":null,"orderNum":null,"branchId":null,"goodsAmount":0,"oldName":null,"goodsSoldOutAmount":0,"theFirst":false,"theLast":false},"servicePhone":null,"createTime":null,"expirTime":null,"cannotUseTime":null,"useTime":null,"preRemind":null,"rules":null,"detail":null,"status":1,"branch":null,"transientPrice":0.0,"transientOriPrice":0.0,"cateId":0,"cwId":null,"skuQuantity":null,"istop":0,"soldCount":0,"delFlag":null,"standard":2,"relType":null,"relBranchList":null,"mallGoodsStandards":null,"soldAllCount":88,"standardLowPrice":1.0,"standardTopPrice":0.0,"standardAllSku":null,"outerId":null,"rank":null,"mallGoodsCatagoryId":null,"business":null,"baiduSyncStatus":null,"meituanSyncStatus":null,"elemeSyncStatus":null,"dishCount":null,"lunchBoxCount":null,"isSku":0,"cateName":null,"waimaiChannel":null,"goodsCopyId":null,"syncStatus":0,"hasActivity":0,"orderNum":0,"mallGoodsMultistageStandards":null,"mallGoodsStandard":null,"theFirst":false,"theLast":false},{"id":27055,"name":"一级1123","privateSerial":null,"price":0,"oriPrice":0,"description":"阿萨德飞洒","iconUrl":"http://res.test.saofu.cn/saofu/upload/image/2016/11/23/5692de28-aa07-45e2-b3a7-5ef0b39c359b.jpg","shop":{"id":42,"serial":null,"parent":null,"phoneNumber":null,"email":null,"fullName":null,"name":null,"logoUrl":null,"printAdUrl":null,"printAdText":null,"createTime":null,"shopType":null,"sblist":null,"idlist":null,"shopAccount":null,"subShops":null,"account":null,"shopRole":null,"suffixShop":null,"thirdAppId":null},"shopId":null,"mallGoodsCate":{"id":301,"name":null,"delFlag":null,"shop":null,"orderNum":null,"branchId":null,"goodsAmount":0,"oldName":null,"goodsSoldOutAmount":0,"theFirst":false,"theLast":false},"servicePhone":null,"createTime":null,"expirTime":null,"cannotUseTime":null,"useTime":null,"preRemind":null,"rules":null,"detail":null,"status":1,"branch":null,"transientPrice":0.0,"transientOriPrice":0.0,"cateId":0,"cwId":null,"skuQuantity":null,"istop":0,"soldCount":0,"delFlag":null,"standard":2,"relType":null,"relBranchList":null,"mallGoodsStandards":null,"soldAllCount":3,"standardLowPrice":1.0,"standardTopPrice":0.0,"standardAllSku":null,"outerId":null,"rank":null,"mallGoodsCatagoryId":null,"business":null,"baiduSyncStatus":null,"meituanSyncStatus":null,"elemeSyncStatus":null,"dishCount":null,"lunchBoxCount":null,"isSku":0,"cateName":null,"waimaiChannel":null,"goodsCopyId":null,"syncStatus":0,"hasActivity":0,"orderNum":0,"mallGoodsMultistageStandards":null,"mallGoodsStandard":null,"theFirst":false,"theLast":false},{"id":26983,"name":"衬衫","privateSerial":null,"price":0,"oriPrice":0,"description":"11111","iconUrl":"http://res.test.saofu.cn/saofu/upload/image/2016/11/25/e12cbd4b-56c5-4fcc-9c49-6b6bd829745b.jpg","shop":{"id":42,"serial":null,"parent":null,"phoneNumber":null,"email":null,"fullName":null,"name":null,"logoUrl":null,"printAdUrl":null,"printAdText":null,"createTime":null,"shopType":null,"sblist":null,"idlist":null,"shopAccount":null,"subShops":null,"account":null,"shopRole":null,"suffixShop":null,"thirdAppId":null},"shopId":null,"mallGoodsCate":{"id":297,"name":null,"delFlag":null,"shop":null,"orderNum":null,"branchId":null,"goodsAmount":0,"oldName":null,"goodsSoldOutAmount":0,"theFirst":false,"theLast":false},"servicePhone":null,"createTime":null,"expirTime":null,"cannotUseTime":null,"useTime":null,"preRemind":null,"rules":null,"detail":null,"status":1,"branch":null,"transientPrice":0.0,"transientOriPrice":0.0,"cateId":0,"cwId":null,"skuQuantity":null,"istop":0,"soldCount":0,"delFlag":null,"standard":2,"relType":null,"relBranchList":null,"mallGoodsStandards":null,"soldAllCount":76,"standardLowPrice":100.0,"standardTopPrice":0.0,"standardAllSku":null,"outerId":null,"rank":null,"mallGoodsCatagoryId":null,"business":null,"baiduSyncStatus":null,"meituanSyncStatus":null,"elemeSyncStatus":null,"dishCount":null,"lunchBoxCount":null,"isSku":0,"cateName":null,"waimaiChannel":null,"goodsCopyId":null,"syncStatus":0,"hasActivity":0,"orderNum":0,"mallGoodsMultistageStandards":null,"mallGoodsStandard":null,"theFirst":false,"theLast":false}],"pageInfo":{"pageSize":10,"currentPage":1,"totalPages":6,"totalRows":60,"pageStartRow":0,"pageEndRow":10,"pagination":true,"hasNextPage":true,"hasPreviousPage":false,"params":null,"needCount":true}}
2016-11-30 12:11:19,380 InterfaceUnittestTestCase.py[line: 55] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:11:22 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('Vary', 'Accept-Encoding')]
2016-11-30 12:11:19,380 InterfaceUnittestTestCase.py[line: 56] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:11:19,380 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为："currentPage":1
2016-11-30 12:11:19,381 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为："pageStartRow":0
2016-11-30 12:11:19,381 unittesttestcase.py[line: 292] WARNING: 未检测到从服务器返回中提取内容的要求，请检查是否正确填写预期结果
2016-11-30 12:11:19,381 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:19,381 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="post", runtime="2016-11-30 12:11:18",step_action="{'方法': 'post', 'url': '/goods/plist', '参数': {'cateIds': '', 'name': '', 'page_size': '10', 'orderBy': '', 'page_no': '1', 'serial': '10549840601068216320'}}", expected_results="{'条件': [{'消息': '接口返回错误', '模式': ''currentPage':1'}, {'消息': '接口返回错误', '模式': ''pageStartRow':0'}], '检查': 'BODY', '匹配规则': '包含字符串'}" WHERE executed_history_id = 20161130121106 AND testcase_id = 76 AND step_id = 78 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:19,384 testcase.py[line: 163] INFO: 测试用例[id=76, name=test-n-显示默认页面]执行成功
2016-11-30 12:11:19,385 testplan.py[line: 76] INFO: 正在更新用例执行结果
2016-11-30 12:11:19,385 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 12:11:18" WHERE executed_history_id = 20161130121106 AND testcase_id = 76 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:19,514 testplan.py[line: 87] INFO: 正在更新testlink上测试计划[testplan_id=74, bulid_version=v1.0.0],对应用例[testcase_id=76]的执行结果
2016-11-30 12:11:19,762 testplan.py[line: 45] INFO: 获取测试用例信息 [{'is_open': '1', 'steps': [{'id': '116', 'expected_results': '', 'actions': '<p>\n\t{<br />\n\t&quot;步骤类型&quot;:&quot;执行用例&quot;,<br />\n\t<br />\n\t&quot;用例id&quot;:106,<br />\n\t<br />\n\t&quot;用例名称&quot;:&quot;test-n-创建储值卡支付订单&quot;<br />\n\t}</p>\n', 'step_number': '1', 'active': '1', 'execution_type': '1'}, {'id': '117', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;匹配规则&quot;:&quot;包含字符串&quot;,<br />\n\t&quot;条件&quot;:[{&quot;模式&quot;:&quot;确认支付&quot;, &quot;消息&quot;:&quot;提交储值卡支付订单-pay5重定向失败，没确认支付按钮&quot;},</p>\n<p>\n\t{&quot;模式&quot;:&quot;储值卡&quot;, &quot;消息&quot;:&quot;提交储值卡支付订单-pay5重定向失败，没打开页面&quot;}]</p>\n<p>\n\t}</p>\n', 'actions': '<p>\n\t{<br />\n\t&quot;方法&quot;:&quot;get&quot;,<br />\n\t&quot;url&quot;:&quot;/pay/5?&quot;,<br />\n\t&quot;参数&quot;:{&quot;orderId&quot;:&quot;[attach_1]&quot;,&quot;serial&quot;:&quot;[global_serial]&quot;}<br />\n\t}</p>\n', 'step_number': '2', 'active': '1', 'execution_type': '1'}], 'id': '115', 'testsuite_id': '113', 'updater_id': '1', 'author_last_name': 'Administrator', 'active': '1', 'tc_external_id': '10', 'creation_ts': '2016-07-25 15:02:41', 'name': 'test-n-提交储值卡支付订单-pay5重定向', 'updater_login': 'admin', 'execution_type': '1', 'author_id': '1', 'importance': '2', 'modification_ts': '2016-11-29 17:52:17', 'preconditions': '', 'updater_last_name': 'Administrator', 'version': '1', 'node_order': '1000', 'author_login': 'admin', 'updater_first_name': 'Testlink', 'author_first_name': 'Testlink', 'layout': '1', 'full_tc_external_id': 'wecharno-10', 'summary': '', 'estimated_exec_duration': '', 'testcase_id': '114', 'status': '1'}]
2016-11-30 12:11:19,880 testplan.py[line: 69] INFO: 记录测试用例到测试用例报表
2016-11-30 12:11:19,880 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 114, 'test-n-提交储值卡支付订单-pay5重定向', '微商城-提交储值卡支付订单接口', 'plan1_of_wechatno', 'pj_wechatno', 'Block', '')
2016-11-30 12:11:19,883 testplan.py[line: 72] INFO: 开始执行测试用例[id=114，name=test-n-提交储值卡支付订单-pay5重定向]
2016-11-30 12:11:19,883 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行用例","用例id":106,"用例名称":"test-n-创建储值卡支付订单"}
2016-11-30 12:11:19,883 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：
2016-11-30 12:11:19,883 testcase.py[line: 50] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:19,883 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 114, 'test-n-提交储值卡支付订单-pay5重定向', 'plan1_of_wechatno', 'pj_wechatno', 116, 1, '无', '无', '无', '无', '{"步骤类型":"执行用例","用例id":106,"用例名称":"test-n-创建储值卡支付订单"}', '', 'Block', '', '')
2016-11-30 12:11:19,885 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 12:11:20,028 global_function.py[line: 23] INFO: 获取测试用例信息 [{'is_open': '1', 'steps': [{'id': '108', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;匹配规则&quot;:&quot;包含字符串&quot;,<br />\n\t&quot;条件&quot;:[{&quot;模式&quot;:&quot;\\&quot;success\\&quot;:true&quot;, &quot;消息&quot;:&quot;创建储值卡支付订单失败，success不为True&quot;}],</p>\n<p>\n\t&quot;输出&quot;:{&quot;success&quot;: &quot;\\&quot;success\\&quot;:(.+?),&quot;,&quot;attach&quot;:&quot;attach\\&quot;:\\&quot;(.+?)\\&quot;&quot;}<br />\n\t}</p>\n', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;请求头&quot;：{&quot;Content-Type&quot;:&quot;application/x-www-form-urlencoded&quot;,&quot;charset&quot;:&quot;utf-8&quot;},<br />\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/cmorder/1/4&quot;,<br />\n\t&quot;参数&quot;:{&quot;serial&quot;:&quot;[global_serial]&quot;,&quot;openId&quot;:&quot;[global_openId]&quot;,&quot;fm&quot;:1,&quot;mallGoodsId&quot;:&quot;26838&quot;, &quot;amount&quot;:1,&quot;cartIds&quot;:&quot;&quot;,&quot;fetchTime&quot;:&quot;&quot;, &quot;remark&quot;:&quot;&quot;}<br />\n\t}</p>\n', 'step_number': '1', 'active': '1', 'execution_type': '1'}], 'id': '107', 'testsuite_id': '105', 'updater_id': '1', 'author_last_name': 'Administrator', 'active': '1', 'tc_external_id': '8', 'creation_ts': '2016-07-21 11:26:32', 'name': 'test-n-创建储值卡支付订单', 'updater_login': 'admin', 'execution_type': '1', 'author_id': '1', 'importance': '2', 'modification_ts': '2016-11-29 17:33:09', 'preconditions': '', 'updater_last_name': 'Administrator', 'version': '1', 'node_order': '1000', 'author_login': 'admin', 'updater_first_name': 'Testlink', 'author_first_name': 'Testlink', 'layout': '1', 'full_tc_external_id': 'wecharno-8', 'summary': '', 'estimated_exec_duration': '', 'testcase_id': '106', 'status': '1'}]
2016-11-30 12:11:20,175 global_function.py[line: 43] INFO: 正在读取套件[id=105]的协议，host，端口配置...
2016-11-30 12:11:20,446 global_function.py[line: 72] INFO: 记录测试用例到测试用例报表
2016-11-30 12:11:20,447 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 106, 'test-n-创建储值卡支付订单', '创建储值卡支付订单接口', 'plan1_of_wechatno', 'pj_wechatno', 'Block', '')
2016-11-30 12:11:20,448 global_function.py[line: 75] INFO: 开始执行测试用例[id=106，name=test-n-创建储值卡支付订单]
2016-11-30 12:11:20,448 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"请求头":{"Content-Type":"application/x-www-form-urlencoded","charset":"utf-8"},"方法":"post","url":"/cmorder/1/4","参数":{"serial":"[global_serial]","openId":"[global_openId]","fm":1,"mallGoodsId":"26838", "amount":1,"cartIds":"","fetchTime":"", "remark":""}}
2016-11-30 12:11:20,448 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"\"success\":true", "消息":"创建储值卡支付订单失败,success不为True"}],"输出":{"success": "\"success\":(.+?),","attach":"attach\":\"(.+?)\""}}
2016-11-30 12:11:20,448 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:20,448 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 106, 'test-n-创建储值卡支付订单', 'plan1_of_wechatno', 'pj_wechatno', 108, 1, '', 'http', 'm.test.saofu.cn', '80', '{"请求头":{"Content-Type":"application/x-www-form-urlencoded","charset":"utf-8"},"方法":"post","url":"/cmorder/1/4","参数":{"serial":"[global_serial]","openId":"[global_openId]","fm":1,"mallGoodsId":"26838", "amount":1,"cartIds":"","fetchTime":"", "remark":""}}', '{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"\\"success\\":true", "消息":"创建储值卡支付订单失败,success不为True"}],"输出":{"success": "\\"success\\":(.+?),","attach":"attach\\":\\"(.+?)\\""}}', 'Block', '', '')
2016-11-30 12:11:20,450 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 12:11:20,450 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_urlencode
2016-11-30 12:11:20,450 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_openId]
2016-11-30 12:11:20,450 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_serial]
2016-11-30 12:11:20,450 casestep.py[line: 104] INFO: 转换后的参数体为：{'cartIds': '', 'openId': 'ous64uFCCLMyXYDJ-MkNilyCI5CY', 'amount': 1, 'fm': 1, 'mallGoodsId': '26838', 'remark': '', 'fetchTime': '', 'serial': '10549840601068216320'}
2016-11-30 12:11:20,450 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:11:20,450 casestep.py[line: 104] INFO: 转换后的参数体为：{'Content-Type': 'application/x-www-form-urlencoded', 'charset': 'utf-8'}
2016-11-30 12:11:20,450 InterfaceUnittestTestCase.py[line: 30] INFO: 正在发起POST请求...
2016-11-30 12:11:20,451 httpprotocol.py[line: 74] INFO: 发起的请求为：http://m.test.saofu.cn:80/cmorder/1/4
2016-11-30 12:11:20,451 httpprotocol.py[line: 75] INFO: 参数为：b'cartIds=&openId=ous64uFCCLMyXYDJ-MkNilyCI5CY&amount=1&fm=1&mallGoodsId=26838&remark=&fetchTime=&serial=10549840601068216320'
2016-11-30 12:11:20,451 httpprotocol.py[line: 76] INFO: 请求头为：{'Content-Type': 'application/x-www-form-urlencoded', 'charset': 'utf-8', 'Cookie': '10549840601068216320=ous64uFCCLMyXYDJ-MkNilyCI5CY'}
2016-11-30 12:11:23,810 InterfaceUnittestTestCase.py[line: 40] INFO: 正在对服务器返回body进行解码
2016-11-30 12:11:23,810 InterfaceUnittestTestCase.py[line: 54] INFO: 服务器返回结果"响应体(body)": {"success":true,"message":null,"attach":"20803813655897133056"}
2016-11-30 12:11:23,811 InterfaceUnittestTestCase.py[line: 55] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:11:27 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('Vary', 'Accept-Encoding')]
2016-11-30 12:11:23,811 InterfaceUnittestTestCase.py[line: 56] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:11:23,811 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为："success":true
2016-11-30 12:11:23,811 unittesttestcase.py[line: 278] INFO: 获取到的变量的值为：['true']
2016-11-30 12:11:23,812 unittesttestcase.py[line: 278] INFO: 获取到的变量的值为：['20803813655897133056']
2016-11-30 12:11:23,812 unittesttestcase.py[line: 290] INFO: 提取的输出结果(key-value对)为:[{'OperatorId': 1318}, {'Token': '09e39fe9-0722-47f5-8480-b07661907830'}, {'success_1': 'true'}, {'attach_1': '20803813611848552448'}, {'attach_1': '20803813655897133056'}]
2016-11-30 12:11:23,812 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:23,812 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="post", runtime="2016-11-30 12:11:20",step_action="{'参数': {'cartIds': '', 'openId': 'ous64uFCCLMyXYDJ-MkNilyCI5CY', 'amount': 1, 'fm': 1, 'mallGoodsId': '26838', 'remark': '', 'fetchTime': '', 'serial': '10549840601068216320'}, '方法': 'post', 'url': '/cmorder/1/4', '请求头': {'Content-Type': 'application/x-www-form-urlencoded', 'charset': 'utf-8'}}", expected_results="{'条件': [{'消息': '创建储值卡支付订单失败,success不为True', '模式': ''success':true'}], '检查': 'body', '输出': {'success': ''success':(.+?),', 'attach': 'attach':'(.+?)''}, '匹配规则': '包含字符串'}" WHERE executed_history_id = 20161130121106 AND testcase_id = 106 AND step_id = 108 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:23,817 testcase.py[line: 163] INFO: 测试用例[id=106, name=test-n-创建储值卡支付订单]执行成功
2016-11-30 12:11:23,817 global_function.py[line: 79] INFO: 正在更新用例执行结果
2016-11-30 12:11:23,817 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 12:11:20" WHERE executed_history_id = 20161130121106 and testcase_id = 106 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:23,820 global_function.py[line: 86] INFO: 指定用例[106]已执行完
2016-11-30 12:11:23,820 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:23,820 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 12:11:19",step_action="{'步骤类型': '执行用例', '用例id': 106, '用例名称': 'test-n-创建储值卡支付订单'}", expected_results="" WHERE executed_history_id = 20161130121106 AND testcase_id = 114 AND step_id = 116 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:23,824 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"方法":"get","url":"/pay/5?","参数":{"orderId":"[attach_1]","serial":"[global_serial]"}}
2016-11-30 12:11:23,824 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"确认支付", "消息":"提交储值卡支付订单-pay5重定向失败,没确认支付按钮"},{"模式":"储值卡", "消息":"提交储值卡支付订单-pay5重定向失败,没打开页面"}]}
2016-11-30 12:11:23,824 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:23,824 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 114, 'test-n-提交储值卡支付订单-pay5重定向', 'plan1_of_wechatno', 'pj_wechatno', 117, 2, '', 'http', 'm.test.saofu.cn', 80, '{"方法":"get","url":"/pay/5?","参数":{"orderId":"[attach_1]","serial":"[global_serial]"}}', '{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"确认支付", "消息":"提交储值卡支付订单-pay5重定向失败,没确认支付按钮"},{"模式":"储值卡", "消息":"提交储值卡支付订单-pay5重定向失败,没打开页面"}]}', 'Block', '', '')
2016-11-30 12:11:23,826 testcase.py[line: 77] INFO: 开始执行步骤操作[第2步]
2016-11-30 12:11:23,826 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_urlencode
2016-11-30 12:11:23,826 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[attach_1]
2016-11-30 12:11:23,827 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_serial]
2016-11-30 12:11:23,827 casestep.py[line: 104] INFO: 转换后的参数体为：{'orderId': '20803813655897133056', 'serial': '10549840601068216320'}
2016-11-30 12:11:23,827 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:11:23,827 InterfaceUnittestTestCase.py[line: 35] INFO: 正在发起GET请求...
2016-11-30 12:11:23,827 httpprotocol.py[line: 56] INFO: 发起的请求为：http://m.test.saofu.cn:80/pay/5?orderId=20803813655897133056&serial=10549840601068216320
2016-11-30 12:11:23,828 httpprotocol.py[line: 57] INFO: 请求头为：{'Cookie': '10549840601068216320=ous64uFCCLMyXYDJ-MkNilyCI5CY'}
2016-11-30 12:11:28,832 InterfaceUnittestTestCase.py[line: 40] INFO: 正在对服务器返回body进行解码
2016-11-30 12:11:28,833 InterfaceUnittestTestCase.py[line: 54] INFO: 服务器返回结果"响应体(body)": 






<!DOCTYPE html>
<link rel="stylesheet" href="/css/bind/banner.css?v=3.8.0-ab8ee" />  
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <script src="/component/flexible/js/flexible.js?v=3.8.0-ab8ee"></script>
        <meta name="format-detection" content="telephone=no">
        <meta http-equiv="Expires" CONTENT="0">
        <meta http-equiv="Cache-Control" CONTENT="no-cache">
        <meta http-equiv="Pragma" CONTENT="no-cache">
        <title>储值卡</title>
        <link rel="stylesheet" href="/common/css/common-pc.css?v=3.8.0-ab8ee">
        <link rel="stylesheet" href="/component/flexible/css/flexible-font.css?v=3.8.0-ab8ee">
        <link rel="stylesheet" type="text/css" href="/plugin/zepto/css/zepto.alert.css?v=3.8.0-ab8ee">
        <link rel="stylesheet" href="/css/pay/pay.css?v=3.8.0-ab8ee" />
    </head>
    <body>
        <div id="wrapper">
        	
		    	
		    	
		    		
		    		
		    		
		    		
		    		
		    		
		    		<div class="header">
		    			<div class="middle-header">
		                    <!-- 
			    				
			    				
			    					<p>深圳云移</p>
			    				
			    			 -->
                            <p class="price-key text-32">实付金额</p>
		    				
		    					
		    						<p class="price text-66">￥0.01</p>
		    						
		    					
		    					
		    				

			                <!-- <p class="warning"></p> -->
			            </div>
		            </div>
		            <div class="content text-28">


                        <div class="detail">

                            <p class="store">
                                门店名称<span class="shop-name">
                                
                                    
                                    
                                        <span>深圳云移</span>
                                    
                                
                            </p>

		                    <!-- <p>商户名称 : <span class="r-span">深圳云移</span></p>
		                    
		                    	<p>交易单号 : <span class="r-span">30803813668449161216</span></p>
		                     -->
		                    
		                    <!-- <p style="display: none">实付金额 : <span class="r-span trade-fee">0.02</span></p> -->
                            <div class="box">
                                <div class="area">
                                    <p class="order-money">订单金额 : <span class="trade-price trade-fee">0.02</span></p>
    		                        
                                </div>

                                <div class="area area-discount">
                                    
                                        
        		                    		<p class="li-top-bottom">使用优惠 :
                                                <span class="discount-value">
            		                    			<span class="youhui-name">会员折扣</span>
                                                    <span class="r-span">-￥</span>
                                                    <span class="r-span youhui-price">
                                                        0.01
                                                    </span>
                                                    
                                                        <i class='arrow'></i>
                                                    
                                                </span>
        		                    		</p>
                                            
                                        
                                    
                                    
                                    
                                        <p class="bonus" id="bonusDiv" style="display:none">
                                            积分抵现: <span class='integral-value'>
                                            <span class="trueBonus">0</span>积分抵扣￥<span class="trueFee">0.00</span>元
                                            
                                                <span class="bg-img"></span>
                                            
                                            <input type="radio" name="ka"/></span>
                                        </p>
                                    
                                </div>

                                <div class="area area-spe">
                                    <p class="paid-money">实付金额
                                        <span class="paid-value">￥
                                            
                                                
                                                    0.01
                                                    
                                                
                                            
                                            
                                        </span>
                                    </p>
                                </div>
                            </div>
		                </div>
		                <div class="contain-check">
		                	
			                
			                	
			                		<p class="ka-p cf" type="2" id="541055300425">
				                		<span class="member">使用次数测试</span>:<span class="member-num">99.05</span><span class="integral-value">
				                        <span class="bg-img"></span>
				                        <input type="radio" name="ka"/></span>
				                    </p>
			                	
			                
			                
			                	<p class="ka-p cf no2" type="1" id="" >
			                		<span class="member">会员账户</span>:
	                                <span class="member-num">0.00</span>
	                                <span class="integral-value">
			                            <span class="bg-img check-img"></span>
			                            <input type="radio" name="ka"/>
	                                </span>
			                    </p>
		                    
			                
			                	
			                
		                </div>
		            </div>
		            <div class="footer">
		                <button class="btn-a text-32">确认支付</button>
		            </div>

		            <div class="bg"></div>
		            <ul class="detail youhui">
		            	<li class="return-youhui text-30">返回</li>
		            	<li class="text-28"><a class="li-youhui-name" cardId="-1" cardType="-1" cardAmount = "0">不使用优惠</a><span class="li-youhui"></span></li>
		            	
		            		<li class="text-28">
								<a class="li-youhui-name" cardId="167020" cardType="MEMBER_CARD" cardAmount="0">会员折扣
								</a>		            			
		            			<span class="green">-￥
		            				<span class="green li-youhui">
		            					0.01
		            				</span>
		            				<span class="green li-fee-pay" style="display:none;">
		            					0.01
		            				</span>
		            			</span>
		            		</li>
		            	
		            		<li class="text-28">
								<a class="li-youhui-name" cardId="519880500426" cardType="CASH" cardAmount="1">接口-代金券
								</a>		            			
		            			<span class="green">-￥
		            				<span class="green li-youhui">
		            					0.01
		            				</span>
		            				<span class="green li-fee-pay" style="display:none;">
		            					0.01
		            				</span>
		            			</span>
		            		</li>
		            	
		            		<li class="text-28">
								<a class="li-youhui-name" cardId="590880300421" cardType="DISCOUNT" cardAmount="1">测试
								</a>		            			
		            			<span class="green">-￥
		            				<span class="green li-youhui">
		            					0.01
		            				</span>
		            				<span class="green li-fee-pay" style="display:none;">
		            					0.01
		            				</span>
		            			</span>
		            		</li>
		            	
		            		<li class="text-28">
								<a class="li-youhui-name" cardId="559835600429" cardType="DISCOUNT" cardAmount="1">测试
								</a>		            			
		            			<span class="green">-￥
		            				<span class="green li-youhui">
		            					0.01
		            				</span>
		            				<span class="green li-fee-pay" style="display:none;">
		            					0.01
		            				</span>
		            			</span>
		            		</li>
		            	
		            		<li class="text-28">
								<a class="li-youhui-name" cardId="500958000429" cardType="DISCOUNT" cardAmount="1">测试
								</a>		            			
		            			<span class="green">-￥
		            				<span class="green li-youhui">
		            					0.01
		            				</span>
		            				<span class="green li-fee-pay" style="display:none;">
		            					0.01
		            				</span>
		            			</span>
		            		</li>
		            	
		            </ul>

                    <!-- 异步加载菊花 -->
                    <div class="loader j-loader dn">
                        <i class="icon"></i>
                    </div>
                    
		            <script type="text/javascript" src="/plugin/zepto/js/zepto.min.js?v=3.8.0-ab8ee"></script>
		            <script type="text/javascript" src="/plugin/zepto/js/touch.js?v=3.8.0-ab8ee"></script>
		            <script type="text/javascript" src="/js/mall/mall.js?v=3.8.0-ab8ee"></script>
		            <script type="text/javascript" src="/plugin/zepto/js/zepto.alert.min.js?v=3.8.0-ab8ee"></script>
		            <script type="text/javascript" src="/js/crypto.md5.js?v=3.8.0-ab8ee"></script>
			        <script type="text/javascript">
			        	var hasYouHui = 'false';
			        	var useDiscount = 'true';
			        	var selectCardId='',selectCardType='',selectCardName='',selectCardNum=0;
			        	
			        	// 若优惠和抵现都无，这隐藏这个area
				    	var $areaDiscount = $('.area-discount');
			        	
			        	if (useDiscount ==  'false' && ('true' == 'false' || ('true' == 'true' && $('#bonusDiv').css('display') == 'none'))) {
			        		$areaDiscount.hide();
			        	}
			        	
			        	var bonusNum='',bonusPrice='';
			        	if(hasYouHui == 'false') {
			        		selectCardId='167020';
			        		selectCardType='MEMBER_CARD';
			        		selectCardName='会员折扣';
			        		selectCardNum = '0';
			        	}
				        window.onload=function(){
				        	$(".bg").css('height',$("#wrapper").height()+'px');
				        	$(".li-top-bottom").click(function(){
				        		if(hasYouHui == 'true') {
				        			return;
				        		}
				        		$(".bg,.detail").show('slow');
				        	});
				        	var balance = $(".ka-p span.check-img").parent().prev("span.member-num").text();

				        	// 使用优惠券浮层
				        	$(".detail li").click(function(){
				        		var obj = $(this);
				        		balance = $(".ka-p span.check-img").parent().prev("span.member-num").text();

				        		// 为true是，是返回按钮
				        		if(obj.hasClass('return-youhui')){
				        			$(".bg,.youhui").hide('slow');
				        		}else{
				        			var obj_val = obj.find('.li-youhui').html();
				        			var obj_name = obj.find(".li-youhui-name").html();
				        			var obj_fee_pay = obj.find(".li-fee-pay").html();  // 实际支付金额
				        			var obj_real_fee = $(".trade-fee").text();  // 原来的金额

				        			// 计算实收
				        			if(obj_val == ''){
				        				$(".youhui-price").html('0');
				        				$(".discount-fee").hide();
				        				$(".li-top-bottom .r-span").hide();
				        				$(".price").html('￥'+obj_real_fee);
                                        $('.paid-value').html('￥'+obj_real_fee);
				        				//$(".contain-p .pay-fee").html(obj_real_fee);
						        		selectCardName = '';
				        			}
				        			else {
				        				$(".discount-fee").show();
				        				$(".li-top-bottom .r-span").show();
				        				$(".youhui-price").html(obj_val);

				        				$(".discount-fee").html('￥'+obj_real_fee);  // 原来应付金额
				        				//$(".contain-p .pay-fee").html(obj_fee_pay); // 实付金额
				        				$(".price").html('￥'+obj_fee_pay);  // 实付金额
                                        $(".paid-value").html('￥'+obj_fee_pay);

					        			selectCardName = obj_name;
				        			}

				        			selectCardId = obj.find(".li-youhui-name").attr("cardId");
				        			selectCardType = obj.find(".li-youhui-name").attr("cardType");
				        			selectCardNum = obj.find(".li-youhui-name").attr("cardAmount");
				        			$(".youhui-name").html(obj_name)
				        			$(".bg,.youhui").hide('slow');

					                checkBalance(balance);
				                    changeBonus(true);
				                }
				        	});
				        	checkBalance(balance);
				        }
			        	function checkBalance(balance) {
	                		var price = $(".middle-header .price").text();
	                		price = price.split("￥")[1];
	                		if(parseFloat(balance) < parseFloat(price)) {
	                			$(".btn-a").prop("disabled", true).addClass("disable");
	                			$(".header .warning").css("display", "block").text("余额不足");
	                		} else {
	                			$(".btn-a").prop("disabled", false).removeClass('disable');
	                			$(".header .warning").css("display", "none").text("");
	                		}

	                		var obj = $(".bonus").find('span.bg-img');
		                    if(useDiscount == 'false' && obj.css('display') == 'none'){
		                		//隐藏横杠
		                		$('.area-discount').addClass('dn');
		                    }

	                		//循环所有会员账户和储值卡
	                		var temp = 0;
							$(".ka-p").each(function(index, node){

							    var value = parseFloat($(node).find('.member-num').text());

							    // 当该值小于balance的时候，添加no2
							    if (value < parseFloat($('.paid-value').text().replace(/(\s*)/g,'').replace(/￥/g, ''))) {
							    	$(node).addClass('no2')
							    }
							    else {
							    	// 存在可选的卡
							    	temp = 1;
							    	$(node).removeClass('no2')
							    }
							})

							if (temp === 0) {
								$(".btn-a").prop("disabled", true).addClass("disable");
							}
			        	}

			        	function changeBonus(flag){
			        		if(flag){
			        			var undiscountableAmount = (parseFloat("0")/100).toFixed(2);
			        			var price = parseFloat($(".price").text().substring(1)).toFixed(2); // 实付金额
			        			//加入不可优惠金额,计算优惠时先减去
			        			price = price - undiscountableAmount;

			        			var m_price = parseFloat(Math.round((parseFloat(price) * parseFloat("100")))/100).toFixed(2);//最大抵扣金额
			        			if (parseFloat(m_price) >= parseFloat(price) && undiscountableAmount <= 0) {
			        				//如果无不可优惠金额,那么可以抵扣到只剩一分钱
		                        	m_price = parseFloat((price*100 - 1)/100);
		    					}
			        			var max_bonus = 0;
		                        var max_price = 0;
		                        var bonusStand = "";
		                        if (parseInt("1") == 1) {
		                        	bonusStand = true;
		                        }
		                        if(bonusStand){
		                        	max_bonus = parseInt(parseFloat(m_price/parseFloat("0.01")).toFixed(2));
		                        	max_price = parseFloat(max_bonus * parseFloat("0.01")).toFixed(2);//最大抵扣金额
	                        	}else{
	                        		max_bonus = parseInt(m_price*100*parseFloat("1")); //抵扣最大金额所需积分
	                        		max_price = parseFloat(m_price).toFixed(2);//最大抵扣金额
	                        	}
		                        if(0 >= max_bonus || 0 >= parseInt("")){
		                        	$("#bonusDiv").hide();
		                        	bonusNum='';
		                        	bonusPrice='';
		                        	return;
		                        }else if(parseInt("") < max_bonus){//用户积分不足达到最大上限积分
		                        	if(""){
		                        		//var jishu = parseInt(parseInt("")/parseInt("1"));
		                        		var real_price = parseFloat(parseInt("") * parseFloat("0.01")).toFixed(2);//用户实际抵扣金额,单位：分
			                        	var real_bonus = parseInt(""); //用户实际抵扣所用积分
			                        	var end_price = parseFloat((parseFloat(price) - real_price)).toFixed(2);
			                        	var obj = $(".bonus").find('span.bg-img');
					                    if(obj.hasClass('check-img')){
			                        		$(".price").html('￥'+parseFloat(parseFloat(end_price) + parseFloat(undiscountableAmount)).toFixed(2));  // 实付金额
                                            $(".paid-value").html('￥'+parseFloat(parseFloat(end_price) + parseFloat(undiscountableAmount)).toFixed(2));
			                        		$(".pay-fee").html(end_price);
					                    }
			                        	$(".trueFee").html(real_price);
			                        	$(".trueBonus").html(real_bonus);
			                        	if(obj.hasClass('check-img')){
			                        		bonusPrice = real_price;
			                        		bonusNum = real_bonus;
			                        	}

		                        	}else{
 		                        		var jishu = parseInt(parseInt("")/parseInt("1"));
			                        	var real_price = parseFloat(jishu / 100).toFixed(2);//用户实际抵扣金额,单位：分
			                        	var real_bonus = jishu * parseInt("1"); //用户实际抵扣所用积分
			                        	var end_price = parseFloat(parseFloat(price) - real_price).toFixed(2);
			                        	var obj = $(".bonus").find('span.bg-img');
					                    if(obj.hasClass('check-img')){
			                        		$(".price").html('￥'+ parseFloat(parseFloat(end_price) + parseFloat(undiscountableAmount)).toFixed(2));  // 实付金额
			                        		//$(".pay-fee").html(end_price);
                                            $('.paid-value').html('￥'+ parseFloat(parseFloat(end_price) + parseFloat(undiscountableAmount)).toFixed(2));
					                    }
			                        	$(".trueFee").html(real_price);
			                        	$(".trueBonus").html(real_bonus);
			                        	if(obj.hasClass('check-img')){
			                        		bonusPrice = real_price;
			                        		bonusNum = real_bonus;
			                        	}
		                        	}
		                        	$("#bonusDiv").show();
		        				}else{
		        					var end_price = parseFloat(parseFloat(price) - max_price).toFixed(2);
		        					var obj = $(".bonus").find('span.bg-img');
				                    if(obj.hasClass('check-img')){
		                        		$(".price").html('￥'+parseFloat(parseFloat(end_price) + parseFloat(undiscountableAmount)).toFixed(2));  // 实付金额
		                        		//$(".pay-fee").html(end_price);
                                        $('.paid-value').html('￥'+parseFloat(parseFloat(end_price) + parseFloat(undiscountableAmount)).toFixed(2));
				                    }
		                        	$(".trueFee").html(max_price);
		                        	$(".trueBonus").html(max_bonus);
		                        	if(obj.hasClass('check-img')){
		                        		bonusPrice = max_price;
		                        		bonusNum = max_bonus;
		                        	}
		                        	$("#bonusDiv").show();
		        				}
			        		}else{
			        			var bonusFee = $(".trueFee").html();
			        			var price = $(".price").text().substring(1);
			        			var end_price = parseFloat(parseFloat(price) + parseFloat(bonusFee)).toFixed(2);
	                        	$(".price").html('￥'+ parseFloat(end_price).toFixed(2));  // 实付金额
                                $('.paid-value').html('￥'+ parseFloat(end_price).toFixed(2));
	                        	//$(".pay-fee").html(end_price);
	                        	bonusNum='';
	                        	bonusPrice='';
	                        	$("#bonusDiv").show();
			        		}
			        	}
			        	
			        	function sign(obj) {
			        		var arr = [];
			        		for(var key in obj) {
			        			arr[arr.length] = key;
			        		}
			        	    arr.sort();
			        	    var str = "";
			        	    for(var i = 0; i < arr.length; i++) {
			        	    	var key = arr[i];
			        			var val = obj[arr[i]];
			        			if(typeof(val) == 'number') {
			        				val = val + "";
			        			}
			        			if(null == val || "" == val || undefined == val) {
			        				continue;
			        			}
			        			str += key + "=" + val + "&";
			        		}
			        	    if(str.length > 0) {
			        	    	str = str.substring(0, str.length - 1);
			        	    }
			        	    return CryptoJS.MD5(str) + "";
			        	}

			        	Zepto(function(){
			                $('.ka-p').click(function(){

                                // 该选择是否不可选
                                if ($(this).hasClass('no2')) {
                                    return false;
                                }

			                    var obj = $(this).find('span.bg-img');
			                    if(obj.hasClass('check-img')){
			                        obj.removeClass('check-img');
			                        obj.next().removeAttr('checked');
			                    } else {
			                        $(".ka-p span").removeClass('check-img');
			                        $(".ka-p input[name=ka]").removeAttr('checked');
			                        obj.addClass('check-img');
			                        obj.next().attr('checked','checked');

			                        var balance = $(this).find("span.member-num").text();
			                        checkBalance(balance);
			                    }
			                });
			                if("false"=="false"){
			                	$('.bonus').click(function(){
				                    var obj = $(this).find('span.bg-img');
				                    if(obj.hasClass('check-img')){
				                    	obj.removeClass('check-img');
				                    	obj.next()[0].checked = false;
				                        changeBonus(false);
				                    }else{
				                    	$(".bonus span").removeClass('check-img');
				                        obj.addClass('check-img');
				                        obj.next()[0].checked = true;
				                        changeBonus(true);
				                    }
				                    var balance = $(".ka-p span.check-img").parent().prev("span.member-num").text();
				                    checkBalance(balance);
				                });
			                }

			                $(".btn-a").click(function(event){

			                	var card = $(".check-img").parents(".ka-p").attr("id");

			                	if(typeof(card) == "undefined" || card == undefined){
			                		doAlert("no", '请选择储值卡', function(){
		        						return;
		        					}, 3000);
			                		return;
			                	}
			                	else if (card == '') {

			                		var temp = 1;
			                		$('.ka-p').each(function(node, index) {
			                			if (!$(this).hasClass('no2')) {
			                				temp = 0;
			                			}
			                		})

			                		if (temp === 1) {
				                		doAlert("no", '没有可选的储值卡', function(){
			        						return;
			        					}, 3000);
				                		return;
			                		}
			                	}

			                	var balance = $(".ka-p span.check-img").parent().prev("span.member-num").text();
				                checkBalance(balance);

			                	$(".btn-a").prop("disabled", true).addClass("disable");

			        			$('.j-loader').removeClass('dn');
			        			
			        			var params = {
		            				orderId : "30803813668449161216",
		            				openId : "ous64uFCCLMyXYDJ-MkNilyCI5CY",
		            				productOrderId : "20803813655897133056",
		            				customerId : "167020",
		            				type : $(".ka-p span.check-img").parents(".ka-p").attr("type"),
		            				cardId : $(".check-img").parents(".ka-p").attr("id"),
		            				customerName : "fuyu",
		            				shopId : "42",
		            				yhCardId : selectCardId,
		            				yhCardType : selectCardType,
		            				yhCardNum : selectCardNum
		            			};
			        			var obj = $(".bonus").find('span.bg-img');
			                    if(obj.hasClass('check-img')){
			                    	params.discountNum = bonusNum;
			                    	params.discountPrice = parseFloat(bonusPrice).toFixed(2).toString();
			                    }
			                    params.token = sign(params);
			                    
			        			$.post("/pay/card/doconfirm", params, function(result){
			        				$('.j-loader').addClass('dn');

			        				if(!result.success && result.attach != null && result.attach == '700401'){
			        					doAlert("no", '当前所选卡券已无法使用，请重新选择', function(){
			        						window.location.reload();
			        					}, 3000);
			        					return;
			        				}

			        				$(".btn-a").prop("disabled", false).removeClass('disable');
			        				var resultLoc = "/pay/pay/result?ptype=5";
			        				resultLoc += "&serial=10549840601068216320";
			        				if("" != ""){
			        					resultLoc += "&shopBranchId=";
			        				}
			        				resultLoc += "&productOrderId=20803813655897133056"
			        				if (!result.success) {
			        					resultLoc += "&success=0";
			        				}else{
			        					resultLoc += "&success=1";
			        				}
			        				resultLoc += "&cardName=" + selectCardName;
			        				window.location.href = resultLoc;
			        	    	});
			        		});
			            });
			        </script>
		    	
		    
        </div>
    </body>
</html>
2016-11-30 12:11:28,836 InterfaceUnittestTestCase.py[line: 55] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:11:31 GMT'), ('Content-Type', 'text/html;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('Set-Cookie', 'JSESSIONID=AF1E66BD59E4571D0749D3ECC99BEB76; Path=/; HttpOnly'), ('Content-Language', 'en-US')]
2016-11-30 12:11:28,836 InterfaceUnittestTestCase.py[line: 56] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:11:28,836 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为：确认支付
2016-11-30 12:11:28,836 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为：储值卡
2016-11-30 12:11:28,836 unittesttestcase.py[line: 292] WARNING: 未检测到从服务器返回中提取内容的要求，请检查是否正确填写预期结果
2016-11-30 12:11:28,836 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:28,837 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="get", runtime="2016-11-30 12:11:23",step_action="{'方法': 'get', 'url': '/pay/5?', '参数': {'orderId': '20803813655897133056', 'serial': '10549840601068216320'}}", expected_results="{'条件': [{'消息': '提交储值卡支付订单-pay5重定向失败,没确认支付按钮', '模式': '确认支付'}, {'消息': '提交储值卡支付订单-pay5重定向失败,没打开页面', '模式': '储值卡'}], '检查': 'body', '匹配规则': '包含字符串'}" WHERE executed_history_id = 20161130121106 AND testcase_id = 114 AND step_id = 117 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:28,839 testcase.py[line: 163] INFO: 测试用例[id=114, name=test-n-提交储值卡支付订单-pay5重定向]执行成功
2016-11-30 12:11:28,839 testplan.py[line: 76] INFO: 正在更新用例执行结果
2016-11-30 12:11:28,839 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 12:11:19" WHERE executed_history_id = 20161130121106 AND testcase_id = 114 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:28,965 testplan.py[line: 87] INFO: 正在更新testlink上测试计划[testplan_id=74, bulid_version=v1.0.0],对应用例[testcase_id=114]的执行结果
2016-11-30 12:11:29,296 testplan.py[line: 45] INFO: 获取测试用例信息 [{'is_open': '1', 'steps': [{'id': '82', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;:&quot;包含字符串&quot;,</p>\n<p>\n\t&quot;条件&quot;:[{&quot;模式&quot;:&quot;立即购买&quot;,&quot;消息&quot;:&quot;点击商品时无法打开购买页面&quot;}]</p>\n<p>\n\t}</p>\n', 'actions': '<p>\n\t{<br />\n\t&quot;方法&quot;:&quot;get&quot;,<br />\n\t&quot;url&quot;:&quot;/goods/item?&quot;,<br />\n\t&quot;参数&quot;:{&quot;id&quot;:26838, &quot;serial&quot;:&quot;[global_serial]&quot;}<br />\n\t}</p>\n', 'step_number': '1', 'active': '1', 'execution_type': '1'}], 'id': '81', 'testsuite_id': '79', 'updater_id': '1', 'author_last_name': 'Administrator', 'active': '1', 'tc_external_id': '2', 'creation_ts': '2016-07-20 11:05:03', 'name': 'test-n-点击商品', 'updater_login': 'admin', 'execution_type': '1', 'author_id': '1', 'importance': '2', 'modification_ts': '2016-11-29 18:16:14', 'preconditions': '', 'updater_last_name': 'Administrator', 'version': '1', 'node_order': '1000', 'author_login': 'admin', 'updater_first_name': 'Testlink', 'author_first_name': 'Testlink', 'layout': '1', 'full_tc_external_id': 'wecharno-2', 'summary': '', 'estimated_exec_duration': '', 'testcase_id': '80', 'status': '1'}]
2016-11-30 12:11:29,432 testplan.py[line: 69] INFO: 记录测试用例到测试用例报表
2016-11-30 12:11:29,432 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 80, 'test-n-点击商品', '微商城-模拟点击页面跳转', 'plan1_of_wechatno', 'pj_wechatno', 'Block', '')
2016-11-30 12:11:29,434 testplan.py[line: 72] INFO: 开始执行测试用例[id=80，name=test-n-点击商品]
2016-11-30 12:11:29,434 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"方法":"get","url":"/goods/item?","参数":{"id":26838, "serial":"[global_serial]"}}
2016-11-30 12:11:29,434 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"立即购买","消息":"点击商品时无法打开购买页面"}]}
2016-11-30 12:11:29,434 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:29,434 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 80, 'test-n-点击商品', 'plan1_of_wechatno', 'pj_wechatno', 82, 1, '', 'http', 'm.test.saofu.cn', 80, '{"方法":"get","url":"/goods/item?","参数":{"id":26838, "serial":"[global_serial]"}}', '{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"立即购买","消息":"点击商品时无法打开购买页面"}]}', 'Block', '', '')
2016-11-30 12:11:29,435 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 12:11:29,435 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_urlencode
2016-11-30 12:11:29,435 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_serial]
2016-11-30 12:11:29,435 casestep.py[line: 104] INFO: 转换后的参数体为：{'id': 26838, 'serial': '10549840601068216320'}
2016-11-30 12:11:29,435 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:11:29,436 InterfaceUnittestTestCase.py[line: 35] INFO: 正在发起GET请求...
2016-11-30 12:11:29,436 httpprotocol.py[line: 56] INFO: 发起的请求为：http://m.test.saofu.cn:80/goods/item?id=26838&serial=10549840601068216320
2016-11-30 12:11:29,436 httpprotocol.py[line: 57] INFO: 请求头为：{'Cookie': '10549840601068216320=ous64uFCCLMyXYDJ-MkNilyCI5CY'}
2016-11-30 12:11:29,498 InterfaceUnittestTestCase.py[line: 40] INFO: 正在对服务器返回body进行解码
2016-11-30 12:11:29,498 InterfaceUnittestTestCase.py[line: 54] INFO: 服务器返回结果"响应体(body)": 





<!DOCTYPE html>
<link rel="stylesheet" href="/css/bind/banner.css?v=3.8.0-ab8ee" />  
<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
	<meta name="format-detection" content="telephone=no">
	<title>深圳云移</title>
	<link rel="stylesheet" href="/common/css/common-pc.css?v=3.8.0-ab8ee">
	<link rel="stylesheet" href="/component/swiper/css/swiper.css?v=3.8.0-ab8ee">
	<link rel="stylesheet" href="/css/malls/detail.css?v=3.8.0-ab8ee">
</head>
<body>
	<div class="wrapper">

		<!-- banner滚图 -->
		<div class="banner j-banner">
			<div class="swiper-container j-swiper-container">
			  	<div class="swiper-wrapper j-swiper-wrappper"></div>
			</div>
			<div class="pagination"></div>
		</div>

		<!-- 详细商品信息 -->
		<div class="message j-message"></div>

		<!-- 已选 -->
		<div class="choice j-choice dn">
			<span class="key j-choice-key">请选择商品规格</span>
			<span class="value j-choice-value"></span>
			<i class="arrow"></i>
		</div>

		<!-- 图文详情 -->
		<div class="pic-detail j-pic-detail dn">
			<div class="bottom-details">
			</div>
		</div>

		<!-- 选择规格 -->
		<div class="specification j-specification">

			<div class="wrap j-wrap">
				<i class="close j-close"></i>
				<!-- 商品信息 -->
				<div class="mes-wrap">
					<div class="mes j-mes">
						<!-- <img src="" height="160" width="214" alt="" class="pic">
						<div class="describe">
							<h3 class="title">￥<span class="j-price">345</span></h3>
							<p class="text">爱上邓丽君可拉伸的房间爱老师肯定放假阿斯蒂芬阿斯蒂芬</p>
						</div> -->
					</div>
				</div>

				<div class="j-type-num">
					<!-- 规格选择 -->
					<!-- <div class="type">
						<h3 class="title">规格选择</h3>
						<ul class="lists j-type">
							<li data="22"class="item j-item" price="22">颜色</li>
						</ul>
					</div> -->

					<!-- 购买数量 -->
					<div class="num cf">
						<h3 class="title">购买数量</h3>
						<div class="box" unselectable="on" style="-moz-user-select:none;-webkit-user-select:none;" onselectstart="return false;">
							<i class="reduce j-reduce" unselectable="on" style="-moz-user-select:none;-webkit-user-select:none;" onselectstart="return false;">-</i><input type="text" class="text j-text" readonly value="1" unselectable="on" style="-moz-user-select:none;-webkit-user-select:none;" onselectstart="return false;"/><i class="add j-add" unselectable="on" style="-moz-user-select:none;-webkit-user-select:none;" onselectstart="return false;">+</i>
						</div>
					</div>
				</div>

				<!-- 确定按钮 -->
				<a class="sure j-sure">确定</a>
			</div>
		</div>

		<!-- 底部固定栏 -->
		<footer class="footer j-footer">
			<a href="/cart?serial=10549840601068216320" class="cart ">
				<span class="num j-cart-num"></span>
			</a>
			<span class="add-cart j-add-cart">加入购物车</span>
			<span class="buy buy-imdtly j-buy-imdtly">立即购买</span>
		</footer>

		<!-- 提示弹窗 -->
		<div class="popup j-popup">
			<p class="text j-tip-content"></p>
		</div>

	</div>
	<script type="text/javascript">
		// changed by huangtao
		var mallGoodStandardType = "", // 商品类型，1为单规格，2为双规格
			mallGoodsId = "",
			ctx = "",
			serial = "10549840601068216320";
	</script>

	<script src="/plugin/zepto/js/zepto.min.js?v=3.8.0-ab8ee"></script>
	<script src="/common/js/request.js?v=3.8.0-ab8ee"></script>
	<script src="/common/js/extend-number.js?v=3.8.0-ab8ee"></script>
	<script src="/component/iscroll/js/iscroll.js?v=3.8.0-ab8ee"></script>
	<script src="/component/swiper/js/swiper.min.js?v=3.8.0-ab8ee"></script>
	<script src="/js/malls/detail.js?v=3.8.0-ab8ee"></script>
</body>
</html>
2016-11-30 12:11:29,502 InterfaceUnittestTestCase.py[line: 55] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:11:32 GMT'), ('Content-Type', 'text/html;charset=UTF-8'), ('Content-Length', '3931'), ('Connection', 'close'), ('Set-Cookie', 'JSESSIONID=BAC10004E2349806EF7FA5ACD6A35A39; Path=/; HttpOnly'), ('Content-Language', 'en-US')]
2016-11-30 12:11:29,503 InterfaceUnittestTestCase.py[line: 56] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:11:29,503 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为：立即购买
2016-11-30 12:11:29,503 unittesttestcase.py[line: 292] WARNING: 未检测到从服务器返回中提取内容的要求，请检查是否正确填写预期结果
2016-11-30 12:11:29,503 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:29,503 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="get", runtime="2016-11-30 12:11:29",step_action="{'方法': 'get', 'url': '/goods/item?', '参数': {'id': 26838, 'serial': '10549840601068216320'}}", expected_results="{'条件': [{'消息': '点击商品时无法打开购买页面', '模式': '立即购买'}], '检查': 'body', '匹配规则': '包含字符串'}" WHERE executed_history_id = 20161130121106 AND testcase_id = 80 AND step_id = 82 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:29,506 testcase.py[line: 163] INFO: 测试用例[id=80, name=test-n-点击商品]执行成功
2016-11-30 12:11:29,506 testplan.py[line: 76] INFO: 正在更新用例执行结果
2016-11-30 12:11:29,506 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 12:11:29" WHERE executed_history_id = 20161130121106 AND testcase_id = 80 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:29,634 testplan.py[line: 87] INFO: 正在更新testlink上测试计划[testplan_id=74, bulid_version=v1.0.0],对应用例[testcase_id=80]的执行结果
2016-11-30 12:11:29,876 testplan.py[line: 45] INFO: 获取测试用例信息 [{'is_open': '1', 'steps': [{'id': '104', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;:&quot;包含字符串&quot;,</p>\n<p>\n\t&quot;条件&quot;:[{&quot;模式&quot;:&quot;到店支付&quot;,&quot;消息&quot;:&quot;无法打开商品详情&quot;}]</p>\n<p>\n\t}</p>\n', 'actions': '<p>\n\t{<br />\n\t&quot;方法&quot;:&quot;get&quot;,<br />\n\t&quot;url&quot;:&quot;/mall/tobuy/1?&quot;,<br />\n\t&quot;参数&quot;:{&quot;mallGoodsId&quot;:&quot;26838&quot;,&quot;amount&quot;:1,&quot;type&quot;:1,&quot;serial&quot;:&quot;[global_serial]&quot;}<br />\n\t}</p>\n', 'step_number': '1', 'active': '1', 'execution_type': '1'}], 'id': '103', 'testsuite_id': '79', 'updater_id': '1', 'author_last_name': 'Administrator', 'active': '1', 'tc_external_id': '7', 'creation_ts': '2016-07-20 16:48:26', 'name': 'test-n-点击立即购买按钮', 'updater_login': 'admin', 'execution_type': '1', 'author_id': '1', 'importance': '2', 'modification_ts': '2016-11-29 18:14:53', 'preconditions': '', 'updater_last_name': 'Administrator', 'version': '1', 'node_order': '1001', 'author_login': 'admin', 'updater_first_name': 'Testlink', 'author_first_name': 'Testlink', 'layout': '1', 'full_tc_external_id': 'wecharno-7', 'summary': '', 'estimated_exec_duration': '', 'testcase_id': '102', 'status': '1'}]
2016-11-30 12:11:30,008 testplan.py[line: 69] INFO: 记录测试用例到测试用例报表
2016-11-30 12:11:30,008 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 102, 'test-n-点击立即购买按钮', '微商城-模拟点击页面跳转', 'plan1_of_wechatno', 'pj_wechatno', 'Block', '')
2016-11-30 12:11:30,009 testplan.py[line: 72] INFO: 开始执行测试用例[id=102，name=test-n-点击立即购买按钮]
2016-11-30 12:11:30,009 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"方法":"get","url":"/mall/tobuy/1?","参数":{"mallGoodsId":"26838","amount":1,"type":1,"serial":"[global_serial]"}}
2016-11-30 12:11:30,009 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"到店支付","消息":"无法打开商品详情"}]}
2016-11-30 12:11:30,009 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:30,010 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 102, 'test-n-点击立即购买按钮', 'plan1_of_wechatno', 'pj_wechatno', 104, 1, '', 'http', 'm.test.saofu.cn', 80, '{"方法":"get","url":"/mall/tobuy/1?","参数":{"mallGoodsId":"26838","amount":1,"type":1,"serial":"[global_serial]"}}', '{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"到店支付","消息":"无法打开商品详情"}]}', 'Block', '', '')
2016-11-30 12:11:30,011 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 12:11:30,011 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_urlencode
2016-11-30 12:11:30,011 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_serial]
2016-11-30 12:11:30,011 casestep.py[line: 104] INFO: 转换后的参数体为：{'mallGoodsId': '26838', 'type': 1, 'serial': '10549840601068216320', 'amount': 1}
2016-11-30 12:11:30,011 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:11:30,011 InterfaceUnittestTestCase.py[line: 35] INFO: 正在发起GET请求...
2016-11-30 12:11:30,012 httpprotocol.py[line: 56] INFO: 发起的请求为：http://m.test.saofu.cn:80/mall/tobuy/1?mallGoodsId=26838&type=1&serial=10549840601068216320&amount=1
2016-11-30 12:11:30,012 httpprotocol.py[line: 57] INFO: 请求头为：{'Cookie': '10549840601068216320=ous64uFCCLMyXYDJ-MkNilyCI5CY'}
2016-11-30 12:11:30,500 InterfaceUnittestTestCase.py[line: 40] INFO: 正在对服务器返回body进行解码
2016-11-30 12:11:30,500 InterfaceUnittestTestCase.py[line: 54] INFO: 服务器返回结果"响应体(body)": 
	 





<!DOCTYPE html>
<link rel="stylesheet" href="/css/bind/banner.css?v=3.8.0-ab8ee" />  
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no">
<meta http-equiv="Expires" CONTENT="0">
<meta http-equiv="Cache-Control" CONTENT="no-cache">
<meta http-equiv="Pragma" CONTENT="no-cache">
<title>微商城</title>
<link rel="stylesheet" href="/css/mall/pure.css?v=3.8.0-ab8ee">
<link rel="stylesheet" href="/css/mall/grids-core.css?v=3.8.0-ab8ee">
<link rel="stylesheet" href="/css/mall/zepto.alert.css?v=3.8.0-ab8ee">

<link rel="stylesheet" href="/css/mall/mobiscroll.scroller.css?v=3.8.0-ab8ee">
<link rel="stylesheet" href="/css/mall/mobiscroll.scroller.ios7.css?v=3.8.0-ab8ee">
<link rel="stylesheet" href="/css/mall/mobiscroll.animation.css?v=3.8.0-ab8ee">
</head>
<style type="text/css">
* {
	margin: 0;
	padding: 0;
}

html {
	color: #626262;
	overflow-y: auto;
	overflow-x: hidden;
}

body {
	margin-bottom: 20px;
	overflow-y: auto;
	overflow-x: hidden;
}

a {
	text-decoration: none;
}

ol,ul {
	list-style: outside none none;
}

.left {
	float: left;
}

.right {
	float: right;
}

.in-block {
	display: inline-block;
}

.orange {
	color: #c58d04;
}

.grey {
	color: #adadad;
}

.bg-color {
	background: #ececec;
}

#wrapper {
	width: 100%;
	margin: 0 auto;
}

.header {
	width: 100%;
}

.header ul {
	position:relative;
	overflow: hidden;
}

.header ul li {
	width: 50%;
	float: left;
	height: 2.8em;
	line-height: 2.8em;
	background: #fff;
	text-align: center;
	border-bottom:1px solid #f38b44;
	-moz-box-sizing:border-box; /* Firefox */
     -webkit-box-sizing:border-box; /* Safari */
     box-sizing:border-box;
}
.header ul .lines{
	position: absolute;
	width: 1%;
	height: 2.8em;
	line-height: 2.8em;
	border-right: 1px solid #FDE5D4;
	left: 49%;
	top: -1px;
 } 
.header ul li a {
	color: #8b898a;
}

.tab_content>div {
	height: auto;
	font-size: 0.8em;
	margin: 0.5em 0;
}

.empty-p {
	width: 80%;
	float: left;
	padding: 0.5em 0;
}

.has-p {
    width: 100%;
    margin: 0 auto;
    padding: 0 1em;
    height: auto;
    line-height: 2.5em;
    text-align: left;
    box-sizing: border-box;
    -webkit-box-sizing: border-box;
    -webkit-box-sizing: -webkit-border-box;
}
.has-p-one{
    background: url(/images/mall/contact.png) no-repeat left center;
    background-size: 12px 12px;
}
.has-p-two{
    background: url(/images/mall/take.png) no-repeat left 2px;
    background-size: 12px 12px;
}
.has-p-three{
    background: url(/images/mall/time.png) no-repeat left 2px;
    background-size: 12px 12px;
}
.input-right{
    position: relative;
}
.input-right-img{
    width: 1em;
    position: absolute;
    right: 0.6em;
    top: 0.3em;
}
#scheduledTime{
    width:11em;
    height: 2em;
    border:1px solid #a0a0a0;
    border-radius:4px;
    color:#a0a0a0;
    text-indent:.5em
}
.hiddens-p{
    text-overflow:ellipsis; 
    overflow:hidden; 
    white-space:nowrap;  
}

.right-dashed {
	border-left: 1px solid #eee;
	margin-top: 1em;
	padding-bottom:1em;
}

#edit {
	padding: 1em 0 1em 2em;
    width: 10px;
}

.header ul li.active{
    border-bottom: 4px solid #f38b44;
}
.header ul li.active a{
    color: #f38b44!important;
}
.buy_title{
	background:#f3f3f3;
	padding:0.3em 1em;
	margin: 0;
}
.content {
	width: 100%;
	background: #fff;
	overflow: hidden;	
	padding-bottom:8%;
}

.selectList {
	border-bottom: 1px solid #efefef;
	margin: 0 auto;
	overflow: hidden;
	padding: 0.5em 1em;
	font-size: 0.8em;
	clear:both;
}

.selectList img {
    display: inline-block;
    float: left;
    width: 25%;
    border-radius: 4px;
    -webkit-border-radius: 4px;
}

.button {
	display:block;	
	width: 99%;	
	height: 3em;
	color: #fff;
	border: none;
	border-radius: 4px;
	margin:0 auto 0.5em auto;
}

.addbtn {
	background: #33CC66;
}

.btn-wrap-5 {
	padding: 0 1em;
}
.buybtn {
	width: 100%;
	background: #f68d3c;
}

.footer {
	width: 100%;
	background: #fff;
	color: #b6b6b6;
	overflow: hidden;
	text-align: left;
	margin-bottom: 1em;
}

.all-end-button {
	width: 90%;
	margin: 1em auto 0.5em;
}

.all-end-button p:first-child {
	text-align: left;
}

.error-page{
	background: #ddd;
    padding-bottom: 2em;
}
.error-page img{
    margin:0 auto;
	padding-top: 2em;
}
.error-page p{
    text-align:center;
    color:#000;
    width:80%;
    margin:1em auto 2em;
}
#deliverFee{
	text-align:left;
	font-size:0.8em;
	color:#acb0af;
}
.order-div{
    margin-left: 26.8%;            
    position: relative;
}
.order-div>p:last-child{
    width: 100%;
    margin: 0;
    position: absolute;
    bottom: 0;
    left: 0;
}
.m-t-n{
    margin-top: 0;
}
.m-t-n>span{
    display: inline-block;
}
.m-t-n>span:first-child{
    width: 70%;
}
.m-t-n>span:last-child{
    width: 30%;
}
.mtn-span{
    float: right;
}
.t-r-span{
	text-align:right;
}
.ccc{
    color: #ccc;
}
.peisong{
    text-align: right;
    margin-bottom: 0;
    padding-right: 1em;
    padding-top: 0.4em;
}
.peisong-detail{
    color:#000;
}
.peisong-detail input{
    border: none;
}
.peisong-detail div>p{
    padding-left: 1.8em;
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    margin: 0;
    clear:both;
}

.weipay{            
    background: url(/images/weixin2.png) no-repeat left center;
    background-size:1.6em 1.4em; 
}        
.peisong-detail div>p.pay{
    background: url(/images/money2.png) no-repeat left center;
    background-size:1.6em 1.4em; 
}
.peisong-detail div>p.cardpay{
    background: url(/images/cardpay2.png) no-repeat left center;
    background-size:1.6em 1.4em; 
}
.peisong-detail div>p.mdpay{
    background: url(/images/mdpay2.png) no-repeat left center;
    background-size:1.6em 1.4em; 
}

.peisong-detail div[class^="btn-wrap-"] {
	border-bottom: 1px solid #dadada;
	padding: 0 1em;
	height: 3em;
	position: relative;
}

.weipay,.pay,.mdpay,.cardpay{
    position: relative;
}
 .weipay>img,.mdpay>img,.pay>img,.cardpay>img,.zhifu input{
    width: 1.2em;
    height: 1.2em;
    position: absolute;
    right: 0;
    top: 50%;
    transform:translateY(-50%);
}

.pure-img-check {
	background: url(/images/weixuan2.png) no-repeat left center;
    background-size:1.2em 1.2em; 
    float: right;
    height: 1.2em;
    width: 1.2em;
}

.zhifu input{
    display: none;
}
#deliverFeeDiv, #FetchDiv {
	border-bottom: 1px solid #efefef;
    padding: 0.5em 1em;
}
#deliverFeeDiv p, #FetchDiv p{
	text-align:right;
}

#remark {
	padding: 0.5em 1em;
	height: 4em;
	font-size: 1.0em;
}
</style>
<body>
	<div id="wrapper">
		
			
			
			
				
					
					
						
						
						
						
						
					
					
				
				
			
			<div class="header">
				
					<ul class="tab">
						<li class='active' data='#deliverFeeDiv'><a href="#tab1">快递发货</a></li>						
						<li class=''><a href="#tab2">到店自提</a></li>
						<span class="lines"></span>
					</ul>
				
			</div>
			<p class="buy_title"></p>
			
			<div class="tab_container">
				<div id="tab1" class="tab_content pure-g" style="">
					<div class="pure-u-24-24">
						
							
								<div class="has-p">
									<span>联系方式：</span>
									<span class="pure-u-3-5">17817738178<span>(17817738178)</span></span>
								</div>
								<div class="has-p">
									<span>配送地址：</span>
									<span class="pure-u-3-5">天津市县宁河县详细</span>
									<span style="float:right;">
										
											
											
											<a href="/toaddr/1?serial=10549840601068216320&fm=1&mallGoodsId=26838&amount=1&amounts=&cartIds=">
												<img src="/images/enter.png?v=3.8.0-ab8ee" class="pure-img" id="edit">
											</a>
											
										
									</span>
                                </div>
							
							
						
					</div>
				</div>
				<div id="tab2" class="tab_content pure-g" style="display:none">
					<div class="pure-u-24-24">
						
							
								<div class="has-p">
									<span>联系方式：</span>
									<span class="pure-u-3-5">452<span>(17817738178)</span></span>
								</div>
                                <div class="has-p">
                                	<span>门&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;店：</span>
                                	<span class="pure-u-3-5">
                                		广东省深圳市福田区
	                                	
	                                		Biu
	                                	
                                	</span>
									<span style="float:right;">
										
											
											
											<a href="/toaddr/2?serial=10549840601068216320&fm=1&mallGoodsId=26838&amount=1&amounts=&cartIds=">
												<img src="/images/enter.png?v=3.8.0-ab8ee" class="pure-img" id="edit">
											</a>
											
										
									</span>
                                </div>
                               	<div class="has-p">
                               		<span>到店时间：</span>
                               		<span class="input-right">
                               			<input type="text" id="scheduledTime" name="scheduledTime" class="text" placeholder="请选择"/><img src="/images/mall/input-right.png?v=3.8.0-ab8ee" class="input-right-img">
                               		</span>
                               	</div>
							
							
						
					</div>
				</div>
			</div>
			<p class="buy_title"></p>
			
			<div class="content">
				
					
						
							<div class="selectList">
								<img src="http://res.test.saofu.cn/saofu/upload/image/2016/07/18/352c9a44-5fe7-4546-9786-563d8700a773.jpg"> 
								
									
									
										<div class="order-div">
											<p class="m-t-n"><span>接口-测试商品1</span><span class="mtn-span t-r-span">￥0.01</span></p>
											<p><span class="ccc mtn-span">X1</span></p>
                                        </div>	
									
								
							</div>
						
					
					
					
				
				<div id="deliverFeeDiv">
					 
						
						
							<p id="deliverFee">含运费：￥0.01</p>
							<p class="orange">合计：￥0.02</p>
						
					 
				</div>
				<div id="FetchDiv" style="display: none;">
					<p class="orange">合计：￥0.01</p>
				</div>
				<div id="remark">
					<span class="beizhu" style="float:left">备注：</span>
                   	<span class="beizhulan">
                   		<textarea rows="3" placeholder="可于此处给卖家留言备注" style="border:0;width: 85%;"></textarea>
                   	</span>
				</div>
			</div>
			<p class="buy_title"></p>
			<div class="footer">
				<div class="peisong-detail zhifu">
                	
                        <div class="btn-wrap-1">
                         	<p class="weipay">微信支付<span class="pure-img-check"></span>
                             	<input type="radio" name="zhifu" value="1"/>
                         	</p>
                        </div>
                    
                  	
                  	
                        <div class="btn-wrap-2" style="">
                         	<p class="pay">货到付款<span class="pure-img-check"></span>
                             	<input type="radio" name="zhifu" value="3"/>
                         	</p>
                        </div>
                   	
		
                    
                        <div class="btn-wrap-3" style="display:none">
                        	<p class="mdpay">到店支付<span class="pure-img-check"></span>
                        		<input type="radio" name="zhifu" value="2"/>
                        	</p>
                        </div>
                   	
                   	
                   	
                        <div class="btn-wrap-4">
                       		<p class="cardpay">储值卡支付<span class="pure-img-check"></span>
                       			<input type="radio" name="zhifu" value="4"/>
                       		</p>
                        </div>
                   	
                </div>
			</div>
			<div class="btn-wrap-5">
				<input type="button" class="button buybtn submit" value="确认提交" />
			</div>
			
		
	</div>
	<script type="text/javascript" src="/js/zepto.min.js?v=3.8.0-ab8ee"></script>
	<script type="text/javascript" src="/js/touch.js?v=3.8.0-ab8ee"></script>
    
	<script type="text/javascript" src="/js/mall/zepto.alert.js?v=3.8.0-ab8ee"></script>
	<script type="text/javascript" src="/js/mall/mall.js?v=3.8.0-ab8ee"></script>
	<script type="text/javascript" src="/js/mall/mobiscroll.zepto.js?v=3.8.0-ab8ee" ></script>
	<script type="text/javascript" src="/js/mall/mobiscroll.core.js?v=3.8.0-ab8ee"></script>
	<script type="text/javascript" src="/js/mall/mobiscroll.scroller.js?v=3.8.0-ab8ee"></script>
	<script type="text/javascript" src="/js/mall/mobiscroll.datetime.js?v=3.8.0-ab8ee"></script>
	<script type="text/javascript" src="/js/mall/mobiscroll.i18n.zh.js?v=3.8.0-ab8ee"></script>
	<script type="text/javascript">
		$(function() {
			$("input[name='zhifu']:checked").prev('.pure-img').attr('src','/images/check.png');
			var tab = parseInt("1");
			/* if(tab == 1){
				$("#deliverFeeDiv").show();
				$("#FetchDiv").hide();
			} else if (tab == 0){
			    $("#deliverFeeDiv").hide();
				$("#FetchDiv").show();
			} else if(parseInt("1") != 0){
				$("#deliverFeeDiv").hide();
				$("#FetchDiv").show();
			} */
			
			if ("true" == "true" && 1 == 1) {
				$("#deliverFeeDiv").show();
				$("#FetchDiv").hide();
			} else {
				$("#deliverFeeDiv").hide();
				$("#FetchDiv").show();
			}
			
			// 控制显示图片比例
			var img_left_heights = $(".selectList img").width()*(0.75);
			$(".selectList img,.order-div").css('height',img_left_heights);
			
			// 取货日期
			var now = new Date();
            $('#scheduledTime').mobiscroll().datetime({
                minDate: new Date(now.getFullYear(), now.getMonth(), now.getDate(), now.getHours()+1),
                maxDate: new Date(now.getFullYear(), now.getMonth()+3, now.getDate()),
                stepMinute: 30,
                dateOrder :"yymmdd",
                dateFormat:"yy-mm-dd",
                timeWheels:"HHii",
                timeFormat:"HH:ii",
                //invalid: [{ start: '00:00', end: '08:00' },{ start: '22:00', end: '23:59' }],
                theme: 'ios7',
                lang: 'zh',
                display: 'bottom',
                mode: 'mixed'
            });
            $('#scheduledTime').click(function(){
                $('#scheduledTime').mobiscroll('show'); 
                return false;
            });
            
			$("ul li").click(function() {
				$("ul li").removeClass("active");
				$(this).addClass("active");
				if($(this).attr("data")=="#deliverFeeDiv"){
					$("#deliverFeeDiv").show();
					$("#FetchDiv").hide();
				}else{
					$("#deliverFeeDiv").hide();
					$("#FetchDiv").show();
				}
				$(".tab_content").hide();
				var href = $(this).find("a").attr("href");
				$(href).show();
				
				if(href.endWith("tab1")) {
					$(".btn-wrap-2").show();
					$(".btn-wrap-3").hide();
				} else if(href.endWith("tab2")) {
					$(".btn-wrap-2").hide();
					$(".btn-wrap-3").show();
				}
				//清空已选择的支付方式
				$("input[name='zhifu']").prop("checked", false);
				$(".zhifu .pure-img-check").css('background-image','url(/images/weixuan2.png)');
				return false;
			});
			//商户设置的满额包邮价
			/* var noDeliverFee = toPrice(parseFloat("")/100);
			var totalFee = parseFloat("0.01");
			if(totalFee > noDeliverFee){
				$("#deliverFeeDiv .orange").text("合计：￥"+ totalFee);
				$("#deliverFee").text("含运费：￥0.00");
			} */
			$('.zhifu>div').click(function(){
	            $("input[name=zhifu]").prop("checked", false);
	            $(".pure-img-check").css('backgroundImage','url(/images/weixuan2.png)');
	            var img_obj = $(this).find('.pure-img-check');
	            var backgroundImage = img_obj.css('background-image');
	            var input_obj = $(this).find('input');
	            if(backgroundImage.indexOf("weixuan2.png") > 0){
	                img_obj.css('background-image','url(/images/check.png)');
	                input_obj.prop("checked", "checked");
	            }else{
	                img_obj.css('background-image','url(/images/weixuan2.png)');
	                input_obj.prop("checked", false);
	            }
	        });
		});
		
		function validateRemark(){
			if($('.beizhulan textarea').val() != "" && $('.beizhulan textarea').val() != undefined){
				if($('.beizhulan textarea').val().length>30){
					$.dialog({
                        widths : '80%',
                        content : '您输入的备注过长，请不要超过30个字',
                        title : 'no',
                        fullok : function() {
                            return true;
                        },                       
                        lock : true
                    });	
					return false;
				}
				return true;
			}
			return true;
		}
		
		$(".submit").click(function(event){
			var payType = $("input[name='zhifu']:checked").val();
			if(null == payType || "" == payType || typeof(payType) == "undefined") {
       		 $.dialog({
                    widths : '80%',
                    content : '请选择支付方式',
                    title : 'no',
                    fullok : function() {
                        return true;
                    },                       
                    lock : true
                });
       			return;
       		}
			$.dialog({
                content : "确认提交订单？",
                title : "no",
                okText: '取消',
                cancelText : '确定', 
                ok : function() {
                	$(".ft-right").removeAttr("disabled");
                	return;
                },
                cancel : function() {                        	
               		
               		if(payType == 1){
               			if($(this).prop("disabled") == true)
                    		return false;
            			
            			var type = 0;
            			$(".tab_content").each(function(){
            				if($(this).css("display") != "none") {
            					var attrId = $(this).attr("id");
            					if(attrId == "tab1") {
            						type = 1;//快递取货
            					} else if(attrId == "tab2") {
            						type = 2;//门店自提
            					}
            				}
            			});
            			if(type <= 0) {
            				doAlert("no", "无效物流方式");
            				return;
            			}
            			if(type == 1) {
            				if($("#tab1 .pure-u-24-24 .empty-p").length > 0) {
            					$.dialog({
            	                    widths : '80%',
            	                    content : '请编辑收货地址',
            	                    title : 'no',
            	                    fullok : function() {
            	                        return true;
            	                    },                       
            	                    lock : true
            	                });
            					return;
            				}
            			}
            			var _fetchTime = "";
            			if(type == 2) {
            				if($("#tab2 .pure-u-24-24 .empty-p").length > 0) {
            					$.dialog({
            	                    widths : '80%',
            	                    content : '请编辑取货地址',
            	                    title : 'no',
            	                    fullok : function() {
            	                        return true;
            	                    },                       
            	                    lock : true
            	                });
            					return;
            				}
            				_fetchTime = $("#scheduledTime").val();
            				if(null == _fetchTime || "" == _fetchTime || typeof(_fetchTime) == undefined) {
            					$.dialog({
            	                    widths : '80%',
            	                    content : '请选择取货时间',
            	                    title : 'no',
            	                    fullok : function() {
            	                        return true;
            	                    },                       
            	                    lock : true
            	                });
            					return;
            				}
            				var shopBranch = "yunnex.saofu.shop.entity.ShopBranch@28d9d062";
            				if(shopBranch == "") {
            					$.dialog({
            	                    widths : '80%',
            	                    content : '请编辑取货地址',
            	                    title : 'no',
            	                    fullok : function() {
            	                        return true;
            	                    },                       
            	                    lock : true
            	                });
            					return;
            				}
            			}
            			
            			var _remark = encodeURI($(".beizhulan").find("textarea").val());
            			var params = {
            				serial : "10549840601068216320",
            				openId : "ous64uFCCLMyXYDJ-MkNilyCI5CY",
            				fm : "1",
            				mallGoodsId : "26838",
            				amount : "1",
            				cartIds : "",
            				fetchTime : _fetchTime,
            				remark : _remark
            			};
            			if(parseInt("1") == 1 && parseInt("1") == 2){
            				var standardId = "";
            				if(standardId != null && standardId != undefined){
            					params.standardId = standardId;
            				}
            			}
            			
            			if(validateRemark()){
            				var dialog = $.dialog({
            	                content:'订单提交中',
            	                backgrounds :'#000',
            	                opacitys :'0.7',
            	                widths:'50%',
            	                paddings:'0',
            	                warppadding:'2em 0',
            	                foottop:'0',
            	                lock : true
            	            });
            				$.post("/cmorder/" + type+ "/1", params, function(result){
            					dialog.close();
            					
            					if (!result.success) {
            						doAlert("no", result.message);
            						return;
            					}
            					
            					var strParams = "id=" + result.attach;
            	    			strParams += "&serial=10549840601068216320";
            	    			if(type == 2){
            						strParams += "&shopBranchId="+"1485916459";
            					}
            	    			window.location.href = "/pay/1?showwxpaytitle=1&" + strParams;
            	        	});
            			}
               		}
               		
    				if(payType == 2){
    					if($(this).prop("disabled") == true)
    		        		return false;
    					
    					var shopBranch = "yunnex.saofu.shop.entity.ShopBranch@28d9d062";
    					if(shopBranch == "") {
    						$.dialog({
        	                    widths : '80%',
        	                    content : '请编辑取货地址',
        	                    title : 'no',
        	                    fullok : function() {
        	                        return true;
        	                    },                       
        	                    lock : true
        	                });
    						return;
    					}
    					
    					if($("#tab2 .pure-u-24-24 .empty-p").length > 0) {
    						$.dialog({
        	                    widths : '80%',
        	                    content : '请编辑取货地址',
        	                    title : 'no',
        	                    fullok : function() {
        	                        return true;
        	                    },                       
        	                    lock : true
        	                });
    						return;
    					}
    					
    					var _fetchTime = $("#scheduledTime").val();
    					if(null == _fetchTime || "" == _fetchTime) {
    						$.dialog({
        	                    widths : '80%',
        	                    content : '请选择取货时间',
        	                    title : 'no',
        	                    fullok : function() {
        	                        return true;
        	                    },                       
        	                    lock : true
        	                });
    						return;
    					}
    					
    					if(validateRemark()){
    						var dialog = $.dialog({
    			                content:'订单提交中',
    			                backgrounds :'#000',
    			                opacitys :'0.7',
    			                widths:'50%',
    			                paddings:'0',
    			                warppadding:'2em 0',
    			                foottop:'0',
    			                lock : true
    			            });
    						
    						var _remark = $(".beizhulan").find("textarea").val();
    						var params = {
    							serial : "10549840601068216320",
    							openId : "ous64uFCCLMyXYDJ-MkNilyCI5CY",
    							fm : "1",
    							mallGoodsId : "26838",
    							amount : "1",
    							cartIds : "",
    							fetchTime : _fetchTime,
    							remark : _remark
    						};
    						if(parseInt("1") == 1 && parseInt("1") == 2){
    							var standardId = "";
    							if(standardId != null && standardId != undefined){
    								params.standardId = standardId;
    							}
    						}
    						$.post("/cmorder/2/2", params, function(result){
    							dialog.close();
    							if (!result.success) {
    								doAlert("no", result.message);
    								return;
    							}
    							window.location.href = "/mall/success/2?serial=10549840601068216320&ptype=" + 1;
    			        	});
    					}
    				}
    				
    				if(payType == 3){
    					if($(this).prop("disabled") == true)
    		        		return false;
    					
    					if($("#tab1 .pure-u-24-24 .empty-p").length > 0) {
    						$.dialog({
        	                    widths : '80%',
        	                    content : '请编辑收货地址',
        	                    title : 'no',
        	                    fullok : function() {
        	                        return true;
        	                    },                       
        	                    lock : true
        	                });
    						return;
    					}
    					
    					
    					if(validateRemark()){
    						var dialog = $.dialog({
    			                content:'订单提交中',
    			                backgrounds :'#000',
    			                opacitys :'0.7',
    			                widths:'50%',
    			                paddings:'0',
    			                warppadding:'2em 0',
    			                foottop:'0',
    			                lock : true
    			            });
    						var _remark = encodeURI($(".beizhulan").find("textarea").val());
    						var params = {
    							serial : "10549840601068216320",
    							openId : "ous64uFCCLMyXYDJ-MkNilyCI5CY",
    							fm : "1",
    							mallGoodsId : "26838",
    							amount : "1",
    							cartIds : "",
    							remark : _remark
    						};
    						if(parseInt("1") == 1 && parseInt("1") == 2){
    							var standardId = "";
    							if(standardId != null && standardId != undefined){
    								params.standardId = standardId;
    							}
    						}
    						$.post("/cmorder/1/3", params, function(result){
    							dialog.close();
    							if (!result.success) {
    								doAlert("no", result.message);
    								return;
    							}
    							window.location.href = "/mall/success/3?serial=10549840601068216320&ptype=" + 1;
    			        	});
    					}
    				}
    				
    				if(payType == 4){
    					if($(this).prop("disabled") == true)
                    		return false;
            			
            			var type = 0;
            			$(".tab_content").each(function(){
            				if($(this).css("display") != "none") {
            					var attrId = $(this).attr("id");
            					if(attrId == "tab1") {
            						type = 1;//快递取货
            					} else if(attrId == "tab2") {
            						type = 2;//门店自提
            					}
            				}
            			});
            			if(type <= 0) {
            				$.dialog({
        	                    widths : '80%',
        	                    content : '无效物流方式',
        	                    title : 'no',
        	                    fullok : function() {
        	                        return true;
        	                    },                       
        	                    lock : true
        	                });
            				return;
            			}
            			if(type == 1) {
            				if($("#tab1 .pure-u-24-24 .empty-p").length > 0) {
            					$.dialog({
            	                    widths : '80%',
            	                    content : '请编辑收货地址',
            	                    title : 'no',
            	                    fullok : function() {
            	                        return true;
            	                    },                       
            	                    lock : true
            	                });
            					return;
            				}
            			}
            			var _fetchTime = "";
            			if(type == 2) {
            				if($("#tab2 .pure-u-24-24 .empty-p").length > 0) {
            					$.dialog({
            	                    widths : '80%',
            	                    content : '请编辑取货地址',
            	                    title : 'no',
            	                    fullok : function() {
            	                        return true;
            	                    },                       
            	                    lock : true
            	                });
            					return;
            				}
            				_fetchTime = $("#scheduledTime").val();
            				if(null == _fetchTime || "" == _fetchTime || typeof(_fetchTime) == undefined) {
            					$.dialog({
            	                    widths : '80%',
            	                    content : '请选择取货时间',
            	                    title : 'no',
            	                    fullok : function() {
            	                        return true;
            	                    },                       
            	                    lock : true
            	                });
            					return;
            				}
            				var shopBranch = "yunnex.saofu.shop.entity.ShopBranch@28d9d062";
            				if(shopBranch == "") {
            					$.dialog({
            	                    widths : '80%',
            	                    content : '请编辑取货地址',
            	                    title : 'no',
            	                    fullok : function() {
            	                        return true;
            	                    },                       
            	                    lock : true
            	                });
            					return;
            				}
            			}
            			
            			var _remark = encodeURI($(".beizhulan").find("textarea").val());
            			var params = {
            				serial : "10549840601068216320",
            				openId : "ous64uFCCLMyXYDJ-MkNilyCI5CY",
            				fm : "1",
            				mallGoodsId : "26838",
            				amount : "1",
            				cartIds : "",
            				fetchTime : _fetchTime,
            				remark : _remark
            			};
            			if(parseInt("1") == 1 && parseInt("1") == 2){
            				var standardId = "";
            				if(standardId != null && standardId != undefined){
            					params.standardId = standardId;
            				}
            			}
            			
            			if(validateRemark()){
            				var dialog = $.dialog({
            	                content:'订单提交中',
            	                backgrounds :'#000',
            	                opacitys :'0.7',
            	                widths:'50%',
            	                paddings:'0',
            	                warppadding:'2em 0',
            	                foottop:'0',
            	                lock : true
            	            });
            				$.post("/cmorder/" + type+ "/4", params, function(result){
            					dialog.close();
            					
            					if (!result.success) {
            						doAlert("no", result.message);
            						return;
            					}
            					
            					var strParams = "?orderId=" + result.attach;
            					if(type == 2){
            						strParams += "&shopBranchId="+"1485916459";
            					}
            					strParams += "&serial=10549840601068216320";
                				window.location.href = "/pay/5"+strParams;
            	        	});
            			}
            			
    				}
    				
                },
                lock : true
            });
		});
		
		//微信支付
		/* $(".payUseWX").click(function(event) {
			if($(this).prop("disabled") == true)
        		return false;
			
			var type = 0;
			$(".tab_content").each(function(){
				if($(this).css("display") != "none") {
					var attrId = $(this).attr("id");
					if(attrId == "tab1") {
						type = 1;//快递取货
					} else if(attrId == "tab2") {
						type = 2;//门店自提
					}
				}
			});
			if(type <= 0) {
				doAlert("no", "无效物流方式");
				return;
			}
			if(type == 1) {
				if($("#tab1 .pure-u-4-5 .empty-p").length > 0) {
					doAlert("no", "请编辑收货地址");
					return;
				}
			}
			var _fetchTime = "";
			if(type == 2) {
				if($("#tab2 .pure-u-4-5 .empty-p").length > 0) {
					doAlert("no", "请编辑取货地址");
					return;
				}
				_fetchTime = $("#scheduledTime").val();
				if(null == _fetchTime || "" == _fetchTime || typeof(_fetchTime) == undefined) {
					doAlert("no", "请选择取货时间");
					return;
				}
				var shopBranch = "yunnex.saofu.shop.entity.ShopBranch@28d9d062";
				if(shopBranch == "") {
					doAlert("no", "请编辑取货地址");
					return;
				}
			}
			
			var _remark = encodeURI($(".beizhulan").find("textarea").val());
			var params = {
				serial : "10549840601068216320",
				openId : "ous64uFCCLMyXYDJ-MkNilyCI5CY",
				fm : "1",
				mallGoodsId : "26838",
				amount : "1",
				cartIds : "",
				fetchTime : _fetchTime,
				remark : _remark
			};
			if(parseInt("1") == 1 && parseInt("1") == 2){
				var standardId = "";
				if(standardId != null && standardId != undefined){
					params.standardId = standardId;
				}
			}
			
			if(validateRemark()){
				var dialog = $.dialog({
	                content:'订单提交中',
	                backgrounds :'#000',
	                opacitys :'0.7',
	                widths:'50%',
	                paddings:'0',
	                warppadding:'2em 0',
	                foottop:'0',
	                lock : true
	            });
				$.post("/cmorder/" + type+ "/1", params, function(result){
					dialog.close();
					
					if (!result.success) {
						doAlert("no", result.message);
						return;
					}
					
					var strParams = "id=" + result.attach;
	    			strParams += "&serial=10549840601068216320";
	    			window.location.href = "/pay/1?showwxpaytitle=1&" + strParams;
	        	});
			}
		}); */
		//货到付款
		/* $(".payAfrecv").click(function(event) {
			if($(this).prop("disabled") == true)
        		return false;
			
			if($("#tab1 .pure-u-4-5 .empty-p").length > 0) {
				doAlert("no", "请编辑收货地址");
				return;
			}
			
			
			if(validateRemark()){
				var dialog = $.dialog({
	                content:'订单提交中',
	                backgrounds :'#000',
	                opacitys :'0.7',
	                widths:'50%',
	                paddings:'0',
	                warppadding:'2em 0',
	                foottop:'0',
	                lock : true
	            });
				var _remark = encodeURI($(".beizhulan").find("textarea").val());
				var params = {
					serial : "10549840601068216320",
					openId : "ous64uFCCLMyXYDJ-MkNilyCI5CY",
					fm : "1",
					mallGoodsId : "26838",
					amount : "1",
					cartIds : "",
					remark : _remark
				};
				if(parseInt("1") == 1 && parseInt("1") == 2){
					var standardId = "";
					if(standardId != null && standardId != undefined){
						params.standardId = standardId;
					}
				}
				$.post("/cmorder/1/3", params, function(result){
					dialog.close();
					if (!result.success) {
						doAlert("no", result.message);
						return;
					}
					window.location.href = "/mall/success/3?serial=10549840601068216320&ptype=" + 1;
	        	});
			}
		}); */
		//到店支付
		// $(".payInshop").click(function(event) {
			/* if($(this).prop("disabled") == true)
        		return false;
			
			var shopBranch = "yunnex.saofu.shop.entity.ShopBranch@28d9d062";
			if(shopBranch == "") {
				doAlert("no", "请编辑取货地址");
				return;
			}
			
			if($("#tab2 .pure-u-4-5 .empty-p").length > 0) {
				doAlert("no", "请编辑取货地址");
				return;
			}
			
			var _fetchTime = $("#scheduledTime").val();
			if(null == _fetchTime || "" == _fetchTime) {
				doAlert("no", "请选择取货时间");
				return;
			}
			
			if(validateRemark()){
				var dialog = $.dialog({
	                content:'订单提交中',
	                backgrounds :'#000',
	                opacitys :'0.7',
	                widths:'50%',
	                paddings:'0',
	                warppadding:'2em 0',
	                foottop:'0',
	                lock : true
	            });
				
				var _remark = $(".beizhulan").find("textarea").val();
				var params = {
					serial : "10549840601068216320",
					openId : "ous64uFCCLMyXYDJ-MkNilyCI5CY",
					fm : "1",
					mallGoodsId : "26838",
					amount : "1",
					cartIds : "",
					fetchTime : _fetchTime,
					remark : _remark
				};
				if(parseInt("1") == 1 && parseInt("1") == 2){
					var standardId = "";
					if(standardId != null && standardId != undefined){
						params.standardId = standardId;
					}
				}
				$.post("/cmorder/2/2", params, function(result){
					dialog.close();
					if (!result.success) {
						doAlert("no", result.message);
						return;
					}
					window.location.href = "/mall/success/2?serial=10549840601068216320&ptype=" + 1;
	        	});
			} */
		// });
	</script>
</body>
</html>
<!--加入判断用户是否关注公众号功能 add by lipengfei at 2015-11-9  -->
  	
	<script type="text/javascript" src="/js/bind/banner.js?v=3.8.0-ab8ee"></script>
	<script type="text/javascript">
		$(function() {
			//var SHOP_SERIAL = getCookie("SHOP_SERIAL");
			var SHOP_SERIAL = "10549840601068216320";
			if(null != SHOP_SERIAL && SHOP_SERIAL != ""){
				$.ajax({
					url : '/saofu_mobile/checkUserBindStatus',
					data : {
						"serial" : SHOP_SERIAL
					},
					type : 'post',
					cache : false,
					dataType : 'json',
					success : function(data) {
						if (data != null) {
							var guildFocusStr = data.guildFocusStr;
							if(guildFocusStr != null && guildFocusStr == "1"){
								var hasBindedShop = data.hasBindedShop;
								if(hasBindedShop == "0"){
									var qrName = data.QRPublicName;
									var qrUrl = data.QRCodeURL;
									if(qrName != "" && qrUrl != ""){
										var params = qrName+"**"+qrUrl;
										followModule(params);
									}
								}
							}
						} 
					},
					error : function() {
					}
				});
			}
		});
				
	</script>

2016-11-30 12:11:30,503 InterfaceUnittestTestCase.py[line: 55] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:11:33 GMT'), ('Content-Type', 'text/html;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('Set-Cookie', 'JSESSIONID=840DD0F775AFE751B9479C3C0B78AFD3; Path=/; HttpOnly'), ('Content-Language', 'en-US')]
2016-11-30 12:11:30,503 InterfaceUnittestTestCase.py[line: 56] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:11:30,504 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为：到店支付
2016-11-30 12:11:30,504 unittesttestcase.py[line: 292] WARNING: 未检测到从服务器返回中提取内容的要求，请检查是否正确填写预期结果
2016-11-30 12:11:30,504 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:30,504 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="get", runtime="2016-11-30 12:11:30",step_action="{'方法': 'get', 'url': '/mall/tobuy/1?', '参数': {'mallGoodsId': '26838', 'type': 1, 'serial': '10549840601068216320', 'amount': 1}}", expected_results="{'条件': [{'消息': '无法打开商品详情', '模式': '到店支付'}], '检查': 'body', '匹配规则': '包含字符串'}" WHERE executed_history_id = 20161130121106 AND testcase_id = 102 AND step_id = 104 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:30,506 testcase.py[line: 163] INFO: 测试用例[id=102, name=test-n-点击立即购买按钮]执行成功
2016-11-30 12:11:30,506 testplan.py[line: 76] INFO: 正在更新用例执行结果
2016-11-30 12:11:30,506 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 12:11:30" WHERE executed_history_id = 20161130121106 AND testcase_id = 102 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:30,631 testplan.py[line: 87] INFO: 正在更新testlink上测试计划[testplan_id=74, bulid_version=v1.0.0],对应用例[testcase_id=102]的执行结果
2016-11-30 12:11:30,904 testplan.py[line: 45] INFO: 获取测试用例信息 [{'is_open': '1', 'steps': [{'id': '95', 'expected_results': '', 'actions': '<p>\n\t{<br />\n\t&quot;步骤类型&quot;:&quot;执行用例&quot;,</p>\n<p>\n\t&quot;用例id&quot;:88,</p>\n<p>\n\t&quot;用例名称&quot;:&quot;test-n-把商品加入购物车&quot;<br />\n\t}</p>\n<p>\n\t&nbsp;</p>\n', 'step_number': '1', 'active': '1', 'execution_type': '1'}, {'id': '96', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;匹配规则&quot;:&quot;键值相等&quot;,<br />\n\t&quot;条件&quot;:[{&quot;模式&quot;:{&quot;success&quot;:true}, &quot;消息&quot;:&quot;把商品移出购物车失败，success不为true&quot;}]</p>\n<p>\n\t}</p>\n', 'actions': '<p>\n\t{<br />\n\t&quot;方法&quot;:&quot;get&quot;,<br />\n\t&quot;url&quot;:&quot;/cart/delfromcart?&quot;,<br />\n\t&quot;参数&quot;:{&quot;strIds&quot;:&quot;[CaseStep.strIds]&quot;,&quot;serial&quot;:&quot;[global_serial]&quot;}<br />\n\t}</p>\n', 'step_number': '2', 'active': '1', 'execution_type': '1'}, {'id': '178', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;:&quot;包含字符串&quot;,</p>\n<p>\n\t&quot;条件&quot;:[{&quot;模式&quot;:&quot;[]&quot;,&quot;消息&quot;:&quot;把商品移出购物车中失败&quot;}]</p>\n<p>\n\t}</p>\n', 'actions': '<p>\n\t{<br />\n\t&quot;方法&quot;:&quot;get&quot;,<br />\n\t&quot;url&quot;:&quot;/cartlist?&quot;,<br />\n\t&quot;参数&quot;:{&quot;serial&quot;:&quot;[global_serial]&quot;,&quot;openId&quot;:&quot;[global_openId]&quot;}<br />\n\t}<br />\n\t&nbsp;</p>\n', 'step_number': '3', 'active': '1', 'execution_type': '1'}], 'id': '94', 'testsuite_id': '91', 'updater_id': '1', 'author_last_name': 'Administrator', 'active': '1', 'tc_external_id': '5', 'creation_ts': '2016-07-20 12:25:46', 'name': 'test-n-把商品移出购物车', 'updater_login': 'admin', 'execution_type': '1', 'author_id': '1', 'importance': '2', 'modification_ts': '2016-11-29 18:05:21', 'preconditions': '', 'updater_last_name': 'Administrator', 'version': '1', 'node_order': '1000', 'author_login': 'admin', 'updater_first_name': 'Testlink', 'author_first_name': 'Testlink', 'layout': '1', 'full_tc_external_id': 'wecharno-5', 'summary': '', 'estimated_exec_duration': '', 'testcase_id': '93', 'status': '1'}]
2016-11-30 12:11:31,029 testplan.py[line: 69] INFO: 记录测试用例到测试用例报表
2016-11-30 12:11:31,030 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 93, 'test-n-把商品移出购物车', '微商城-把商品移出购物车接口', 'plan1_of_wechatno', 'pj_wechatno', 'Block', '')
2016-11-30 12:11:31,031 testplan.py[line: 72] INFO: 开始执行测试用例[id=93，name=test-n-把商品移出购物车]
2016-11-30 12:11:31,032 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行用例","用例id":88,"用例名称":"test-n-把商品加入购物车"} 
2016-11-30 12:11:31,032 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：
2016-11-30 12:11:31,032 testcase.py[line: 50] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:31,032 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 93, 'test-n-把商品移出购物车', 'plan1_of_wechatno', 'pj_wechatno', 95, 1, '无', '无', '无', '无', '{"步骤类型":"执行用例","用例id":88,"用例名称":"test-n-把商品加入购物车"} ', '', 'Block', '', '')
2016-11-30 12:11:31,035 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 12:11:31,206 global_function.py[line: 23] INFO: 获取测试用例信息 [{'is_open': '1', 'steps': [{'id': '175', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;customer_id&quot;:1}</p>\n<p>\n\t}</p>\n', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT id FROM customer WHERE channel_serial=%s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;(\\&quot;[global_openId]\\&quot;,)&quot;</p>\n<p>\n\t}</p>\n', 'step_number': '1', 'active': '1', 'execution_type': '1'}, {'id': '174', 'expected_results': '', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;更新&quot;:&quot;UPDATE mall_shopping_cart SET amount = 0 WHERE customer_id = %s and closed=1&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;([CaseStep.customer_id],)&quot;</p>\n<p>\n\t}</p>\n', 'step_number': '2', 'active': '1', 'execution_type': '1'}, {'id': '90', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;匹配规则&quot;:&quot;键值相等&quot;,<br />\n\t&quot;条件&quot;:[{&quot;模式&quot;:{&quot;success&quot;:true}, &quot;消息&quot;:&quot;把商品加如购物车失败，success不为true&quot;}]</p>\n<p>\n\t}</p>\n', 'actions': '<p>\n\t{<br />\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/addtocart&quot;,<br />\n\t&quot;参数&quot;:{&quot;mallGoodsId&quot;:26838,&quot;standardId&quot;:&quot;undefined&quot;,&quot;amount&quot;:1,&quot;serial&quot;:&quot;[global_serial]&quot;,&quot;openId&quot;:&quot;[global_openId]&quot;}<br />\n\t}</p>\n', 'step_number': '3', 'active': '1', 'execution_type': '1'}, {'id': '176', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;strIds&quot;:1}<br />\n\t}</p>\n', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT id FROM mall_shopping_cart WHERE customer_id = %s and closed=%s ORDER BY id DESC LIMIT 1&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;([CaseStep.customer_id],1)&quot;</p>\n<p>\n\t}</p>\n', 'step_number': '4', 'active': '1', 'execution_type': '1'}, {'id': '177', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;:&quot;包含字符串&quot;,</p>\n<p>\n\t&quot;条件&quot;:[{&quot;模式&quot;:&quot;\\&quot;amount\\&quot;:1&quot;,&quot;消息&quot;:&quot;购物车中商品总数错误&quot;}, {&quot;模式&quot;:&quot;\\&quot;id\\&quot;:26838&quot;,&quot;消息&quot;:&quot;购物车中商品缺失&quot;}]</p>\n<p>\n\t}</p>\n', 'actions': '<p>\n\t{<br />\n\t&quot;方法&quot;:&quot;get&quot;,<br />\n\t&quot;url&quot;:&quot;/cartlist?&quot;,<br />\n\t&quot;参数&quot;:{&quot;serial&quot;:&quot;[global_serial]&quot;,&quot;openId&quot;:&quot;[global_openId]&quot;}<br />\n\t}<br />\n\t&nbsp;</p>\n', 'step_number': '5', 'active': '1', 'execution_type': '1'}], 'id': '89', 'testsuite_id': '87', 'updater_id': '1', 'author_last_name': 'Administrator', 'active': '1', 'tc_external_id': '4', 'creation_ts': '2016-07-20 12:07:40', 'name': 'test-n-把商品加入购物车', 'updater_login': 'admin', 'execution_type': '1', 'author_id': '1', 'importance': '2', 'modification_ts': '2016-11-29 17:58:09', 'preconditions': '', 'updater_last_name': 'Administrator', 'version': '1', 'node_order': '1000', 'author_login': 'admin', 'updater_first_name': 'Testlink', 'author_first_name': 'Testlink', 'layout': '1', 'full_tc_external_id': 'wecharno-4', 'summary': '', 'estimated_exec_duration': '', 'testcase_id': '88', 'status': '1'}]
2016-11-30 12:11:31,345 global_function.py[line: 43] INFO: 正在读取套件[id=87]的协议，host，端口配置...
2016-11-30 12:11:31,599 global_function.py[line: 72] INFO: 记录测试用例到测试用例报表
2016-11-30 12:11:31,599 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 88, 'test-n-把商品加入购物车', '把商品加入购物车接口', 'plan1_of_wechatno', 'pj_wechatno', 'Block', '')
2016-11-30 12:11:31,601 global_function.py[line: 75] INFO: 开始执行测试用例[id=88，name=test-n-把商品加入购物车]
2016-11-30 12:11:31,601 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行sql","单条查询":"SELECT id FROM customer WHERE channel_serial=%s","参数":"(\"[global_openId]\",)"}
2016-11-30 12:11:31,601 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","输出":{"customer_id":1}}
2016-11-30 12:11:31,601 testcase.py[line: 55] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:31,601 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 88, 'test-n-把商品加入购物车', 'plan1_of_wechatno', 'pj_wechatno', 175, 1, '', '', '192.168.9.211', '3306', '{"步骤类型":"执行sql","单条查询":"SELECT id FROM customer WHERE channel_serial=%s","参数":"(\\"[global_openId]\\",)"}', '{"检查":"body","输出":{"customer_id":1}}', 'Block', '', '')
2016-11-30 12:11:31,603 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 12:11:31,603 casestep.py[line: 129] INFO: 找到待替换的全局动态参数：[global_openId]
2016-11-30 12:11:31,603 casestep.py[line: 138] INFO: 转换后的参数体为：("ous64uFCCLMyXYDJ-MkNilyCI5CY",)
2016-11-30 12:11:31,603 mydb.py[line: 84] INFO: query：SELECT id FROM customer WHERE channel_serial=%s  data：('ous64uFCCLMyXYDJ-MkNilyCI5CY',)
2016-11-30 12:11:31,606 casestep.py[line: 190] INFO: 数据库服务器返回的查询结果为为 query_result:(167020,), flag:True
2016-11-30 12:11:31,606 casestep.py[line: 192] INFO: 正在保存服务器返回结果到自定义变量
2016-11-30 12:11:31,606 casestep.py[line: 227] INFO: 提取的输出结果(key-value对)为:[{'branch_id': 1485916418}, {'device_no': '182590014248006'}, {'serial_no': 'HZ501FZA0F9M07D'}, {'customer_id': 167020}, {'strIds': 18631}]
2016-11-30 12:11:31,606 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:31,606 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 12:11:31",step_action="{'参数': ('ous64uFCCLMyXYDJ-MkNilyCI5CY',), '步骤类型': '执行sql', '单条查询': 'SELECT id FROM customer WHERE channel_serial=%s'}", expected_results="{'检查': 'body', '输出': {'customer_id': 1}}" WHERE executed_history_id = 20161130121106 AND testcase_id = 88 AND step_id = 175 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:31,608 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行sql","更新":"UPDATE mall_shopping_cart SET amount = 0 WHERE customer_id = %s and closed=1","参数":"([CaseStep.customer_id],)"}
2016-11-30 12:11:31,608 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：
2016-11-30 12:11:31,609 testcase.py[line: 55] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:31,609 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 88, 'test-n-把商品加入购物车', 'plan1_of_wechatno', 'pj_wechatno', 174, 2, '', '', '192.168.9.211', '3306', '{"步骤类型":"执行sql","更新":"UPDATE mall_shopping_cart SET amount = 0 WHERE customer_id = %s and closed=1","参数":"([CaseStep.customer_id],)"}', '', 'Block', '', '')
2016-11-30 12:11:31,610 testcase.py[line: 77] INFO: 开始执行步骤操作[第2步]
2016-11-30 12:11:31,610 casestep.py[line: 115] INFO: 找到待替换的非全局动态参数：[CaseStep.customer_id]
2016-11-30 12:11:31,610 casestep.py[line: 138] INFO: 转换后的参数体为：(167020,)
2016-11-30 12:11:31,611 mydb.py[line: 70] INFO: query：UPDATE mall_shopping_cart SET amount = 0 WHERE customer_id = 167020 and closed=1
2016-11-30 12:11:31,895 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:31,895 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 12:11:31",step_action="{'参数': (167020,), '更新': 'UPDATE mall_shopping_cart SET amount = 0 WHERE customer_id = %s and closed=1', '步骤类型': '执行sql'}", expected_results="" WHERE executed_history_id = 20161130121106 AND testcase_id = 88 AND step_id = 174 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:31,899 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"方法":"post","url":"/addtocart","参数":{"mallGoodsId":26838,"standardId":"undefined","amount":1,"serial":"[global_serial]","openId":"[global_openId]"}}
2016-11-30 12:11:31,900 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"键值相等","条件":[{"模式":{"success":true}, "消息":"把商品加如购物车失败,success不为true"}]}
2016-11-30 12:11:31,900 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:31,900 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 88, 'test-n-把商品加入购物车', 'plan1_of_wechatno', 'pj_wechatno', 90, 3, '', 'http', 'm.test.saofu.cn', '80', '{"方法":"post","url":"/addtocart","参数":{"mallGoodsId":26838,"standardId":"undefined","amount":1,"serial":"[global_serial]","openId":"[global_openId]"}}', '{"检查":"body","匹配规则":"键值相等","条件":[{"模式":{"success":true}, "消息":"把商品加如购物车失败,success不为true"}]}', 'Block', '', '')
2016-11-30 12:11:31,901 testcase.py[line: 77] INFO: 开始执行步骤操作[第3步]
2016-11-30 12:11:31,901 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_urlencode
2016-11-30 12:11:31,902 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_openId]
2016-11-30 12:11:31,902 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_serial]
2016-11-30 12:11:31,902 casestep.py[line: 104] INFO: 转换后的参数体为：{'mallGoodsId': 26838, 'amount': 1, 'openId': 'ous64uFCCLMyXYDJ-MkNilyCI5CY', 'serial': '10549840601068216320', 'standardId': 'undefined'}
2016-11-30 12:11:31,902 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:11:31,902 InterfaceUnittestTestCase.py[line: 30] INFO: 正在发起POST请求...
2016-11-30 12:11:31,902 httpprotocol.py[line: 74] INFO: 发起的请求为：http://m.test.saofu.cn:80/addtocart
2016-11-30 12:11:31,902 httpprotocol.py[line: 75] INFO: 参数为：b'mallGoodsId=26838&amount=1&openId=ous64uFCCLMyXYDJ-MkNilyCI5CY&serial=10549840601068216320&standardId=undefined'
2016-11-30 12:11:31,902 httpprotocol.py[line: 76] INFO: 请求头为：{'Cookie': '10549840601068216320=ous64uFCCLMyXYDJ-MkNilyCI5CY'}
2016-11-30 12:11:32,290 InterfaceUnittestTestCase.py[line: 40] INFO: 正在对服务器返回body进行解码
2016-11-30 12:11:32,291 InterfaceUnittestTestCase.py[line: 54] INFO: 服务器返回结果"响应体(body)": {"success":true,"message":null,"attach":1}
2016-11-30 12:11:32,291 InterfaceUnittestTestCase.py[line: 55] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:11:35 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('Vary', 'Accept-Encoding')]
2016-11-30 12:11:32,291 InterfaceUnittestTestCase.py[line: 56] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:11:32,291 unittesttestcase.py[line: 106] INFO: 要匹配的字典key,value层级为：['success', True]
2016-11-30 12:11:32,292 unittesttestcase.py[line: 109] INFO: 找到的对应字典层级的最后值为：True
2016-11-30 12:11:32,292 unittesttestcase.py[line: 292] WARNING: 未检测到从服务器返回中提取内容的要求，请检查是否正确填写预期结果
2016-11-30 12:11:32,292 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:32,292 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="post", runtime="2016-11-30 12:11:31",step_action="{'方法': 'post', 'url': '/addtocart', '参数': {'mallGoodsId': 26838, 'amount': 1, 'openId': 'ous64uFCCLMyXYDJ-MkNilyCI5CY', 'serial': '10549840601068216320', 'standardId': 'undefined'}}", expected_results="{'条件': [{'消息': '把商品加如购物车失败,success不为true', '模式': {'success': True}}], '检查': 'body', '匹配规则': '键值相等'}" WHERE executed_history_id = 20161130121106 AND testcase_id = 88 AND step_id = 90 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:32,296 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行sql","单条查询":"SELECT id FROM mall_shopping_cart WHERE customer_id = %s and closed=%s ORDER BY id DESC LIMIT 1","参数":"([CaseStep.customer_id],1)"}
2016-11-30 12:11:32,296 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","输出":{"strIds":1}}
2016-11-30 12:11:32,297 testcase.py[line: 55] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:32,297 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 88, 'test-n-把商品加入购物车', 'plan1_of_wechatno', 'pj_wechatno', 176, 4, '', '', '192.168.9.211', '3306', '{"步骤类型":"执行sql","单条查询":"SELECT id FROM mall_shopping_cart WHERE customer_id = %s and closed=%s ORDER BY id DESC LIMIT 1","参数":"([CaseStep.customer_id],1)"}', '{"检查":"body","输出":{"strIds":1}}', 'Block', '', '')
2016-11-30 12:11:32,299 testcase.py[line: 77] INFO: 开始执行步骤操作[第4步]
2016-11-30 12:11:32,299 casestep.py[line: 115] INFO: 找到待替换的非全局动态参数：[CaseStep.customer_id]
2016-11-30 12:11:32,299 casestep.py[line: 138] INFO: 转换后的参数体为：(167020,1)
2016-11-30 12:11:32,299 mydb.py[line: 84] INFO: query：SELECT id FROM mall_shopping_cart WHERE customer_id = %s and closed=%s ORDER BY id DESC LIMIT 1  data：(167020, 1)
2016-11-30 12:11:32,303 casestep.py[line: 190] INFO: 数据库服务器返回的查询结果为为 query_result:(18631,), flag:True
2016-11-30 12:11:32,303 casestep.py[line: 192] INFO: 正在保存服务器返回结果到自定义变量
2016-11-30 12:11:32,303 casestep.py[line: 227] INFO: 提取的输出结果(key-value对)为:[{'branch_id': 1485916418}, {'device_no': '182590014248006'}, {'serial_no': 'HZ501FZA0F9M07D'}, {'customer_id': 167020}, {'strIds': 18631}]
2016-11-30 12:11:32,304 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:32,304 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 12:11:32",step_action="{'参数': (167020, 1), '步骤类型': '执行sql', '单条查询': 'SELECT id FROM mall_shopping_cart WHERE customer_id = %s and closed=%s ORDER BY id DESC LIMIT 1'}", expected_results="{'检查': 'body', '输出': {'strIds': 1}}" WHERE executed_history_id = 20161130121106 AND testcase_id = 88 AND step_id = 176 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:32,309 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"方法":"get","url":"/cartlist?","参数":{"serial":"[global_serial]","openId":"[global_openId]"}} 
2016-11-30 12:11:32,309 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"\"amount\":1","消息":"购物车中商品总数错误"}, {"模式":"\"id\":26838","消息":"购物车中商品缺失"}]}
2016-11-30 12:11:32,309 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:32,309 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 88, 'test-n-把商品加入购物车', 'plan1_of_wechatno', 'pj_wechatno', 177, 5, '', 'http', 'm.test.saofu.cn', '80', '{"方法":"get","url":"/cartlist?","参数":{"serial":"[global_serial]","openId":"[global_openId]"}} ', '{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"\\"amount\\":1","消息":"购物车中商品总数错误"}, {"模式":"\\"id\\":26838","消息":"购物车中商品缺失"}]}', 'Block', '', '')
2016-11-30 12:11:32,311 testcase.py[line: 77] INFO: 开始执行步骤操作[第5步]
2016-11-30 12:11:32,312 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_urlencode
2016-11-30 12:11:32,312 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_openId]
2016-11-30 12:11:32,312 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_serial]
2016-11-30 12:11:32,312 casestep.py[line: 104] INFO: 转换后的参数体为：{'openId': 'ous64uFCCLMyXYDJ-MkNilyCI5CY', 'serial': '10549840601068216320'}
2016-11-30 12:11:32,313 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:11:32,313 InterfaceUnittestTestCase.py[line: 35] INFO: 正在发起GET请求...
2016-11-30 12:11:32,313 httpprotocol.py[line: 56] INFO: 发起的请求为：http://m.test.saofu.cn:80/cartlist?openId=ous64uFCCLMyXYDJ-MkNilyCI5CY&serial=10549840601068216320
2016-11-30 12:11:32,313 httpprotocol.py[line: 57] INFO: 请求头为：{'Cookie': '10549840601068216320=ous64uFCCLMyXYDJ-MkNilyCI5CY'}
2016-11-30 12:11:32,380 InterfaceUnittestTestCase.py[line: 40] INFO: 正在对服务器返回body进行解码
2016-11-30 12:11:32,380 InterfaceUnittestTestCase.py[line: 54] INFO: 服务器返回结果"响应体(body)": [{"id":18631,"customer":null,"mallGoods":{"id":26838,"name":"接口-测试商品1","privateSerial":null,"price":1,"oriPrice":0,"description":"接口测试专用,烦请勿删,勿操作","iconUrl":"http://res.test.saofu.cn/saofu/upload/image/2016/07/18/352c9a44-5fe7-4546-9786-563d8700a773.jpg,","shop":null,"shopId":null,"mallGoodsCate":null,"servicePhone":null,"createTime":null,"expirTime":null,"cannotUseTime":null,"useTime":null,"preRemind":null,"rules":null,"detail":null,"status":1,"branch":null,"transientPrice":0.0,"transientOriPrice":0.0,"cateId":0,"cwId":null,"skuQuantity":null,"istop":0,"soldCount":0,"delFlag":null,"standard":1,"relType":null,"relBranchList":null,"mallGoodsStandards":null,"soldAllCount":0,"standardLowPrice":0.0,"standardTopPrice":0.0,"standardAllSku":null,"outerId":null,"rank":null,"mallGoodsCatagoryId":null,"business":null,"baiduSyncStatus":null,"meituanSyncStatus":null,"elemeSyncStatus":null,"dishCount":null,"lunchBoxCount":null,"isSku":0,"cateName":null,"waimaiChannel":null,"goodsCopyId":null,"syncStatus":0,"hasActivity":0,"orderNum":0,"mallGoodsMultistageStandards":null,"mallGoodsStandard":null,"theFirst":false,"theLast":false},"mallGoodsStandard":null,"amount":1,"shop":null,"shopBranchId":null,"closed":null,"cateringType":null}]
2016-11-30 12:11:32,380 InterfaceUnittestTestCase.py[line: 55] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:11:35 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('Vary', 'Accept-Encoding')]
2016-11-30 12:11:32,381 InterfaceUnittestTestCase.py[line: 56] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:11:32,381 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为："amount":1
2016-11-30 12:11:32,381 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为："id":26838
2016-11-30 12:11:32,381 unittesttestcase.py[line: 292] WARNING: 未检测到从服务器返回中提取内容的要求，请检查是否正确填写预期结果
2016-11-30 12:11:32,381 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:32,382 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="get", runtime="2016-11-30 12:11:32",step_action="{'方法': 'get', 'url': '/cartlist?', '参数': {'openId': 'ous64uFCCLMyXYDJ-MkNilyCI5CY', 'serial': '10549840601068216320'}}", expected_results="{'条件': [{'消息': '购物车中商品总数错误', '模式': ''amount':1'}, {'消息': '购物车中商品缺失', '模式': ''id':26838'}], '检查': 'body', '匹配规则': '包含字符串'}" WHERE executed_history_id = 20161130121106 AND testcase_id = 88 AND step_id = 177 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:32,385 testcase.py[line: 163] INFO: 测试用例[id=88, name=test-n-把商品加入购物车]执行成功
2016-11-30 12:11:32,386 global_function.py[line: 79] INFO: 正在更新用例执行结果
2016-11-30 12:11:32,386 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 12:11:31" WHERE executed_history_id = 20161130121106 and testcase_id = 88 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:32,389 global_function.py[line: 86] INFO: 指定用例[88]已执行完
2016-11-30 12:11:32,389 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:32,390 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 12:11:31",step_action="{'步骤类型': '执行用例', '用例id': 88, '用例名称': 'test-n-把商品加入购物车'}", expected_results="" WHERE executed_history_id = 20161130121106 AND testcase_id = 93 AND step_id = 95 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:32,394 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"方法":"get","url":"/cart/delfromcart?","参数":{"strIds":"[CaseStep.strIds]","serial":"[global_serial]"}}
2016-11-30 12:11:32,394 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"键值相等","条件":[{"模式":{"success":true}, "消息":"把商品移出购物车失败,success不为true"}]}
2016-11-30 12:11:32,394 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:32,395 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 93, 'test-n-把商品移出购物车', 'plan1_of_wechatno', 'pj_wechatno', 96, 2, '', 'http', 'm.test.saofu.cn', 80, '{"方法":"get","url":"/cart/delfromcart?","参数":{"strIds":"[CaseStep.strIds]","serial":"[global_serial]"}}', '{"检查":"body","匹配规则":"键值相等","条件":[{"模式":{"success":true}, "消息":"把商品移出购物车失败,success不为true"}]}', 'Block', '', '')
2016-11-30 12:11:32,397 testcase.py[line: 77] INFO: 开始执行步骤操作[第2步]
2016-11-30 12:11:32,397 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_urlencode
2016-11-30 12:11:32,397 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[CaseStep.strIds]
2016-11-30 12:11:32,397 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_serial]
2016-11-30 12:11:32,398 casestep.py[line: 104] INFO: 转换后的参数体为：{'strIds': 18631, 'serial': '10549840601068216320'}
2016-11-30 12:11:32,398 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:11:32,398 InterfaceUnittestTestCase.py[line: 35] INFO: 正在发起GET请求...
2016-11-30 12:11:32,398 httpprotocol.py[line: 56] INFO: 发起的请求为：http://m.test.saofu.cn:80/cart/delfromcart?strIds=18631&serial=10549840601068216320
2016-11-30 12:11:32,398 httpprotocol.py[line: 57] INFO: 请求头为：{'Cookie': '10549840601068216320=ous64uFCCLMyXYDJ-MkNilyCI5CY'}
2016-11-30 12:11:32,666 InterfaceUnittestTestCase.py[line: 40] INFO: 正在对服务器返回body进行解码
2016-11-30 12:11:32,666 InterfaceUnittestTestCase.py[line: 54] INFO: 服务器返回结果"响应体(body)": {"success":true,"message":null,"attach":null}
2016-11-30 12:11:32,667 InterfaceUnittestTestCase.py[line: 55] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:11:36 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('Vary', 'Accept-Encoding')]
2016-11-30 12:11:32,667 InterfaceUnittestTestCase.py[line: 56] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:11:32,667 unittesttestcase.py[line: 106] INFO: 要匹配的字典key,value层级为：['success', True]
2016-11-30 12:11:32,667 unittesttestcase.py[line: 109] INFO: 找到的对应字典层级的最后值为：True
2016-11-30 12:11:32,667 unittesttestcase.py[line: 292] WARNING: 未检测到从服务器返回中提取内容的要求，请检查是否正确填写预期结果
2016-11-30 12:11:32,668 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:32,668 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="get", runtime="2016-11-30 12:11:32",step_action="{'方法': 'get', 'url': '/cart/delfromcart?', '参数': {'strIds': 18631, 'serial': '10549840601068216320'}}", expected_results="{'条件': [{'消息': '把商品移出购物车失败,success不为true', '模式': {'success': True}}], '检查': 'body', '匹配规则': '键值相等'}" WHERE executed_history_id = 20161130121106 AND testcase_id = 93 AND step_id = 96 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:32,672 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"方法":"get","url":"/cartlist?","参数":{"serial":"[global_serial]","openId":"[global_openId]"}} 
2016-11-30 12:11:32,672 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"[]","消息":"把商品移出购物车中失败"}]}
2016-11-30 12:11:32,672 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:32,672 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 93, 'test-n-把商品移出购物车', 'plan1_of_wechatno', 'pj_wechatno', 178, 3, '', 'http', 'm.test.saofu.cn', 80, '{"方法":"get","url":"/cartlist?","参数":{"serial":"[global_serial]","openId":"[global_openId]"}} ', '{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"[]","消息":"把商品移出购物车中失败"}]}', 'Block', '', '')
2016-11-30 12:11:32,674 testcase.py[line: 77] INFO: 开始执行步骤操作[第3步]
2016-11-30 12:11:32,674 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_urlencode
2016-11-30 12:11:32,674 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_openId]
2016-11-30 12:11:32,674 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_serial]
2016-11-30 12:11:32,675 casestep.py[line: 104] INFO: 转换后的参数体为：{'openId': 'ous64uFCCLMyXYDJ-MkNilyCI5CY', 'serial': '10549840601068216320'}
2016-11-30 12:11:32,675 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:11:32,675 InterfaceUnittestTestCase.py[line: 35] INFO: 正在发起GET请求...
2016-11-30 12:11:32,675 httpprotocol.py[line: 56] INFO: 发起的请求为：http://m.test.saofu.cn:80/cartlist?openId=ous64uFCCLMyXYDJ-MkNilyCI5CY&serial=10549840601068216320
2016-11-30 12:11:32,675 httpprotocol.py[line: 57] INFO: 请求头为：{'Cookie': '10549840601068216320=ous64uFCCLMyXYDJ-MkNilyCI5CY'}
2016-11-30 12:11:32,719 InterfaceUnittestTestCase.py[line: 40] INFO: 正在对服务器返回body进行解码
2016-11-30 12:11:32,719 InterfaceUnittestTestCase.py[line: 54] INFO: 服务器返回结果"响应体(body)": []
2016-11-30 12:11:32,719 InterfaceUnittestTestCase.py[line: 55] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:11:36 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('Vary', 'Accept-Encoding')]
2016-11-30 12:11:32,719 InterfaceUnittestTestCase.py[line: 56] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:11:32,719 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为：[]
2016-11-30 12:11:32,719 unittesttestcase.py[line: 292] WARNING: 未检测到从服务器返回中提取内容的要求，请检查是否正确填写预期结果
2016-11-30 12:11:32,719 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:32,720 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="get", runtime="2016-11-30 12:11:32",step_action="{'方法': 'get', 'url': '/cartlist?', '参数': {'openId': 'ous64uFCCLMyXYDJ-MkNilyCI5CY', 'serial': '10549840601068216320'}}", expected_results="{'条件': [{'消息': '把商品移出购物车中失败', '模式': '[]'}], '检查': 'body', '匹配规则': '包含字符串'}" WHERE executed_history_id = 20161130121106 AND testcase_id = 93 AND step_id = 178 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:32,722 testcase.py[line: 163] INFO: 测试用例[id=93, name=test-n-把商品移出购物车]执行成功
2016-11-30 12:11:32,722 testplan.py[line: 76] INFO: 正在更新用例执行结果
2016-11-30 12:11:32,722 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 12:11:31" WHERE executed_history_id = 20161130121106 AND testcase_id = 93 AND project='pj_wechatno' AND testplan='plan1_of_wechatno'
2016-11-30 12:11:32,890 testplan.py[line: 87] INFO: 正在更新testlink上测试计划[testplan_id=74, bulid_version=v1.0.0],对应用例[testcase_id=93]的执行结果
2016-11-30 12:11:33,107 testplan.py[line: 97] INFO: 测试计划[project=pj_wechatno ,testplan=plan1_of_wechatno]已执行完
2016-11-30 12:11:33,379 main.py[line: 136] INFO: 正在读取测项目[id：145, project：pj_pos]的协议，host，端口配置...
2016-11-30 12:11:33,380 main.py[line: 139] INFO: 成功读取配置信息：{"protocol":"https","host":"saofu.client.test.saofu.cn","port":443}
2016-11-30 12:11:33,383 main.py[line: 155] INFO: 正在执行测试项目[id：145, project：pj_pos]
2016-11-30 12:11:33,383 testproject.py[line: 23] INFO: 正在获取测试项目[id：145, name：pj_pos]对应对应的测试计划名称列表
2016-11-30 12:11:33,602 testproject.py[line: 28] INFO: 成功获取项目测试计划名称列表[list=['plan1_of_pos']]
2016-11-30 12:11:33,775 testproject.py[line: 38] INFO: 正在执行项目测试计划[project：pj_pos，testplan：plan1_of_pos]
2016-11-30 12:11:33,775 testplan.py[line: 29] INFO: 正在获取测试计划[project=pj_pos，name=plan1_of_pos]的测试用例
2016-11-30 12:11:33,894 testplan.py[line: 35] INFO: 成功获取测试计划[project=pj_pos，name=plan1_of_pos]的测试用例id：dict_keys(['148', '152'])
2016-11-30 12:11:34,025 testplan.py[line: 45] INFO: 获取测试用例信息 [{'is_open': '1', 'steps': [{'id': '183', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;branch_id&quot;:1}<br />\n\t}</p>\n', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT branch_id FROM account_operator WHERE id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;(1318,)&quot;</p>\n<p>\n\t}</p>\n', 'step_number': '1', 'active': '1', 'execution_type': '1'}, {'id': '182', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;device_no&quot;:1,&quot;serial_no&quot;:2}<br />\n\t}</p>\n', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;([CaseStep.branch_id],)&quot;</p>\n<p>\n\t}</p>\n', 'step_number': '2', 'active': '1', 'execution_type': '1'}, {'id': '150', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;：&quot;键值相等&quot;,</p>\n<p>\n\t&quot;条件&quot;：[{&quot;模式&quot;：{&quot;success&quot;:true}, &quot;消息&quot;：&ldquo;登录失败，success不为true&rdquo;},{&quot;模式&quot;：｛&quot;message&quot;: &quot;成功&quot;},&quot;消息&quot;：&ldquo;message不为成功&rdquo;}，{&quot;模式&quot;：｛&quot;code&quot;: &quot;4001&quot;},&quot;消息&quot;：&ldquo;code不为4001&rdquo;}],</p>\n<p>\n\t&quot;输出&quot;:{&quot;Token&quot;:{&quot;token&quot;:&quot;value&quot;},&quot;OperatorId&quot;:{&quot;operator&quot;:{&quot;id&quot;:&quot;value&quot;}}}</p>\n<p>\n\t}</p>\n', 'actions': '<p>\n\t{&ldquo;函数&rdquo;：&ldquo;<span style="background-color:#e4e4ff;">test_interface_of_json</span>&rdquo;，</p>\n<p>\n\t&ldquo;请求头&rdquo;： {&quot;<span style="color:#008080;font-weight:bold;">DeviceId&quot;</span>:&quot;[CaseStep.device_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;SerialNo&quot;</span>:&quot;[CaseStep.serial_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;Content-Type&quot;</span>:&quot;<span style="color:#008080;font-weight:bold;">application/json;charset=utf-8&quot;</span>,<span style="color:#008080;font-weight:bold;">&quot;ProductVersion&quot;</span>: &quot;[global_product_version]&quot;, <span style="color:#008080;font-weight:bold;">&quot;ProtocolVersion&quot;</span>:&quot;[global_protocol_version]&quot;},</p>\n<p>\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/saofu-client/password/login&quot;,<br />\n\t&quot;参数&quot;:{&quot;id&quot;:&quot;1318&quot;,&quot;password&quot;:&quot;e10adc3949ba59abbe56e057f20f883e&quot;}<br />\n\t}</p>\n', 'step_number': '3', 'active': '1', 'execution_type': '1'}], 'id': '149', 'testsuite_id': '147', 'updater_id': '1', 'author_last_name': 'Administrator', 'active': '1', 'tc_external_id': '1', 'creation_ts': '2016-07-27 18:32:10', 'name': 'test-n-登陆掌贝pos机', 'updater_login': 'admin', 'execution_type': '1', 'author_id': '1', 'importance': '2', 'modification_ts': '2016-11-30 00:09:05', 'preconditions': '<p>\n\t{&quot;isglobal&quot;:1}</p>\n', 'updater_last_name': 'Administrator', 'version': '1', 'node_order': '1000', 'author_login': 'admin', 'updater_first_name': 'Testlink', 'author_first_name': 'Testlink', 'layout': '1', 'full_tc_external_id': 'pj_pos-1', 'summary': '', 'estimated_exec_duration': '', 'testcase_id': '148', 'status': '1'}]
2016-11-30 12:11:34,025 testplan.py[line: 52] INFO: 用例[id=148, name=test-n-登陆掌贝pos机]为全局初始化用例，已跳过执行
2016-11-30 12:11:34,152 testplan.py[line: 45] INFO: 获取测试用例信息 [{'is_open': '1', 'steps': [{'id': '154', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;:&quot;包含字符串&quot;,</p>\n<p>\n\t&quot;条件&quot;:[{&quot;模式&quot;:&quot;success\\&quot;:true&quot;, &quot;消息&quot;:&quot;修改积分失败&quot;}]</p>\n<p>\n\t}</p>\n', 'actions': '<p>\n\t<br />\n\t{&quot;函数&quot;：&quot;test_interface_of_json&quot;，</p>\n<p>\n\t&quot;请求头&quot;:{&quot;DeviceId&quot;:&quot;[CaseStep.device_no]&quot;, &quot;SerialNo&quot;:&quot;[CaseStep.serial_no]&quot;, &quot;Content-Type&quot;:&quot;application/json;charset=utf-8&quot;,&quot;ProductVersion&quot;:&quot;[global_product_version]&quot;,&quot;ProtocolVersion&quot;:&quot;[global_product_version]&quot;,&quot;OperatorId&quot;:&quot;[OperatorId]&quot;, &quot;Token&quot;:&quot;[Token]&quot;},</p>\n<p>\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/saofu-client/customer/customer_bonus_update_v3&quot;,<br />\n\t&quot;参数&quot;:{&quot;bonus&quot;:37593,&quot;code&quot;:&quot;17817738178&quot;}<br />\n\t}<br />\n\t&nbsp;</p>\n', 'step_number': '1', 'active': '1', 'execution_type': '1'}], 'id': '153', 'testsuite_id': '151', 'updater_id': '1', 'author_last_name': 'Administrator', 'active': '1', 'tc_external_id': '2', 'creation_ts': '2016-07-28 12:10:09', 'name': 'test-n-修改积分', 'updater_login': 'admin', 'execution_type': '1', 'author_id': '1', 'importance': '2', 'modification_ts': '2016-11-30 00:19:08', 'preconditions': '', 'updater_last_name': 'Administrator', 'version': '1', 'node_order': '1000', 'author_login': 'admin', 'updater_first_name': 'Testlink', 'author_first_name': 'Testlink', 'layout': '1', 'full_tc_external_id': 'pj_pos-2', 'summary': '', 'estimated_exec_duration': '', 'testcase_id': '152', 'status': '1'}]
2016-11-30 12:11:34,345 testplan.py[line: 69] INFO: 记录测试用例到测试用例报表
2016-11-30 12:11:34,346 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 152, 'test-n-修改积分', '扫码-修改积分接口', 'plan1_of_pos', 'pj_pos', 'Block', '')
2016-11-30 12:11:34,347 testplan.py[line: 72] INFO: 开始执行测试用例[id=152，name=test-n-修改积分]
2016-11-30 12:11:34,348 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"函数":"test_interface_of_json","请求头":{"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion":"[global_product_version]","ProtocolVersion":"[global_product_version]","OperatorId":"[OperatorId]", "Token":"[Token]"},"方法":"post","url":"/saofu-client/customer/customer_bonus_update_v3","参数":{"bonus":37593,"code":"17817738178"}} 
2016-11-30 12:11:34,348 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"success\":true", "消息":"修改积分失败"}]}
2016-11-30 12:11:34,348 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:11:34,348 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130121106', 152, 'test-n-修改积分', 'plan1_of_pos', 'pj_pos', 154, 1, '', 'https', 'saofu.client.test.saofu.cn', 443, '{"函数":"test_interface_of_json","请求头":{"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion":"[global_product_version]","ProtocolVersion":"[global_product_version]","OperatorId":"[OperatorId]", "Token":"[Token]"},"方法":"post","url":"/saofu-client/customer/customer_bonus_update_v3","参数":{"bonus":37593,"code":"17817738178"}} ', '{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"success\\":true", "消息":"修改积分失败"}]}', 'Block', '', '')
2016-11-30 12:11:34,350 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 12:11:34,350 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_json
2016-11-30 12:11:34,351 casestep.py[line: 104] INFO: 转换后的参数体为：{'bonus': 37593, 'code': '17817738178'}
2016-11-30 12:11:34,351 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:11:34,351 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[CaseStep.device_no]
2016-11-30 12:11:34,351 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_product_version]
2016-11-30 12:11:34,351 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_product_version]
2016-11-30 12:11:34,351 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[OperatorId]
2016-11-30 12:11:34,352 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[Token]
2016-11-30 12:11:34,352 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[CaseStep.serial_no]
2016-11-30 12:11:34,352 casestep.py[line: 104] INFO: 转换后的参数体为：{'DeviceId': '182590014248006', 'ProductVersion': '3.2.12C', 'ProtocolVersion': '3.2.12C', 'OperatorId': 1318, 'Token': '09e39fe9-0722-47f5-8480-b07661907830', 'Content-Type': 'application/json;charset=utf-8', 'SerialNo': 'HZ501FZA0F9M07D'}
2016-11-30 12:11:34,352 InterfaceUnittestTestCase.py[line: 88] INFO: 正在发起POST请求...
2016-11-30 12:11:34,352 httpprotocol.py[line: 74] INFO: 发起的请求为：https://saofu.client.test.saofu.cn:443/saofu-client/customer/customer_bonus_update_v3
2016-11-30 12:11:34,353 httpprotocol.py[line: 75] INFO: 参数为：b'{"bonus": 37593, "code": "17817738178"}'
2016-11-30 12:11:34,353 httpprotocol.py[line: 76] INFO: 请求头为：{'DeviceId': '182590014248006', 'ProductVersion': '3.2.12C', 'ProtocolVersion': '3.2.12C', 'OperatorId': 1318, 'Token': '09e39fe9-0722-47f5-8480-b07661907830', 'Content-Type': 'application/json;charset=utf-8', 'SerialNo': 'HZ501FZA0F9M07D'}
2016-11-30 12:11:34,755 InterfaceUnittestTestCase.py[line: 98] INFO: 正在对服务器返回body进行解码
2016-11-30 12:11:34,756 InterfaceUnittestTestCase.py[line: 112] INFO: 服务器返回结果"响应体(body)": {"bonus":37593,"code":"4001","success":true}
2016-11-30 12:11:34,756 InterfaceUnittestTestCase.py[line: 113] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:11:38 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('Vary', 'Accept-Encoding')]
2016-11-30 12:11:34,756 InterfaceUnittestTestCase.py[line: 114] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:11:34,757 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为：success":true
2016-11-30 12:11:34,757 unittesttestcase.py[line: 292] WARNING: 未检测到从服务器返回中提取内容的要求，请检查是否正确填写预期结果
2016-11-30 12:11:34,757 testcase.py[line: 160] INFO: 正在更新步骤执行结果
2016-11-30 12:11:34,757 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="post", runtime="2016-11-30 12:11:34",step_action="{'函数': 'test_interface_of_json', '方法': 'post', '参数': {'bonus': 37593, 'code': '17817738178'}, 'url': '/saofu-client/customer/customer_bonus_update_v3', '请求头': {'DeviceId': '182590014248006', 'ProductVersion': '3.2.12C', 'ProtocolVersion': '3.2.12C', 'OperatorId': 1318, 'Token': '09e39fe9-0722-47f5-8480-b07661907830', 'Content-Type': 'application/json;charset=utf-8', 'SerialNo': 'HZ501FZA0F9M07D'}}", expected_results="{'条件': [{'消息': '修改积分失败', '模式': 'success':true'}], '检查': 'body', '匹配规则': '包含字符串'}" WHERE executed_history_id = 20161130121106 AND testcase_id = 152 AND step_id = 154 AND project='pj_pos' AND testplan='plan1_of_pos'
2016-11-30 12:11:34,763 testcase.py[line: 163] INFO: 测试用例[id=152, name=test-n-修改积分]执行成功
2016-11-30 12:11:34,764 testplan.py[line: 76] INFO: 正在更新用例执行结果
2016-11-30 12:11:34,764 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 12:11:34" WHERE executed_history_id = 20161130121106 AND testcase_id = 152 AND project='pj_pos' AND testplan='plan1_of_pos'
2016-11-30 12:11:34,891 testplan.py[line: 87] INFO: 正在更新testlink上测试计划[testplan_id=146, bulid_version=v1.0.0],对应用例[testcase_id=152]的执行结果
2016-11-30 12:11:35,021 testplan.py[line: 97] INFO: 测试计划[project=pj_pos ,testplan=plan1_of_pos]已执行完
2016-11-30 12:11:35,021 main.py[line: 247] INFO: 接口测试已执行完成，正在关闭数据库连接
2016-11-30 12:11:35,022 htmlreporter.py[line: 37] INFO: 正在查询测试用例总数
2016-11-30 12:11:35,022 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE executed_history_id = %s  data：('20161130121106',)
2016-11-30 12:11:35,023 htmlreporter.py[line: 43] INFO: 正在查询执行通过的用例数
2016-11-30 12:11:35,023 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE runresult = %s AND executed_history_id = %s  data：('Pass', '20161130121106')
2016-11-30 12:11:35,024 htmlreporter.py[line: 49] INFO: 正在查询执行失败的用例数
2016-11-30 12:11:35,024 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE runresult = %s AND executed_history_id = %s  data：('Fail', '20161130121106')
2016-11-30 12:11:35,025 htmlreporter.py[line: 55] INFO: 正在查询执行出错的用例数
2016-11-30 12:11:35,026 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE runresult = %s AND executed_history_id = %s  data：('Error', '20161130121106')
2016-11-30 12:11:35,027 htmlreporter.py[line: 61] INFO: 正在查询未执行的用例数
2016-11-30 12:11:35,028 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE runresult = %s AND executed_history_id = %s  data：('Block', '20161130121106')
2016-11-30 12:11:35,029 htmlreporter.py[line: 72] INFO: 正在查询已运的测试计划
2016-11-30 12:11:35,029 mydb.py[line: 100] INFO: query：SELECT project, testplan FROM testcase_report_tb WHERE executed_history_id = %s GROUP BY project, testplan ORDER BY id ASC  data：('20161130121106',)
2016-11-30 12:11:35,030 htmlreporter.py[line: 98] INFO: 正在查询测试计划[project：pj_pos, testplan：无计划]的测试用例执行结果
2016-11-30 12:11:35,030 mydb.py[line: 100] INFO: query：SELECT id, executed_history_id, testcase_id, testcase_name,testsuit, testplan, project, runresult, runtime FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s GROUP BY testcase_id ORDER BY id ASC  data：('pj_pos', '无计划', '20161130121106')
2016-11-30 12:11:35,032 htmlreporter.py[line: 105] INFO: 正在记录测试测试计划[project：pj_pos, testplan：无计划]的测试用例运行结果到测试报告
2016-11-30 12:11:35,032 htmlreporter.py[line: 98] INFO: 正在查询测试计划[project：pj_wechatno, testplan：plan1_of_wechatno]的测试用例执行结果
2016-11-30 12:11:35,032 mydb.py[line: 100] INFO: query：SELECT id, executed_history_id, testcase_id, testcase_name,testsuit, testplan, project, runresult, runtime FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s GROUP BY testcase_id ORDER BY id ASC  data：('pj_wechatno', 'plan1_of_wechatno', '20161130121106')
2016-11-30 12:11:35,034 htmlreporter.py[line: 105] INFO: 正在记录测试测试计划[project：pj_wechatno, testplan：plan1_of_wechatno]的测试用例运行结果到测试报告
2016-11-30 12:11:35,035 htmlreporter.py[line: 98] INFO: 正在查询测试计划[project：pj_pos, testplan：plan1_of_pos]的测试用例执行结果
2016-11-30 12:11:35,035 mydb.py[line: 100] INFO: query：SELECT id, executed_history_id, testcase_id, testcase_name,testsuit, testplan, project, runresult, runtime FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s GROUP BY testcase_id ORDER BY id ASC  data：('pj_pos', 'plan1_of_pos', '20161130121106')
2016-11-30 12:11:35,037 htmlreporter.py[line: 105] INFO: 正在记录测试测试计划[project：pj_pos, testplan：plan1_of_pos]的测试用例运行结果到测试报告
2016-11-30 12:11:35,037 htmlreporter.py[line: 115] INFO: 正在查询已运的测试计划
2016-11-30 12:11:35,037 mydb.py[line: 100] INFO: query：SELECT project, testplan FROM testcase_report_tb WHERE executed_history_id = %s GROUP BY project, testplan ORDER BY id ASC  data：('20161130121106',)
2016-11-30 12:11:35,038 htmlreporter.py[line: 127] INFO: 正在查询测试计划[project：pj_pos, testplan：无计划]已运行的测试用例
2016-11-30 12:11:35,038 mydb.py[line: 100] INFO: query：SELECT testcase_id, testcase_name, project, testplan FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s  GROUP BY testcase_id ORDER BY id ASC  data：('pj_pos', '无计划', '20161130121106')
2016-11-30 12:11:35,040 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=148]步骤运行结果
2016-11-30 12:11:35,040 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_pos', '无计划', 148, '20161130121106')
2016-11-30 12:11:35,043 htmlreporter.py[line: 127] INFO: 正在查询测试计划[project：pj_wechatno, testplan：plan1_of_wechatno]已运行的测试用例
2016-11-30 12:11:35,043 mydb.py[line: 100] INFO: query：SELECT testcase_id, testcase_name, project, testplan FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s  GROUP BY testcase_id ORDER BY id ASC  data：('pj_wechatno', 'plan1_of_wechatno', '20161130121106')
2016-11-30 12:11:35,045 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=110]步骤运行结果
2016-11-30 12:11:35,046 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 110, '20161130121106')
2016-11-30 12:11:35,048 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=106]步骤运行结果
2016-11-30 12:11:35,048 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 106, '20161130121106')
2016-11-30 12:11:35,050 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=126]步骤运行结果
2016-11-30 12:11:35,050 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 126, '20161130121106')
2016-11-30 12:11:35,053 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=98]步骤运行结果
2016-11-30 12:11:35,053 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 98, '20161130121106')
2016-11-30 12:11:35,055 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=120]步骤运行结果
2016-11-30 12:11:35,056 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 120, '20161130121106')
2016-11-30 12:11:35,058 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=88]步骤运行结果
2016-11-30 12:11:35,058 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 88, '20161130121106')
2016-11-30 12:11:35,062 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=76]步骤运行结果
2016-11-30 12:11:35,062 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 76, '20161130121106')
2016-11-30 12:11:35,064 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=114]步骤运行结果
2016-11-30 12:11:35,064 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 114, '20161130121106')
2016-11-30 12:11:35,066 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=80]步骤运行结果
2016-11-30 12:11:35,066 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 80, '20161130121106')
2016-11-30 12:11:35,068 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=102]步骤运行结果
2016-11-30 12:11:35,068 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 102, '20161130121106')
2016-11-30 12:11:35,070 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=93]步骤运行结果
2016-11-30 12:11:35,070 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_wechatno', 'plan1_of_wechatno', 93, '20161130121106')
2016-11-30 12:11:35,072 htmlreporter.py[line: 127] INFO: 正在查询测试计划[project：pj_pos, testplan：plan1_of_pos]已运行的测试用例
2016-11-30 12:11:35,072 mydb.py[line: 100] INFO: query：SELECT testcase_id, testcase_name, project, testplan FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s  GROUP BY testcase_id ORDER BY id ASC  data：('pj_pos', 'plan1_of_pos', '20161130121106')
2016-11-30 12:11:35,074 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=152]步骤运行结果
2016-11-30 12:11:35,074 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_pos', 'plan1_of_pos', 152, '20161130121106')
2016-11-30 12:11:35,076 htmlreporter.py[line: 183] INFO: 正在设置测试报告结果文件名
2016-11-30 12:11:35,077 htmlreporter.py[line: 193] INFO: 测试报告文件名所在路径为：E:\\Projects\\report\\test_report20161130121106.html
2016-11-30 12:11:35,077 htmlreporter.py[line: 186] INFO: 正在生成测试报告
2016-11-30 12:11:35,080 main.py[line: 270] INFO: 生成测试报告成功
2016-11-30 12:11:35,254 main.py[line: 277] INFO: E:\\Projects\\report\\test_report20161130121106.html
2016-11-30 12:11:35,254 main.py[line: 280] INFO: 正在发送测试报告邮件...
2016-11-30 12:11:35,319 main.py[line: 284] INFO: 发送邮件成功
2016-11-30 12:16:13,649 global_var.py[line: 19] INFO: 当前运行环境：测试环境
2016-11-30 12:16:13,649 global_var.py[line: 20] INFO: 正在初始化数据库[名称：SAOFUDB1]对象
2016-11-30 12:16:13,660 global_var.py[line: 27] INFO: 正在初始化数据库[名称：TESTDB]对象
2016-11-30 12:16:13,665 global_var.py[line: 30] INFO: 正在获取testlink
2016-11-30 12:16:13,774 main.py[line: 63] INFO: 正在创建测试用例报告报表
2016-11-30 12:16:13,774 mydb.py[line: 43] INFO: query：CREATE TABLE IF NOT EXISTS testcase_report_tb                                         (id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,                                          executed_history_id varchar(50) NOT NULL,                                          testcase_id int NOT NULL,                                          testcase_name varchar(40) NOT NULL,                                          testsuit varchar(40),                                          testplan varchar(40),                                          project varchar(40),                                          runresult varchar(20),                                          runtime datetime)
2016-11-30 12:16:13,777 main.py[line: 66] INFO: 正在创建测试步骤报告报表
2016-11-30 12:16:13,778 mydb.py[line: 43] INFO: query：CREATE TABLE IF NOT EXISTS case_step_report_tb                                         (id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,                                          executed_history_id varchar(50) NOT NULL,                                          testcase_id int NOT NULL,                                          testcase_name varchar(40) NOT NULL,                                          testplan varchar(40) NOT NULL,                                          project varchar(40) NOT NULL,                                          step_id int,                                          step_num int NOT NULL,                                          step_action varchar(1000),                                           expected_results varchar(1000),                                          runresult varchar(10),                                          reason varchar(2000),                                          protocol_method varchar(40) ,                                          protocol varchar(40),                                          host varchar(40),                                          port int,                                          runtime datetime)
2016-11-30 12:16:13,780 main.py[line: 69] INFO: 正在读取运行模式配置
2016-11-30 12:16:13,784 main.py[line: 76] INFO: 正在运行全局初始化用例……
2016-11-30 12:16:13,785 main.py[line: 78] INFO: 待运行全局初始化用例id列表：[148]
2016-11-30 12:16:13,952 global_function.py[line: 23] INFO: 获取测试用例信息 [{'testcase_id': '148', 'layout': '1', 'id': '149', 'author_first_name': 'Testlink', 'tc_external_id': '1', 'node_order': '1000', 'status': '1', 'estimated_exec_duration': '', 'testsuite_id': '147', 'execution_type': '1', 'is_open': '1', 'importance': '2', 'author_login': 'admin', 'updater_last_name': 'Administrator', 'steps': [{'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;branch_id&quot;:1}<br />\n\t}</p>\n', 'step_number': '1', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT branch_id FROM account_operator WHERE id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;(1318,)&quot;</p>\n<p>\n\t}</p>\n', 'id': '183', 'execution_type': '1', 'active': '1'}, {'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;device_no&quot;:1,&quot;serial_no&quot;:2}<br />\n\t}</p>\n', 'step_number': '2', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;([CaseStep.branch_id],)&quot;</p>\n<p>\n\t}</p>\n', 'id': '182', 'execution_type': '1', 'active': '1'}, {'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;：&quot;键值相等&quot;,</p>\n<p>\n\t&quot;条件&quot;：[{&quot;模式&quot;：{&quot;success&quot;:true}, &quot;消息&quot;：&ldquo;登录失败，success不为true&rdquo;},{&quot;模式&quot;：｛&quot;message&quot;: &quot;成功&quot;},&quot;消息&quot;：&ldquo;message不为成功&rdquo;}，{&quot;模式&quot;：｛&quot;code&quot;: &quot;4001&quot;},&quot;消息&quot;：&ldquo;code不为4001&rdquo;}],</p>\n<p>\n\t&quot;输出&quot;:{&quot;Token&quot;:{&quot;token&quot;:&quot;value&quot;},&quot;OperatorId&quot;:{&quot;operator&quot;:{&quot;id&quot;:&quot;value&quot;}}}</p>\n<p>\n\t}</p>\n', 'step_number': '3', 'actions': '<p>\n\t{&ldquo;函数&rdquo;：&ldquo;<span style="background-color:#e4e4ff;">test_interface_of_json</span>&rdquo;，</p>\n<p>\n\t&ldquo;请求头&rdquo;： {&quot;<span style="color:#008080;font-weight:bold;">DeviceId&quot;</span>:&quot;[CaseStep.device_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;SerialNo&quot;</span>:&quot;[CaseStep.serial_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;Content-Type&quot;</span>:&quot;<span style="color:#008080;font-weight:bold;">application/json;charset=utf-8&quot;</span>,<span style="color:#008080;font-weight:bold;">&quot;ProductVersion&quot;</span>: &quot;[global_product_version]&quot;, <span style="color:#008080;font-weight:bold;">&quot;ProtocolVersion&quot;</span>:&quot;[global_protocol_version]&quot;},</p>\n<p>\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/saofu-client/password/login&quot;,<br />\n\t&quot;参数&quot;:{&quot;id&quot;:&quot;1318&quot;,&quot;password&quot;:&quot;e10adc3949ba59abbe56e057f20f883e&quot;}<br />\n\t}</p>\n', 'id': '150', 'execution_type': '1', 'active': '1'}], 'version': '1', 'active': '1', 'modification_ts': '2016-11-30 00:09:05', 'author_last_name': 'Administrator', 'full_tc_external_id': 'pj_pos-1', 'updater_id': '1', 'name': 'test-n-登陆掌贝pos机', 'updater_login': 'admin', 'author_id': '1', 'creation_ts': '2016-07-27 18:32:10', 'updater_first_name': 'Testlink', 'summary': '', 'preconditions': '<p>\n\t{&quot;isglobal&quot;:1}</p>\n'}]
2016-11-30 12:16:39,254 global_var.py[line: 19] INFO: 当前运行环境：测试环境
2016-11-30 12:16:39,255 global_var.py[line: 20] INFO: 正在初始化数据库[名称：SAOFUDB1]对象
2016-11-30 12:16:39,266 global_var.py[line: 27] INFO: 正在初始化数据库[名称：TESTDB]对象
2016-11-30 12:16:39,271 global_var.py[line: 30] INFO: 正在获取testlink
2016-11-30 12:16:39,375 main.py[line: 63] INFO: 正在创建测试用例报告报表
2016-11-30 12:16:39,376 mydb.py[line: 43] INFO: query：CREATE TABLE IF NOT EXISTS testcase_report_tb                                         (id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,                                          executed_history_id varchar(50) NOT NULL,                                          testcase_id int NOT NULL,                                          testcase_name varchar(40) NOT NULL,                                          testsuit varchar(40),                                          testplan varchar(40),                                          project varchar(40),                                          runresult varchar(20),                                          runtime datetime)
2016-11-30 12:16:39,377 main.py[line: 66] INFO: 正在创建测试步骤报告报表
2016-11-30 12:16:39,378 mydb.py[line: 43] INFO: query：CREATE TABLE IF NOT EXISTS case_step_report_tb                                         (id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,                                          executed_history_id varchar(50) NOT NULL,                                          testcase_id int NOT NULL,                                          testcase_name varchar(40) NOT NULL,                                          testplan varchar(40) NOT NULL,                                          project varchar(40) NOT NULL,                                          step_id int,                                          step_num int NOT NULL,                                          step_action varchar(1000),                                           expected_results varchar(1000),                                          runresult varchar(10),                                          reason varchar(2000),                                          protocol_method varchar(40) ,                                          protocol varchar(40),                                          host varchar(40),                                          port int,                                          runtime datetime)
2016-11-30 12:16:39,380 main.py[line: 69] INFO: 正在读取运行模式配置
2016-11-30 12:16:39,384 main.py[line: 76] INFO: 正在运行全局初始化用例……
2016-11-30 12:16:39,385 main.py[line: 78] INFO: 待运行全局初始化用例id列表：[148]
2016-11-30 12:16:39,564 global_function.py[line: 23] INFO: 获取测试用例信息 [{'summary': '', 'testsuite_id': '147', 'updater_first_name': 'Testlink', 'author_id': '1', 'updater_id': '1', 'modification_ts': '2016-11-30 00:09:05', 'full_tc_external_id': 'pj_pos-1', 'author_last_name': 'Administrator', 'layout': '1', 'tc_external_id': '1', 'version': '1', 'active': '1', 'testcase_id': '148', 'author_first_name': 'Testlink', 'preconditions': '<p>\n\t{&quot;isglobal&quot;:1}</p>\n', 'importance': '2', 'execution_type': '1', 'node_order': '1000', 'updater_login': 'admin', 'creation_ts': '2016-07-27 18:32:10', 'id': '149', 'steps': [{'execution_type': '1', 'id': '183', 'active': '1', 'step_number': '1', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;branch_id&quot;:1}<br />\n\t}</p>\n', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT branch_id FROM account_operator WHERE id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;(1318,)&quot;</p>\n<p>\n\t}</p>\n'}, {'execution_type': '1', 'id': '182', 'active': '1', 'step_number': '2', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;device_no&quot;:1,&quot;serial_no&quot;:2}<br />\n\t}</p>\n', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;([CaseStep.branch_id],)&quot;</p>\n<p>\n\t}</p>\n'}, {'execution_type': '1', 'id': '150', 'active': '1', 'step_number': '3', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;：&quot;键值相等&quot;,</p>\n<p>\n\t&quot;条件&quot;：[{&quot;模式&quot;：{&quot;success&quot;:true}, &quot;消息&quot;：&ldquo;登录失败，success不为true&rdquo;},{&quot;模式&quot;：｛&quot;message&quot;: &quot;成功&quot;},&quot;消息&quot;：&ldquo;message不为成功&rdquo;}，{&quot;模式&quot;：｛&quot;code&quot;: &quot;4001&quot;},&quot;消息&quot;：&ldquo;code不为4001&rdquo;}],</p>\n<p>\n\t&quot;输出&quot;:{&quot;Token&quot;:{&quot;token&quot;:&quot;value&quot;},&quot;OperatorId&quot;:{&quot;operator&quot;:{&quot;id&quot;:&quot;value&quot;}}}</p>\n<p>\n\t}</p>\n', 'actions': '<p>\n\t{&ldquo;函数&rdquo;：&ldquo;<span style="background-color:#e4e4ff;">test_interface_of_json</span>&rdquo;，</p>\n<p>\n\t&ldquo;请求头&rdquo;： {&quot;<span style="color:#008080;font-weight:bold;">DeviceId&quot;</span>:&quot;[CaseStep.device_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;SerialNo&quot;</span>:&quot;[CaseStep.serial_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;Content-Type&quot;</span>:&quot;<span style="color:#008080;font-weight:bold;">application/json;charset=utf-8&quot;</span>,<span style="color:#008080;font-weight:bold;">&quot;ProductVersion&quot;</span>: &quot;[global_product_version]&quot;, <span style="color:#008080;font-weight:bold;">&quot;ProtocolVersion&quot;</span>:&quot;[global_protocol_version]&quot;},</p>\n<p>\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/saofu-client/password/login&quot;,<br />\n\t&quot;参数&quot;:{&quot;id&quot;:&quot;1318&quot;,&quot;password&quot;:&quot;e10adc3949ba59abbe56e057f20f883e&quot;}<br />\n\t}</p>\n'}], 'updater_last_name': 'Administrator', 'name': 'test-n-登陆掌贝pos机', 'estimated_exec_duration': '', 'status': '1', 'author_login': 'admin', 'is_open': '1'}]
2016-11-30 12:23:44,447 global_var.py[line: 19] INFO: 当前运行环境：测试环境
2016-11-30 12:23:44,447 global_var.py[line: 20] INFO: 正在初始化数据库[名称：SAOFUDB1]对象
2016-11-30 12:23:44,475 global_var.py[line: 27] INFO: 正在初始化数据库[名称：TESTDB]对象
2016-11-30 12:23:44,478 global_var.py[line: 30] INFO: 正在获取testlink
2016-11-30 12:23:44,549 main.py[line: 63] INFO: 正在创建测试用例报告报表
2016-11-30 12:23:44,549 mydb.py[line: 43] INFO: query：CREATE TABLE IF NOT EXISTS testcase_report_tb                                         (id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,                                          executed_history_id varchar(50) NOT NULL,                                          testcase_id int NOT NULL,                                          testcase_name varchar(40) NOT NULL,                                          testsuit varchar(40),                                          testplan varchar(40),                                          project varchar(40),                                          runresult varchar(20),                                          runtime datetime)
2016-11-30 12:23:44,551 main.py[line: 66] INFO: 正在创建测试步骤报告报表
2016-11-30 12:23:44,551 mydb.py[line: 43] INFO: query：CREATE TABLE IF NOT EXISTS case_step_report_tb                                         (id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,                                          executed_history_id varchar(50) NOT NULL,                                          testcase_id int NOT NULL,                                          testcase_name varchar(40) NOT NULL,                                          testplan varchar(40) NOT NULL,                                          project varchar(40) NOT NULL,                                          step_id int,                                          step_num int NOT NULL,                                          step_action varchar(1000),                                           expected_results varchar(1000),                                          runresult varchar(10),                                          reason varchar(2000),                                          protocol_method varchar(40) ,                                          protocol varchar(40),                                          host varchar(40),                                          port int,                                          runtime datetime)
2016-11-30 12:23:44,553 main.py[line: 69] INFO: 正在读取运行模式配置
2016-11-30 12:23:44,555 main.py[line: 76] INFO: 正在运行全局初始化用例……
2016-11-30 12:23:44,555 main.py[line: 78] INFO: 待运行全局初始化用例id列表：[148]
2016-11-30 12:23:44,802 global_function.py[line: 23] INFO: 获取测试用例信息 [{'author_first_name': 'Testlink', 'estimated_exec_duration': '', 'status': '1', 'full_tc_external_id': 'pj_pos-1', 'preconditions': '<p>\n\t{&quot;isglobal&quot;:1}</p>\n', 'active': '1', 'author_id': '1', 'id': '149', 'author_login': 'admin', 'tc_external_id': '1', 'importance': '2', 'updater_login': 'admin', 'author_last_name': 'Administrator', 'node_order': '1000', 'creation_ts': '2016-07-27 18:32:10', 'updater_id': '1', 'updater_first_name': 'Testlink', 'name': 'test-n-登陆掌贝pos机', 'summary': '', 'layout': '1', 'testcase_id': '148', 'testsuite_id': '147', 'steps': [{'id': '183', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT branch_id FROM account_operator WHERE id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;(1318,)&quot;</p>\n<p>\n\t}</p>\n', 'step_number': '1', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;branch_id&quot;:1}<br />\n\t}</p>\n', 'active': '1', 'execution_type': '1'}, {'id': '182', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;([CaseStep.branch_id],)&quot;</p>\n<p>\n\t}</p>\n', 'step_number': '2', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;device_no&quot;:1,&quot;serial_no&quot;:2}<br />\n\t}</p>\n', 'active': '1', 'execution_type': '1'}, {'id': '150', 'actions': '<p>\n\t{&ldquo;函数&rdquo;：&ldquo;<span style="background-color:#e4e4ff;">test_interface_of_json</span>&rdquo;，</p>\n<p>\n\t&ldquo;请求头&rdquo;： {&quot;<span style="color:#008080;font-weight:bold;">DeviceId&quot;</span>:&quot;[CaseStep.device_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;SerialNo&quot;</span>:&quot;[CaseStep.serial_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;Content-Type&quot;</span>:&quot;<span style="color:#008080;font-weight:bold;">application/json;charset=utf-8&quot;</span>,<span style="color:#008080;font-weight:bold;">&quot;ProductVersion&quot;</span>: &quot;[global_product_version]&quot;, <span style="color:#008080;font-weight:bold;">&quot;ProtocolVersion&quot;</span>:&quot;[global_protocol_version]&quot;},</p>\n<p>\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/saofu-client/password/login&quot;,<br />\n\t&quot;参数&quot;:{&quot;id&quot;:&quot;1318&quot;,&quot;password&quot;:&quot;e10adc3949ba59abbe56e057f20f883e&quot;}<br />\n\t}</p>\n', 'step_number': '3', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;：&quot;键值相等&quot;,</p>\n<p>\n\t&quot;条件&quot;：[{&quot;模式&quot;：{&quot;success&quot;:true}, &quot;消息&quot;：&ldquo;登录失败，success不为true&rdquo;},{&quot;模式&quot;：｛&quot;message&quot;: &quot;成功&quot;},&quot;消息&quot;：&ldquo;message不为成功&rdquo;}，{&quot;模式&quot;：｛&quot;code&quot;: &quot;4001&quot;},&quot;消息&quot;：&ldquo;code不为4001&rdquo;}],</p>\n<p>\n\t&quot;输出&quot;:{&quot;Token&quot;:{&quot;token&quot;:&quot;value&quot;},&quot;OperatorId&quot;:{&quot;operator&quot;:{&quot;id&quot;:&quot;value&quot;}}}</p>\n<p>\n\t}</p>\n', 'active': '1', 'execution_type': '1'}], 'version': '1', 'updater_last_name': 'Administrator', 'is_open': '1', 'modification_ts': '2016-11-30 00:09:05', 'execution_type': '1'}]
2016-11-30 12:23:44,945 global_function.py[line: 43] INFO: 正在读取套件[id=147]的协议，host，端口配置...
2016-11-30 12:23:45,648 global_function.py[line: 72] INFO: 记录测试用例到测试用例报表
2016-11-30 12:23:45,648 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130122344', 148, 'test-n-登陆掌贝pos机', '登陆接口', '无计划', 'pj_pos', 'Block', '')
2016-11-30 12:23:45,649 global_function.py[line: 75] INFO: 开始执行测试用例[id=148，name=test-n-登陆掌贝pos机]
2016-11-30 12:23:45,649 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行sql","单条查询":"SELECT branch_id FROM account_operator WHERE id = %s","参数":"(1318,)"}
2016-11-30 12:23:45,649 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","输出":{"branch_id":1}}
2016-11-30 12:23:45,649 testcase.py[line: 55] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:23:45,650 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130122344', 148, 'test-n-登陆掌贝pos机', '无计划', 'pj_pos', 183, 1, '', '', '192.168.9.211', '3306', '{"步骤类型":"执行sql","单条查询":"SELECT branch_id FROM account_operator WHERE id = %s","参数":"(1318,)"}', '{"检查":"body","输出":{"branch_id":1}}', 'Block', '', '')
2016-11-30 12:23:45,651 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 12:23:45,651 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:23:45,651 mydb.py[line: 84] INFO: query：SELECT branch_id FROM account_operator WHERE id = %s  data：(1318,)
2016-11-30 12:23:45,666 casestep.py[line: 190] INFO: 数据库服务器返回的查询结果为为 query_result:(1485916418,), flag:True
2016-11-30 12:23:45,666 casestep.py[line: 192] INFO: 正在保存服务器返回结果到自定义变量
2016-11-30 12:23:45,666 casestep.py[line: 227] INFO: 提取的输出结果(key-value对)为:[{'branch_id': 1485916418}]
2016-11-30 12:23:45,667 testcase.py[line: 155] INFO: 正在更新步骤执行结果
2016-11-30 12:23:45,667 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 12:23:45",step_action="{'步骤类型': '执行sql', '单条查询': 'SELECT branch_id FROM account_operator WHERE id = %s', '参数': (1318,)}", expected_results="{'输出': {'branch_id': 1}, '检查': 'body'}" WHERE executed_history_id = 20161130122344 AND testcase_id = 148 AND step_id = 183 AND project='pj_pos' AND testplan='无计划'
2016-11-30 12:23:45,670 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行sql","单条查询":"SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s","参数":"([CaseStep.branch_id],)"}
2016-11-30 12:23:45,670 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","输出":{"device_no":1,"serial_no":2}}
2016-11-30 12:23:45,670 testcase.py[line: 55] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:23:45,671 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130122344', 148, 'test-n-登陆掌贝pos机', '无计划', 'pj_pos', 182, 2, '', '', '192.168.9.211', '3306', '{"步骤类型":"执行sql","单条查询":"SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s","参数":"([CaseStep.branch_id],)"}', '{"检查":"body","输出":{"device_no":1,"serial_no":2}}', 'Block', '', '')
2016-11-30 12:23:45,672 testcase.py[line: 77] INFO: 开始执行步骤操作[第2步]
2016-11-30 12:23:45,673 casestep.py[line: 115] INFO: 找到待替换的非全局动态参数：[CaseStep.branch_id]
2016-11-30 12:23:45,673 casestep.py[line: 138] INFO: 转换后的参数体为：(1485916418,)
2016-11-30 12:23:45,673 mydb.py[line: 84] INFO: query：SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s  data：(1485916418,)
2016-11-30 12:23:45,689 casestep.py[line: 190] INFO: 数据库服务器返回的查询结果为为 query_result:('182590014248006', 'HZ501FZA0F9M07D'), flag:True
2016-11-30 12:23:45,689 casestep.py[line: 192] INFO: 正在保存服务器返回结果到自定义变量
2016-11-30 12:23:45,690 casestep.py[line: 227] INFO: 提取的输出结果(key-value对)为:[{'branch_id': 1485916418}, {'device_no': '182590014248006'}, {'serial_no': 'HZ501FZA0F9M07D'}]
2016-11-30 12:23:45,690 testcase.py[line: 155] INFO: 正在更新步骤执行结果
2016-11-30 12:23:45,690 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 12:23:45",step_action="{'步骤类型': '执行sql', '单条查询': 'SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s', '参数': (1485916418,)}", expected_results="{'输出': {'device_no': 1, 'serial_no': 2}, '检查': 'body'}" WHERE executed_history_id = 20161130122344 AND testcase_id = 148 AND step_id = 182 AND project='pj_pos' AND testplan='无计划'
2016-11-30 12:23:45,692 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"函数":"test_interface_of_json","请求头": {"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion": "[global_product_version]", "ProtocolVersion":"[global_protocol_version]"},"方法":"post","url":"/saofu-client/password/login","参数":{"id":"1318","password":"e10adc3949ba59abbe56e057f20f883e"}}
2016-11-30 12:23:45,692 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"键值相等","条件":[{"模式":{"success":true}, "消息":"登录失败,success不为true"},{"模式":{"message": "成功"},"消息":"message不为成功"},{"模式":{"code": "4001"},"消息":"code不为4001"}],"输出":{"Token":{"token":"value"},"OperatorId":{"operator":{"id":"value"}}}}
2016-11-30 12:23:45,693 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:23:45,693 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130122344', 148, 'test-n-登陆掌贝pos机', '无计划', 'pj_pos', 150, 3, '', 'https', 'saofu.client.test.saofu.cn', 443, '{"函数":"test_interface_of_json","请求头": {"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion": "[global_product_version]", "ProtocolVersion":"[global_protocol_version]"},"方法":"post","url":"/saofu-client/password/login","参数":{"id":"1318","password":"e10adc3949ba59abbe56e057f20f883e"}}', '{"检查":"body","匹配规则":"键值相等","条件":[{"模式":{"success":true}, "消息":"登录失败,success不为true"},{"模式":{"message": "成功"},"消息":"message不为成功"},{"模式":{"code": "4001"},"消息":"code不为4001"}],"输出":{"Token":{"token":"value"},"OperatorId":{"operator":{"id":"value"}}}}', 'Block', '', '')
2016-11-30 12:23:45,694 testcase.py[line: 77] INFO: 开始执行步骤操作[第3步]
2016-11-30 12:23:45,694 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_json
2016-11-30 12:23:45,694 casestep.py[line: 104] INFO: 转换后的参数体为：{'id': '1318', 'password': 'e10adc3949ba59abbe56e057f20f883e'}
2016-11-30 12:23:45,694 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:23:45,694 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[CaseStep.serial_no]
2016-11-30 12:23:45,694 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_protocol_version]
2016-11-30 12:23:45,694 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[CaseStep.device_no]
2016-11-30 12:23:45,694 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_product_version]
2016-11-30 12:23:45,695 casestep.py[line: 104] INFO: 转换后的参数体为：{'SerialNo': 'HZ501FZA0F9M07D', 'ProtocolVersion': '4.0', 'Content-Type': 'application/json;charset=utf-8', 'DeviceId': '182590014248006', 'ProductVersion': '3.2.12C'}
2016-11-30 12:23:45,695 InterfaceUnittestTestCase.py[line: 88] INFO: 正在发起POST请求...
2016-11-30 12:23:45,695 httpprotocol.py[line: 74] INFO: 发起的请求为：https://saofu.client.test.saofu.cn:443/saofu-client/password/login
2016-11-30 12:23:45,695 httpprotocol.py[line: 75] INFO: 参数为：b'{"id": "1318", "password": "e10adc3949ba59abbe56e057f20f883e"}'
2016-11-30 12:23:45,695 httpprotocol.py[line: 76] INFO: 请求头为：{'SerialNo': 'HZ501FZA0F9M07D', 'ProtocolVersion': '4.0', 'Content-Type': 'application/json;charset=utf-8', 'DeviceId': '182590014248006', 'ProductVersion': '3.2.12C'}
2016-11-30 12:23:46,687 InterfaceUnittestTestCase.py[line: 98] INFO: 正在对服务器返回body进行解码
2016-11-30 12:23:46,687 InterfaceUnittestTestCase.py[line: 112] INFO: 服务器返回结果"响应体(body)": {"attach":["flag_appointment","flag_app_xiaoer","flag_cardcupon","flag_cash","flag_help_center","flag_info_center","flag_in_shop","flag_lake","flag_mt_wm","flag_order","flag_qrscan","flag_queue","flag_zhanggui"],"branchSerial":"cao","code":"4001","merchantKey":"10549840601068216320","message":"成功","operator":{"id":1318,"name":"接口测试","number":"1"},"reason":"成功","shopId":"1485916418","success":true,"token":"4af78c31-80cd-46d5-ac8f-0b7c5408488f"}
2016-11-30 12:23:46,688 InterfaceUnittestTestCase.py[line: 113] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:23:49 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('EXCLUDE_ENCRYPT', 'true'), ('Vary', 'Accept-Encoding')]
2016-11-30 12:23:46,688 InterfaceUnittestTestCase.py[line: 114] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:23:46,688 unittesttestcase.py[line: 106] INFO: 要匹配的字典key,value层级为：['success', True]
2016-11-30 12:23:46,688 unittesttestcase.py[line: 109] INFO: 找到的对应字典层级的最后值为：True
2016-11-30 12:23:46,688 unittesttestcase.py[line: 106] INFO: 要匹配的字典key,value层级为：['message', '成功']
2016-11-30 12:23:46,688 unittesttestcase.py[line: 109] INFO: 找到的对应字典层级的最后值为：成功
2016-11-30 12:23:46,688 unittesttestcase.py[line: 106] INFO: 要匹配的字典key,value层级为：['code', '4001']
2016-11-30 12:23:46,689 unittesttestcase.py[line: 109] INFO: 找到的对应字典层级的最后值为：4001
2016-11-30 12:23:46,689 unittesttestcase.py[line: 225] INFO: 要提取的字典key,value层级为：['operator', 'id', 'value']
2016-11-30 12:23:46,689 unittesttestcase.py[line: 239] INFO: 找到的对应字典层级的key的值为：1318
2016-11-30 12:23:46,689 unittesttestcase.py[line: 263] INFO: 获取到的变量的值为：1318
2016-11-30 12:23:46,689 unittesttestcase.py[line: 225] INFO: 要提取的字典key,value层级为：['token', 'value']
2016-11-30 12:23:46,690 unittesttestcase.py[line: 239] INFO: 找到的对应字典层级的key的值为：4af78c31-80cd-46d5-ac8f-0b7c5408488f
2016-11-30 12:23:46,690 unittesttestcase.py[line: 263] INFO: 获取到的变量的值为：4af78c31-80cd-46d5-ac8f-0b7c5408488f
2016-11-30 12:23:46,690 unittesttestcase.py[line: 290] INFO: 提取的输出结果(key-value对)为:[{'OperatorId': 1318}, {'Token': '4af78c31-80cd-46d5-ac8f-0b7c5408488f'}]
2016-11-30 12:23:46,690 testcase.py[line: 155] INFO: 正在更新步骤执行结果
2016-11-30 12:23:46,690 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="post", runtime="2016-11-30 12:23:45",step_action="{'方法': 'post', '函数': 'test_interface_of_json', '参数': {'id': '1318', 'password': 'e10adc3949ba59abbe56e057f20f883e'}, 'url': '/saofu-client/password/login', '请求头': {'SerialNo': 'HZ501FZA0F9M07D', 'ProtocolVersion': '4.0', 'Content-Type': 'application/json;charset=utf-8', 'DeviceId': '182590014248006', 'ProductVersion': '3.2.12C'}}", expected_results="{'输出': {'OperatorId': {'operator': {'id': 'value'}}, 'Token': {'token': 'value'}}, '匹配规则': '键值相等', '条件': [{'模式': {'success': True}, '消息': '登录失败,success不为true'}, {'模式': {'message': '成功'}, '消息': 'message不为成功'}, {'模式': {'code': '4001'}, '消息': 'code不为4001'}], '检查': 'body'}" WHERE executed_history_id = 20161130122344 AND testcase_id = 148 AND step_id = 150 AND project='pj_pos' AND testplan='无计划'
2016-11-30 12:23:46,694 testcase.py[line: 158] INFO: 测试用例[id=148, name=test-n-登陆掌贝pos机]执行成功
2016-11-30 12:23:46,694 global_function.py[line: 79] INFO: 正在更新用例执行结果
2016-11-30 12:23:46,694 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 12:23:45" WHERE executed_history_id = 20161130122344 and testcase_id = 148 AND project='pj_pos' AND testplan='无计划'
2016-11-30 12:23:46,697 global_function.py[line: 86] INFO: 指定用例[148]已执行完
2016-11-30 12:23:46,697 main.py[line: 81] INFO: 用例[148]运行结果：('Pass', '')
2016-11-30 12:23:46,697 main.py[line: 84] INFO: 按项目运行测试
2016-11-30 12:23:46,697 main.py[line: 121] INFO: 运行指定项目
2016-11-30 12:23:46,835 main.py[line: 137] INFO: 正在读取测项目[id：145, project：pj_pos]的协议，host，端口配置...
2016-11-30 12:23:46,836 main.py[line: 140] INFO: 成功读取配置信息：{"protocol":"https","host":"saofu.client.test.saofu.cn","port":443}
2016-11-30 12:23:46,837 main.py[line: 156] INFO: 正在执行测试项目[id：145, project：pj_pos]
2016-11-30 12:23:46,837 testproject.py[line: 23] INFO: 正在获取测试项目[id：145, name：pj_pos]对应对应的测试计划名称列表
2016-11-30 12:23:46,987 testproject.py[line: 28] INFO: 成功获取项目测试计划名称列表[list=['plan1_of_pos']]
2016-11-30 12:23:47,127 testproject.py[line: 38] INFO: 正在执行项目测试计划[project：pj_pos，testplan：plan1_of_pos]
2016-11-30 12:23:47,127 testplan.py[line: 29] INFO: 正在获取测试计划[project=pj_pos，name=plan1_of_pos]的测试用例
2016-11-30 12:23:47,277 testplan.py[line: 35] INFO: 成功获取测试计划[project=pj_pos，name=plan1_of_pos]的测试用例id：dict_keys(['148', '152'])
2016-11-30 12:23:47,458 testplan.py[line: 45] INFO: 获取测试用例信息 [{'author_first_name': 'Testlink', 'estimated_exec_duration': '', 'status': '1', 'full_tc_external_id': 'pj_pos-1', 'preconditions': '<p>\n\t{&quot;isglobal&quot;:1}</p>\n', 'active': '1', 'author_id': '1', 'id': '149', 'author_login': 'admin', 'tc_external_id': '1', 'importance': '2', 'updater_login': 'admin', 'author_last_name': 'Administrator', 'node_order': '1000', 'creation_ts': '2016-07-27 18:32:10', 'updater_id': '1', 'updater_first_name': 'Testlink', 'name': 'test-n-登陆掌贝pos机', 'summary': '', 'layout': '1', 'testcase_id': '148', 'testsuite_id': '147', 'steps': [{'id': '183', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT branch_id FROM account_operator WHERE id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;(1318,)&quot;</p>\n<p>\n\t}</p>\n', 'step_number': '1', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;branch_id&quot;:1}<br />\n\t}</p>\n', 'active': '1', 'execution_type': '1'}, {'id': '182', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;([CaseStep.branch_id],)&quot;</p>\n<p>\n\t}</p>\n', 'step_number': '2', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;device_no&quot;:1,&quot;serial_no&quot;:2}<br />\n\t}</p>\n', 'active': '1', 'execution_type': '1'}, {'id': '150', 'actions': '<p>\n\t{&ldquo;函数&rdquo;：&ldquo;<span style="background-color:#e4e4ff;">test_interface_of_json</span>&rdquo;，</p>\n<p>\n\t&ldquo;请求头&rdquo;： {&quot;<span style="color:#008080;font-weight:bold;">DeviceId&quot;</span>:&quot;[CaseStep.device_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;SerialNo&quot;</span>:&quot;[CaseStep.serial_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;Content-Type&quot;</span>:&quot;<span style="color:#008080;font-weight:bold;">application/json;charset=utf-8&quot;</span>,<span style="color:#008080;font-weight:bold;">&quot;ProductVersion&quot;</span>: &quot;[global_product_version]&quot;, <span style="color:#008080;font-weight:bold;">&quot;ProtocolVersion&quot;</span>:&quot;[global_protocol_version]&quot;},</p>\n<p>\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/saofu-client/password/login&quot;,<br />\n\t&quot;参数&quot;:{&quot;id&quot;:&quot;1318&quot;,&quot;password&quot;:&quot;e10adc3949ba59abbe56e057f20f883e&quot;}<br />\n\t}</p>\n', 'step_number': '3', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;：&quot;键值相等&quot;,</p>\n<p>\n\t&quot;条件&quot;：[{&quot;模式&quot;：{&quot;success&quot;:true}, &quot;消息&quot;：&ldquo;登录失败，success不为true&rdquo;},{&quot;模式&quot;：｛&quot;message&quot;: &quot;成功&quot;},&quot;消息&quot;：&ldquo;message不为成功&rdquo;}，{&quot;模式&quot;：｛&quot;code&quot;: &quot;4001&quot;},&quot;消息&quot;：&ldquo;code不为4001&rdquo;}],</p>\n<p>\n\t&quot;输出&quot;:{&quot;Token&quot;:{&quot;token&quot;:&quot;value&quot;},&quot;OperatorId&quot;:{&quot;operator&quot;:{&quot;id&quot;:&quot;value&quot;}}}</p>\n<p>\n\t}</p>\n', 'active': '1', 'execution_type': '1'}], 'version': '1', 'updater_last_name': 'Administrator', 'is_open': '1', 'modification_ts': '2016-11-30 00:09:05', 'execution_type': '1'}]
2016-11-30 12:23:47,458 testplan.py[line: 52] INFO: 用例[id=148, name=test-n-登陆掌贝pos机]为全局初始化用例，已跳过执行
2016-11-30 12:23:47,630 testplan.py[line: 45] INFO: 获取测试用例信息 [{'author_first_name': 'Testlink', 'estimated_exec_duration': '', 'status': '1', 'full_tc_external_id': 'pj_pos-2', 'preconditions': '', 'active': '1', 'author_id': '1', 'id': '153', 'author_login': 'admin', 'tc_external_id': '2', 'importance': '2', 'updater_login': 'admin', 'author_last_name': 'Administrator', 'node_order': '1000', 'creation_ts': '2016-07-28 12:10:09', 'updater_id': '1', 'updater_first_name': 'Testlink', 'name': 'test-n-修改积分', 'summary': '', 'layout': '1', 'testcase_id': '152', 'testsuite_id': '151', 'steps': [{'id': '154', 'actions': '<p>\n\t<br />\n\t{&quot;函数&quot;：&quot;test_interface_of_json&quot;，</p>\n<p>\n\t&quot;请求头&quot;:{&quot;DeviceId&quot;:&quot;[CaseStep.device_no]&quot;, &quot;SerialNo&quot;:&quot;[CaseStep.serial_no]&quot;, &quot;Content-Type&quot;:&quot;application/json;charset=utf-8&quot;,&quot;ProductVersion&quot;:&quot;[global_product_version]&quot;,&quot;ProtocolVersion&quot;:&quot;[global_product_version]&quot;,&quot;OperatorId&quot;:&quot;[OperatorId]&quot;, &quot;Token&quot;:&quot;[Token]&quot;},</p>\n<p>\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/saofu-client/customer/customer_bonus_update_v3&quot;,<br />\n\t&quot;参数&quot;:{&quot;bonus&quot;:37593,&quot;code&quot;:&quot;17817738178&quot;}<br />\n\t}<br />\n\t&nbsp;</p>\n', 'step_number': '1', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;:&quot;包含字符串&quot;,</p>\n<p>\n\t&quot;条件&quot;:[{&quot;模式&quot;:&quot;success\\&quot;:true&quot;, &quot;消息&quot;:&quot;修改积分失败&quot;}]</p>\n<p>\n\t}</p>\n', 'active': '1', 'execution_type': '1'}], 'version': '1', 'updater_last_name': 'Administrator', 'is_open': '1', 'modification_ts': '2016-11-30 00:19:08', 'execution_type': '1'}]
2016-11-30 12:23:47,758 testplan.py[line: 69] INFO: 记录测试用例到测试用例报表
2016-11-30 12:23:47,758 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130122344', 152, 'test-n-修改积分', '扫码-修改积分接口', 'plan1_of_pos', 'pj_pos', 'Block', '')
2016-11-30 12:23:47,760 testplan.py[line: 72] INFO: 开始执行测试用例[id=152，name=test-n-修改积分]
2016-11-30 12:23:47,760 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"函数":"test_interface_of_json","请求头":{"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion":"[global_product_version]","ProtocolVersion":"[global_product_version]","OperatorId":"[OperatorId]", "Token":"[Token]"},"方法":"post","url":"/saofu-client/customer/customer_bonus_update_v3","参数":{"bonus":37593,"code":"17817738178"}} 
2016-11-30 12:23:47,760 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"success\":true", "消息":"修改积分失败"}]}
2016-11-30 12:23:47,760 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:23:47,760 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130122344', 152, 'test-n-修改积分', 'plan1_of_pos', 'pj_pos', 154, 1, '', 'https', 'saofu.client.test.saofu.cn', 443, '{"函数":"test_interface_of_json","请求头":{"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion":"[global_product_version]","ProtocolVersion":"[global_product_version]","OperatorId":"[OperatorId]", "Token":"[Token]"},"方法":"post","url":"/saofu-client/customer/customer_bonus_update_v3","参数":{"bonus":37593,"code":"17817738178"}} ', '{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"success\\":true", "消息":"修改积分失败"}]}', 'Block', '', '')
2016-11-30 12:23:47,762 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 12:23:47,762 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_json
2016-11-30 12:23:47,762 casestep.py[line: 104] INFO: 转换后的参数体为：{'bonus': 37593, 'code': '17817738178'}
2016-11-30 12:23:47,762 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:23:47,762 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[CaseStep.serial_no]
2016-11-30 12:23:47,762 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_product_version]
2016-11-30 12:23:47,762 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[CaseStep.device_no]
2016-11-30 12:23:47,763 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_product_version]
2016-11-30 12:23:47,763 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[OperatorId]
2016-11-30 12:23:47,763 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[Token]
2016-11-30 12:23:47,763 casestep.py[line: 104] INFO: 转换后的参数体为：{'SerialNo': 'HZ501FZA0F9M07D', 'ProtocolVersion': '3.2.12C', 'DeviceId': '182590014248006', 'ProductVersion': '3.2.12C', 'OperatorId': 1318, 'Content-Type': 'application/json;charset=utf-8', 'Token': '4af78c31-80cd-46d5-ac8f-0b7c5408488f'}
2016-11-30 12:23:47,763 InterfaceUnittestTestCase.py[line: 88] INFO: 正在发起POST请求...
2016-11-30 12:23:47,763 httpprotocol.py[line: 74] INFO: 发起的请求为：https://saofu.client.test.saofu.cn:443/saofu-client/customer/customer_bonus_update_v3
2016-11-30 12:23:47,763 httpprotocol.py[line: 75] INFO: 参数为：b'{"bonus": 37593, "code": "17817738178"}'
2016-11-30 12:23:47,763 httpprotocol.py[line: 76] INFO: 请求头为：{'SerialNo': 'HZ501FZA0F9M07D', 'ProtocolVersion': '3.2.12C', 'DeviceId': '182590014248006', 'ProductVersion': '3.2.12C', 'OperatorId': 1318, 'Content-Type': 'application/json;charset=utf-8', 'Token': '4af78c31-80cd-46d5-ac8f-0b7c5408488f'}
2016-11-30 12:23:48,165 InterfaceUnittestTestCase.py[line: 98] INFO: 正在对服务器返回body进行解码
2016-11-30 12:23:48,167 InterfaceUnittestTestCase.py[line: 112] INFO: 服务器返回结果"响应体(body)": {"bonus":37593,"code":"4001","success":true}
2016-11-30 12:23:48,167 InterfaceUnittestTestCase.py[line: 113] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:23:51 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('Vary', 'Accept-Encoding')]
2016-11-30 12:23:48,167 InterfaceUnittestTestCase.py[line: 114] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:23:48,167 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为：success":true
2016-11-30 12:23:48,168 unittesttestcase.py[line: 292] WARNING: 未检测到从服务器返回中提取内容的要求，请检查是否正确填写预期结果
2016-11-30 12:23:48,168 testcase.py[line: 155] INFO: 正在更新步骤执行结果
2016-11-30 12:23:48,168 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="post", runtime="2016-11-30 12:23:47",step_action="{'方法': 'post', '函数': 'test_interface_of_json', '参数': {'bonus': 37593, 'code': '17817738178'}, 'url': '/saofu-client/customer/customer_bonus_update_v3', '请求头': {'SerialNo': 'HZ501FZA0F9M07D', 'ProtocolVersion': '3.2.12C', 'DeviceId': '182590014248006', 'ProductVersion': '3.2.12C', 'OperatorId': 1318, 'Content-Type': 'application/json;charset=utf-8', 'Token': '4af78c31-80cd-46d5-ac8f-0b7c5408488f'}}", expected_results="{'匹配规则': '包含字符串', '条件': [{'模式': 'success':true', '消息': '修改积分失败'}], '检查': 'body'}" WHERE executed_history_id = 20161130122344 AND testcase_id = 152 AND step_id = 154 AND project='pj_pos' AND testplan='plan1_of_pos'
2016-11-30 12:23:48,172 testcase.py[line: 158] INFO: 测试用例[id=152, name=test-n-修改积分]执行成功
2016-11-30 12:23:48,173 testplan.py[line: 76] INFO: 正在更新用例执行结果
2016-11-30 12:23:48,173 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 12:23:47" WHERE executed_history_id = 20161130122344 AND testcase_id = 152 AND project='pj_pos' AND testplan='plan1_of_pos'
2016-11-30 12:23:48,309 testplan.py[line: 87] INFO: 正在更新testlink上测试计划[testplan_id=146, bulid_version=v1.0.0],对应用例[testcase_id=152]的执行结果
2016-11-30 12:23:48,471 testplan.py[line: 97] INFO: 测试计划[project=pj_pos ,testplan=plan1_of_pos]已执行完
2016-11-30 12:23:48,471 main.py[line: 248] INFO: 接口测试已执行完成，正在关闭数据库连接
2016-11-30 12:23:48,472 htmlreporter.py[line: 37] INFO: 正在查询测试用例总数
2016-11-30 12:23:48,472 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE executed_history_id = %s  data：('20161130122344',)
2016-11-30 12:23:48,475 htmlreporter.py[line: 43] INFO: 正在查询执行通过的用例数
2016-11-30 12:23:48,476 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE runresult = %s AND executed_history_id = %s  data：('Pass', '20161130122344')
2016-11-30 12:23:48,478 htmlreporter.py[line: 49] INFO: 正在查询执行失败的用例数
2016-11-30 12:23:48,478 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE runresult = %s AND executed_history_id = %s  data：('Fail', '20161130122344')
2016-11-30 12:23:48,479 htmlreporter.py[line: 55] INFO: 正在查询执行出错的用例数
2016-11-30 12:23:48,479 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE runresult = %s AND executed_history_id = %s  data：('Error', '20161130122344')
2016-11-30 12:23:48,481 htmlreporter.py[line: 61] INFO: 正在查询未执行的用例数
2016-11-30 12:23:48,481 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE runresult = %s AND executed_history_id = %s  data：('Block', '20161130122344')
2016-11-30 12:23:48,482 htmlreporter.py[line: 72] INFO: 正在查询已运的测试计划
2016-11-30 12:23:48,483 mydb.py[line: 100] INFO: query：SELECT project, testplan FROM testcase_report_tb WHERE executed_history_id = %s GROUP BY project, testplan ORDER BY id ASC  data：('20161130122344',)
2016-11-30 12:23:48,485 htmlreporter.py[line: 98] INFO: 正在查询测试计划[project：pj_pos, testplan：无计划]的测试用例执行结果
2016-11-30 12:23:48,485 mydb.py[line: 100] INFO: query：SELECT id, executed_history_id, testcase_id, testcase_name,testsuit, testplan, project, runresult, runtime FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s GROUP BY testcase_id ORDER BY id ASC  data：('pj_pos', '无计划', '20161130122344')
2016-11-30 12:23:48,488 htmlreporter.py[line: 105] INFO: 正在记录测试测试计划[project：pj_pos, testplan：无计划]的测试用例运行结果到测试报告
2016-11-30 12:23:48,488 htmlreporter.py[line: 98] INFO: 正在查询测试计划[project：pj_pos, testplan：plan1_of_pos]的测试用例执行结果
2016-11-30 12:23:48,489 mydb.py[line: 100] INFO: query：SELECT id, executed_history_id, testcase_id, testcase_name,testsuit, testplan, project, runresult, runtime FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s GROUP BY testcase_id ORDER BY id ASC  data：('pj_pos', 'plan1_of_pos', '20161130122344')
2016-11-30 12:23:48,490 htmlreporter.py[line: 105] INFO: 正在记录测试测试计划[project：pj_pos, testplan：plan1_of_pos]的测试用例运行结果到测试报告
2016-11-30 12:23:48,491 htmlreporter.py[line: 115] INFO: 正在查询已运的测试计划
2016-11-30 12:23:48,491 mydb.py[line: 100] INFO: query：SELECT project, testplan FROM testcase_report_tb WHERE executed_history_id = %s GROUP BY project, testplan ORDER BY id ASC  data：('20161130122344',)
2016-11-30 12:23:48,492 htmlreporter.py[line: 127] INFO: 正在查询测试计划[project：pj_pos, testplan：无计划]已运行的测试用例
2016-11-30 12:23:48,492 mydb.py[line: 100] INFO: query：SELECT testcase_id, testcase_name, project, testplan FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s  GROUP BY testcase_id ORDER BY id ASC  data：('pj_pos', '无计划', '20161130122344')
2016-11-30 12:23:48,494 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=148]步骤运行结果
2016-11-30 12:23:48,494 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_pos', '无计划', 148, '20161130122344')
2016-11-30 12:23:48,497 htmlreporter.py[line: 127] INFO: 正在查询测试计划[project：pj_pos, testplan：plan1_of_pos]已运行的测试用例
2016-11-30 12:23:48,498 mydb.py[line: 100] INFO: query：SELECT testcase_id, testcase_name, project, testplan FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s  GROUP BY testcase_id ORDER BY id ASC  data：('pj_pos', 'plan1_of_pos', '20161130122344')
2016-11-30 12:23:48,499 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=152]步骤运行结果
2016-11-30 12:23:48,500 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_pos', 'plan1_of_pos', 152, '20161130122344')
2016-11-30 12:23:48,502 htmlreporter.py[line: 183] INFO: 正在设置测试报告结果文件名
2016-11-30 12:23:48,502 htmlreporter.py[line: 193] INFO: 测试报告文件名所在路径为：E:\\Projects\\report\\test_report20161130122344.html
2016-11-30 12:23:48,502 htmlreporter.py[line: 186] INFO: 正在生成测试报告
2016-11-30 12:23:48,504 main.py[line: 271] INFO: 生成测试报告成功
2016-11-30 12:23:48,652 main.py[line: 278] INFO: E:\\Projects\\report\\test_report20161130122344.html
2016-11-30 12:23:48,652 main.py[line: 281] INFO: 正在发送测试报告邮件...
2016-11-30 12:23:48,688 main.py[line: 285] INFO: 发送邮件成功
2016-11-30 12:24:56,787 global_var.py[line: 19] INFO: 当前运行环境：测试环境
2016-11-30 12:24:56,787 global_var.py[line: 20] INFO: 正在初始化数据库[名称：SAOFUDB1]对象
2016-11-30 12:24:56,800 global_var.py[line: 27] INFO: 正在初始化数据库[名称：TESTDB]对象
2016-11-30 12:24:56,803 global_var.py[line: 30] INFO: 正在获取testlink
2016-11-30 12:24:56,856 main.py[line: 63] INFO: 正在创建测试用例报告报表
2016-11-30 12:24:56,856 mydb.py[line: 43] INFO: query：CREATE TABLE IF NOT EXISTS testcase_report_tb                                         (id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,                                          executed_history_id varchar(50) NOT NULL,                                          testcase_id int NOT NULL,                                          testcase_name varchar(40) NOT NULL,                                          testsuit varchar(40),                                          testplan varchar(40),                                          project varchar(40),                                          runresult varchar(20),                                          runtime datetime)
2016-11-30 12:24:56,857 main.py[line: 66] INFO: 正在创建测试步骤报告报表
2016-11-30 12:24:56,857 mydb.py[line: 43] INFO: query：CREATE TABLE IF NOT EXISTS case_step_report_tb                                         (id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,                                          executed_history_id varchar(50) NOT NULL,                                          testcase_id int NOT NULL,                                          testcase_name varchar(40) NOT NULL,                                          testplan varchar(40) NOT NULL,                                          project varchar(40) NOT NULL,                                          step_id int,                                          step_num int NOT NULL,                                          step_action varchar(1000),                                           expected_results varchar(1000),                                          runresult varchar(10),                                          reason varchar(2000),                                          protocol_method varchar(40) ,                                          protocol varchar(40),                                          host varchar(40),                                          port int,                                          runtime datetime)
2016-11-30 12:24:56,858 main.py[line: 69] INFO: 正在读取运行模式配置
2016-11-30 12:24:56,859 main.py[line: 76] INFO: 正在运行全局初始化用例……
2016-11-30 12:24:56,859 main.py[line: 78] INFO: 待运行全局初始化用例id列表：[148]
2016-11-30 12:24:57,012 global_function.py[line: 19] INFO: 获取测试用例信息 [{'version': '1', 'updater_id': '1', 'estimated_exec_duration': '', 'tc_external_id': '1', 'testsuite_id': '147', 'author_id': '1', 'testcase_id': '148', 'importance': '2', 'updater_last_name': 'Administrator', 'creation_ts': '2016-07-27 18:32:10', 'status': '1', 'id': '149', 'active': '1', 'modification_ts': '2016-11-30 00:09:05', 'updater_first_name': 'Testlink', 'node_order': '1000', 'author_last_name': 'Administrator', 'author_login': 'admin', 'updater_login': 'admin', 'author_first_name': 'Testlink', 'execution_type': '1', 'summary': '', 'full_tc_external_id': 'pj_pos-1', 'name': 'test-n-登陆掌贝pos机', 'steps': [{'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;branch_id&quot;:1}<br />\n\t}</p>\n', 'step_number': '1', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT branch_id FROM account_operator WHERE id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;(1318,)&quot;</p>\n<p>\n\t}</p>\n', 'id': '183', 'execution_type': '1', 'active': '1'}, {'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;device_no&quot;:1,&quot;serial_no&quot;:2}<br />\n\t}</p>\n', 'step_number': '2', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;([CaseStep.branch_id],)&quot;</p>\n<p>\n\t}</p>\n', 'id': '182', 'execution_type': '1', 'active': '1'}, {'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;：&quot;键值相等&quot;,</p>\n<p>\n\t&quot;条件&quot;：[{&quot;模式&quot;：{&quot;success&quot;:true}, &quot;消息&quot;：&ldquo;登录失败，success不为true&rdquo;},{&quot;模式&quot;：｛&quot;message&quot;: &quot;成功&quot;},&quot;消息&quot;：&ldquo;message不为成功&rdquo;}，{&quot;模式&quot;：｛&quot;code&quot;: &quot;4001&quot;},&quot;消息&quot;：&ldquo;code不为4001&rdquo;}],</p>\n<p>\n\t&quot;输出&quot;:{&quot;Token&quot;:{&quot;token&quot;:&quot;value&quot;},&quot;OperatorId&quot;:{&quot;operator&quot;:{&quot;id&quot;:&quot;value&quot;}}}</p>\n<p>\n\t}</p>\n', 'step_number': '3', 'actions': '<p>\n\t{&ldquo;函数&rdquo;：&ldquo;<span style="background-color:#e4e4ff;">test_interface_of_json</span>&rdquo;，</p>\n<p>\n\t&ldquo;请求头&rdquo;： {&quot;<span style="color:#008080;font-weight:bold;">DeviceId&quot;</span>:&quot;[CaseStep.device_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;SerialNo&quot;</span>:&quot;[CaseStep.serial_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;Content-Type&quot;</span>:&quot;<span style="color:#008080;font-weight:bold;">application/json;charset=utf-8&quot;</span>,<span style="color:#008080;font-weight:bold;">&quot;ProductVersion&quot;</span>: &quot;[global_product_version]&quot;, <span style="color:#008080;font-weight:bold;">&quot;ProtocolVersion&quot;</span>:&quot;[global_protocol_version]&quot;},</p>\n<p>\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/saofu-client/password/login&quot;,<br />\n\t&quot;参数&quot;:{&quot;id&quot;:&quot;1318&quot;,&quot;password&quot;:&quot;e10adc3949ba59abbe56e057f20f883e&quot;}<br />\n\t}</p>\n', 'id': '150', 'execution_type': '1', 'active': '1'}], 'preconditions': '<p>\n\t{&quot;isglobal&quot;:1}</p>\n', 'layout': '1', 'is_open': '1'}]
2016-11-30 12:24:57,144 global_function.py[line: 39] INFO: 正在读取套件[id=147]的协议，host，端口配置...
2016-11-30 12:24:57,814 global_function.py[line: 68] INFO: 记录测试用例到测试用例报表
2016-11-30 12:24:57,814 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130122456', 148, 'test-n-登陆掌贝pos机', '登陆接口', '无计划', 'pj_pos', 'Block', '')
2016-11-30 12:24:57,815 global_function.py[line: 71] INFO: 开始执行测试用例[id=148，name=test-n-登陆掌贝pos机]
2016-11-30 12:24:57,815 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行sql","单条查询":"SELECT branch_id FROM account_operator WHERE id = %s","参数":"(1318,)"}
2016-11-30 12:24:57,815 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","输出":{"branch_id":1}}
2016-11-30 12:24:57,815 testcase.py[line: 55] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:24:57,816 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130122456', 148, 'test-n-登陆掌贝pos机', '无计划', 'pj_pos', 183, 1, '', '', '192.168.9.211', '3306', '{"步骤类型":"执行sql","单条查询":"SELECT branch_id FROM account_operator WHERE id = %s","参数":"(1318,)"}', '{"检查":"body","输出":{"branch_id":1}}', 'Block', '', '')
2016-11-30 12:24:57,817 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 12:24:57,817 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:24:57,817 mydb.py[line: 84] INFO: query：SELECT branch_id FROM account_operator WHERE id = %s  data：(1318,)
2016-11-30 12:24:57,821 casestep.py[line: 190] INFO: 数据库服务器返回的查询结果为为 query_result:(1485916418,), flag:True
2016-11-30 12:24:57,821 casestep.py[line: 192] INFO: 正在保存服务器返回结果到自定义变量
2016-11-30 12:24:57,821 casestep.py[line: 227] INFO: 提取的输出结果(key-value对)为:[{'branch_id': 1485916418}]
2016-11-30 12:24:57,821 testcase.py[line: 155] INFO: 正在更新步骤执行结果
2016-11-30 12:24:57,821 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 12:24:57",step_action="{'参数': (1318,), '单条查询': 'SELECT branch_id FROM account_operator WHERE id = %s', '步骤类型': '执行sql'}", expected_results="{'检查': 'body', '输出': {'branch_id': 1}}" WHERE executed_history_id = 20161130122456 AND testcase_id = 148 AND step_id = 183 AND project='pj_pos' AND testplan='无计划'
2016-11-30 12:24:57,824 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行sql","单条查询":"SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s","参数":"([CaseStep.branch_id],)"}
2016-11-30 12:24:57,824 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","输出":{"device_no":1,"serial_no":2}}
2016-11-30 12:24:57,824 testcase.py[line: 55] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:24:57,824 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130122456', 148, 'test-n-登陆掌贝pos机', '无计划', 'pj_pos', 182, 2, '', '', '192.168.9.211', '3306', '{"步骤类型":"执行sql","单条查询":"SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s","参数":"([CaseStep.branch_id],)"}', '{"检查":"body","输出":{"device_no":1,"serial_no":2}}', 'Block', '', '')
2016-11-30 12:24:57,825 testcase.py[line: 77] INFO: 开始执行步骤操作[第2步]
2016-11-30 12:24:57,825 casestep.py[line: 115] INFO: 找到待替换的非全局动态参数：[CaseStep.branch_id]
2016-11-30 12:24:57,825 casestep.py[line: 138] INFO: 转换后的参数体为：(1485916418,)
2016-11-30 12:24:57,825 mydb.py[line: 84] INFO: query：SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s  data：(1485916418,)
2016-11-30 12:24:57,828 casestep.py[line: 190] INFO: 数据库服务器返回的查询结果为为 query_result:('182590014248006', 'HZ501FZA0F9M07D'), flag:True
2016-11-30 12:24:57,829 casestep.py[line: 192] INFO: 正在保存服务器返回结果到自定义变量
2016-11-30 12:24:57,829 casestep.py[line: 227] INFO: 提取的输出结果(key-value对)为:[{'branch_id': 1485916418}, {'device_no': '182590014248006'}, {'serial_no': 'HZ501FZA0F9M07D'}]
2016-11-30 12:24:57,829 testcase.py[line: 155] INFO: 正在更新步骤执行结果
2016-11-30 12:24:57,829 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 12:24:57",step_action="{'参数': (1485916418,), '单条查询': 'SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s', '步骤类型': '执行sql'}", expected_results="{'检查': 'body', '输出': {'serial_no': 2, 'device_no': 1}}" WHERE executed_history_id = 20161130122456 AND testcase_id = 148 AND step_id = 182 AND project='pj_pos' AND testplan='无计划'
2016-11-30 12:24:57,832 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"函数":"test_interface_of_json","请求头": {"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion": "[global_product_version]", "ProtocolVersion":"[global_protocol_version]"},"方法":"post","url":"/saofu-client/password/login","参数":{"id":"1318","password":"e10adc3949ba59abbe56e057f20f883e"}}
2016-11-30 12:24:57,832 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"键值相等","条件":[{"模式":{"success":true}, "消息":"登录失败,success不为true"},{"模式":{"message": "成功"},"消息":"message不为成功"},{"模式":{"code": "4001"},"消息":"code不为4001"}],"输出":{"Token":{"token":"value"},"OperatorId":{"operator":{"id":"value"}}}}
2016-11-30 12:24:57,832 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:24:57,832 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130122456', 148, 'test-n-登陆掌贝pos机', '无计划', 'pj_pos', 150, 3, '', 'https', 'saofu.client.test.saofu.cn', 443, '{"函数":"test_interface_of_json","请求头": {"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion": "[global_product_version]", "ProtocolVersion":"[global_protocol_version]"},"方法":"post","url":"/saofu-client/password/login","参数":{"id":"1318","password":"e10adc3949ba59abbe56e057f20f883e"}}', '{"检查":"body","匹配规则":"键值相等","条件":[{"模式":{"success":true}, "消息":"登录失败,success不为true"},{"模式":{"message": "成功"},"消息":"message不为成功"},{"模式":{"code": "4001"},"消息":"code不为4001"}],"输出":{"Token":{"token":"value"},"OperatorId":{"operator":{"id":"value"}}}}', 'Block', '', '')
2016-11-30 12:24:57,833 testcase.py[line: 77] INFO: 开始执行步骤操作[第3步]
2016-11-30 12:24:57,833 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_json
2016-11-30 12:24:57,834 casestep.py[line: 104] INFO: 转换后的参数体为：{'password': 'e10adc3949ba59abbe56e057f20f883e', 'id': '1318'}
2016-11-30 12:24:57,834 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:24:57,834 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_product_version]
2016-11-30 12:24:57,834 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[CaseStep.device_no]
2016-11-30 12:24:57,834 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_protocol_version]
2016-11-30 12:24:57,834 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[CaseStep.serial_no]
2016-11-30 12:24:57,834 casestep.py[line: 104] INFO: 转换后的参数体为：{'ProductVersion': '3.2.12C', 'Content-Type': 'application/json;charset=utf-8', 'DeviceId': '182590014248006', 'ProtocolVersion': '4.0', 'SerialNo': 'HZ501FZA0F9M07D'}
2016-11-30 12:24:57,834 InterfaceUnittestTestCase.py[line: 88] INFO: 正在发起POST请求...
2016-11-30 12:24:57,835 httpprotocol.py[line: 74] INFO: 发起的请求为：https://saofu.client.test.saofu.cn:443/saofu-client/password/login
2016-11-30 12:24:57,835 httpprotocol.py[line: 75] INFO: 参数为：b'{"password": "e10adc3949ba59abbe56e057f20f883e", "id": "1318"}'
2016-11-30 12:24:57,835 httpprotocol.py[line: 76] INFO: 请求头为：{'SerialNo': 'HZ501FZA0F9M07D', 'Content-Type': 'application/json;charset=utf-8', 'DeviceId': '182590014248006', 'ProtocolVersion': '4.0', 'ProductVersion': '3.2.12C'}
2016-11-30 12:24:58,931 InterfaceUnittestTestCase.py[line: 98] INFO: 正在对服务器返回body进行解码
2016-11-30 12:24:58,931 InterfaceUnittestTestCase.py[line: 112] INFO: 服务器返回结果"响应体(body)": {"attach":["flag_appointment","flag_app_xiaoer","flag_cardcupon","flag_cash","flag_help_center","flag_info_center","flag_in_shop","flag_lake","flag_mt_wm","flag_order","flag_qrscan","flag_queue","flag_zhanggui"],"branchSerial":"cao","code":"4001","merchantKey":"10549840601068216320","message":"成功","operator":{"id":1318,"name":"接口测试","number":"1"},"reason":"成功","shopId":"1485916418","success":true,"token":"2d93ac16-f6f7-4627-b88f-2f847b33ee5f"}
2016-11-30 12:24:58,931 InterfaceUnittestTestCase.py[line: 113] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:25:02 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('EXCLUDE_ENCRYPT', 'true'), ('Vary', 'Accept-Encoding')]
2016-11-30 12:24:58,931 InterfaceUnittestTestCase.py[line: 114] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:24:58,932 unittesttestcase.py[line: 106] INFO: 要匹配的字典key,value层级为：['success', True]
2016-11-30 12:24:58,932 unittesttestcase.py[line: 109] INFO: 找到的对应字典层级的最后值为：True
2016-11-30 12:24:58,932 unittesttestcase.py[line: 106] INFO: 要匹配的字典key,value层级为：['message', '成功']
2016-11-30 12:24:58,932 unittesttestcase.py[line: 109] INFO: 找到的对应字典层级的最后值为：成功
2016-11-30 12:24:58,932 unittesttestcase.py[line: 106] INFO: 要匹配的字典key,value层级为：['code', '4001']
2016-11-30 12:24:58,933 unittesttestcase.py[line: 109] INFO: 找到的对应字典层级的最后值为：4001
2016-11-30 12:24:58,933 unittesttestcase.py[line: 225] INFO: 要提取的字典key,value层级为：['token', 'value']
2016-11-30 12:24:58,933 unittesttestcase.py[line: 239] INFO: 找到的对应字典层级的key的值为：2d93ac16-f6f7-4627-b88f-2f847b33ee5f
2016-11-30 12:24:58,933 unittesttestcase.py[line: 263] INFO: 获取到的变量的值为：2d93ac16-f6f7-4627-b88f-2f847b33ee5f
2016-11-30 12:24:58,933 unittesttestcase.py[line: 225] INFO: 要提取的字典key,value层级为：['operator', 'id', 'value']
2016-11-30 12:24:58,933 unittesttestcase.py[line: 239] INFO: 找到的对应字典层级的key的值为：1318
2016-11-30 12:24:58,934 unittesttestcase.py[line: 263] INFO: 获取到的变量的值为：1318
2016-11-30 12:24:58,934 unittesttestcase.py[line: 290] INFO: 提取的输出结果(key-value对)为:[{'Token': '2d93ac16-f6f7-4627-b88f-2f847b33ee5f'}, {'OperatorId': 1318}]
2016-11-30 12:24:58,934 testcase.py[line: 155] INFO: 正在更新步骤执行结果
2016-11-30 12:24:58,934 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="post", runtime="2016-11-30 12:24:57",step_action="{'请求头': {'ProductVersion': '3.2.12C', 'Content-Type': 'application/json;charset=utf-8', 'DeviceId': '182590014248006', 'ProtocolVersion': '4.0', 'SerialNo': 'HZ501FZA0F9M07D'}, 'url': '/saofu-client/password/login', '参数': {'password': 'e10adc3949ba59abbe56e057f20f883e', 'id': '1318'}, '方法': 'post', '函数': 'test_interface_of_json'}", expected_results="{'检查': 'body', '输出': {'Token': {'token': 'value'}, 'OperatorId': {'operator': {'id': 'value'}}}, '匹配规则': '键值相等', '条件': [{'消息': '登录失败,success不为true', '模式': {'success': True}}, {'消息': 'message不为成功', '模式': {'message': '成功'}}, {'消息': 'code不为4001', '模式': {'code': '4001'}}]}" WHERE executed_history_id = 20161130122456 AND testcase_id = 148 AND step_id = 150 AND project='pj_pos' AND testplan='无计划'
2016-11-30 12:24:58,938 testcase.py[line: 158] INFO: 测试用例[id=148, name=test-n-登陆掌贝pos机]执行成功
2016-11-30 12:24:58,938 global_function.py[line: 75] INFO: 正在更新用例执行结果
2016-11-30 12:24:58,938 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 12:24:57" WHERE executed_history_id = 20161130122456 and testcase_id = 148 AND project='pj_pos' AND testplan='无计划'
2016-11-30 12:24:58,940 global_function.py[line: 82] INFO: 指定用例[148]已执行完
2016-11-30 12:24:58,941 main.py[line: 81] INFO: 用例[148]运行结果：('Pass', '')
2016-11-30 12:24:58,941 main.py[line: 84] INFO: 按项目运行测试
2016-11-30 12:24:58,941 main.py[line: 121] INFO: 运行指定项目
2016-11-30 12:24:59,220 main.py[line: 137] INFO: 正在读取测项目[id：145, project：pj_pos]的协议，host，端口配置...
2016-11-30 12:24:59,221 main.py[line: 140] INFO: 成功读取配置信息：{"protocol":"https","host":"saofu.client.test.saofu.cn","port":443}
2016-11-30 12:24:59,223 main.py[line: 156] INFO: 正在执行测试项目[id：145, project：pj_pos]
2016-11-30 12:24:59,223 testproject.py[line: 23] INFO: 正在获取测试项目[id：145, name：pj_pos]对应对应的测试计划名称列表
2016-11-30 12:24:59,480 testproject.py[line: 28] INFO: 成功获取项目测试计划名称列表[list=['plan1_of_pos']]
2016-11-30 12:24:59,682 testproject.py[line: 38] INFO: 正在执行项目测试计划[project：pj_pos，testplan：plan1_of_pos]
2016-11-30 12:24:59,682 testplan.py[line: 29] INFO: 正在获取测试计划[project=pj_pos，name=plan1_of_pos]的测试用例
2016-11-30 12:24:59,850 testplan.py[line: 35] INFO: 成功获取测试计划[project=pj_pos，name=plan1_of_pos]的测试用例id：dict_keys(['148', '152'])
2016-11-30 12:24:59,990 testplan.py[line: 45] INFO: 获取测试用例信息 [{'version': '1', 'updater_id': '1', 'estimated_exec_duration': '', 'tc_external_id': '1', 'testsuite_id': '147', 'author_id': '1', 'testcase_id': '148', 'importance': '2', 'updater_last_name': 'Administrator', 'creation_ts': '2016-07-27 18:32:10', 'status': '1', 'id': '149', 'active': '1', 'modification_ts': '2016-11-30 00:09:05', 'updater_first_name': 'Testlink', 'node_order': '1000', 'author_last_name': 'Administrator', 'author_login': 'admin', 'updater_login': 'admin', 'author_first_name': 'Testlink', 'execution_type': '1', 'summary': '', 'full_tc_external_id': 'pj_pos-1', 'name': 'test-n-登陆掌贝pos机', 'steps': [{'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;branch_id&quot;:1}<br />\n\t}</p>\n', 'step_number': '1', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT branch_id FROM account_operator WHERE id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;(1318,)&quot;</p>\n<p>\n\t}</p>\n', 'id': '183', 'execution_type': '1', 'active': '1'}, {'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;device_no&quot;:1,&quot;serial_no&quot;:2}<br />\n\t}</p>\n', 'step_number': '2', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;([CaseStep.branch_id],)&quot;</p>\n<p>\n\t}</p>\n', 'id': '182', 'execution_type': '1', 'active': '1'}, {'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;：&quot;键值相等&quot;,</p>\n<p>\n\t&quot;条件&quot;：[{&quot;模式&quot;：{&quot;success&quot;:true}, &quot;消息&quot;：&ldquo;登录失败，success不为true&rdquo;},{&quot;模式&quot;：｛&quot;message&quot;: &quot;成功&quot;},&quot;消息&quot;：&ldquo;message不为成功&rdquo;}，{&quot;模式&quot;：｛&quot;code&quot;: &quot;4001&quot;},&quot;消息&quot;：&ldquo;code不为4001&rdquo;}],</p>\n<p>\n\t&quot;输出&quot;:{&quot;Token&quot;:{&quot;token&quot;:&quot;value&quot;},&quot;OperatorId&quot;:{&quot;operator&quot;:{&quot;id&quot;:&quot;value&quot;}}}</p>\n<p>\n\t}</p>\n', 'step_number': '3', 'actions': '<p>\n\t{&ldquo;函数&rdquo;：&ldquo;<span style="background-color:#e4e4ff;">test_interface_of_json</span>&rdquo;，</p>\n<p>\n\t&ldquo;请求头&rdquo;： {&quot;<span style="color:#008080;font-weight:bold;">DeviceId&quot;</span>:&quot;[CaseStep.device_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;SerialNo&quot;</span>:&quot;[CaseStep.serial_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;Content-Type&quot;</span>:&quot;<span style="color:#008080;font-weight:bold;">application/json;charset=utf-8&quot;</span>,<span style="color:#008080;font-weight:bold;">&quot;ProductVersion&quot;</span>: &quot;[global_product_version]&quot;, <span style="color:#008080;font-weight:bold;">&quot;ProtocolVersion&quot;</span>:&quot;[global_protocol_version]&quot;},</p>\n<p>\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/saofu-client/password/login&quot;,<br />\n\t&quot;参数&quot;:{&quot;id&quot;:&quot;1318&quot;,&quot;password&quot;:&quot;e10adc3949ba59abbe56e057f20f883e&quot;}<br />\n\t}</p>\n', 'id': '150', 'execution_type': '1', 'active': '1'}], 'preconditions': '<p>\n\t{&quot;isglobal&quot;:1}</p>\n', 'layout': '1', 'is_open': '1'}]
2016-11-30 12:24:59,991 testplan.py[line: 52] INFO: 用例[id=148, name=test-n-登陆掌贝pos机]为全局初始化用例，已跳过执行
2016-11-30 12:25:00,117 testplan.py[line: 45] INFO: 获取测试用例信息 [{'version': '1', 'updater_id': '1', 'estimated_exec_duration': '', 'tc_external_id': '2', 'testsuite_id': '151', 'author_id': '1', 'testcase_id': '152', 'importance': '2', 'updater_last_name': 'Administrator', 'creation_ts': '2016-07-28 12:10:09', 'status': '1', 'id': '153', 'active': '1', 'modification_ts': '2016-11-30 00:19:08', 'updater_first_name': 'Testlink', 'node_order': '1000', 'author_last_name': 'Administrator', 'author_login': 'admin', 'updater_login': 'admin', 'author_first_name': 'Testlink', 'execution_type': '1', 'summary': '', 'full_tc_external_id': 'pj_pos-2', 'name': 'test-n-修改积分', 'steps': [{'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;:&quot;包含字符串&quot;,</p>\n<p>\n\t&quot;条件&quot;:[{&quot;模式&quot;:&quot;success\\&quot;:true&quot;, &quot;消息&quot;:&quot;修改积分失败&quot;}]</p>\n<p>\n\t}</p>\n', 'step_number': '1', 'actions': '<p>\n\t<br />\n\t{&quot;函数&quot;：&quot;test_interface_of_json&quot;，</p>\n<p>\n\t&quot;请求头&quot;:{&quot;DeviceId&quot;:&quot;[CaseStep.device_no]&quot;, &quot;SerialNo&quot;:&quot;[CaseStep.serial_no]&quot;, &quot;Content-Type&quot;:&quot;application/json;charset=utf-8&quot;,&quot;ProductVersion&quot;:&quot;[global_product_version]&quot;,&quot;ProtocolVersion&quot;:&quot;[global_product_version]&quot;,&quot;OperatorId&quot;:&quot;[OperatorId]&quot;, &quot;Token&quot;:&quot;[Token]&quot;},</p>\n<p>\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/saofu-client/customer/customer_bonus_update_v3&quot;,<br />\n\t&quot;参数&quot;:{&quot;bonus&quot;:37593,&quot;code&quot;:&quot;17817738178&quot;}<br />\n\t}<br />\n\t&nbsp;</p>\n', 'id': '154', 'execution_type': '1', 'active': '1'}], 'preconditions': '', 'layout': '1', 'is_open': '1'}]
2016-11-30 12:25:00,234 testplan.py[line: 69] INFO: 记录测试用例到测试用例报表
2016-11-30 12:25:00,234 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130122456', 152, 'test-n-修改积分', '扫码-修改积分接口', 'plan1_of_pos', 'pj_pos', 'Block', '')
2016-11-30 12:25:00,235 testplan.py[line: 72] INFO: 开始执行测试用例[id=152，name=test-n-修改积分]
2016-11-30 12:25:00,235 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"函数":"test_interface_of_json","请求头":{"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion":"[global_product_version]","ProtocolVersion":"[global_product_version]","OperatorId":"[OperatorId]", "Token":"[Token]"},"方法":"post","url":"/saofu-client/customer/customer_bonus_update_v3","参数":{"bonus":37593,"code":"17817738178"}} 
2016-11-30 12:25:00,236 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"success\":true", "消息":"修改积分失败"}]}
2016-11-30 12:25:00,236 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 12:25:00,236 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130122456', 152, 'test-n-修改积分', 'plan1_of_pos', 'pj_pos', 154, 1, '', 'https', 'saofu.client.test.saofu.cn', 443, '{"函数":"test_interface_of_json","请求头":{"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion":"[global_product_version]","ProtocolVersion":"[global_product_version]","OperatorId":"[OperatorId]", "Token":"[Token]"},"方法":"post","url":"/saofu-client/customer/customer_bonus_update_v3","参数":{"bonus":37593,"code":"17817738178"}} ', '{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"success\\":true", "消息":"修改积分失败"}]}', 'Block', '', '')
2016-11-30 12:25:00,238 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 12:25:00,238 casestep.py[line: 160] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_json
2016-11-30 12:25:00,238 casestep.py[line: 104] INFO: 转换后的参数体为：{'code': '17817738178', 'bonus': 37593}
2016-11-30 12:25:00,238 casestep.py[line: 110] INFO: 没找到需要替换的动态参数
2016-11-30 12:25:00,238 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[CaseStep.device_no]
2016-11-30 12:25:00,238 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_product_version]
2016-11-30 12:25:00,238 casestep.py[line: 95] INFO: 找到待替换的全局动态参数：[global_product_version]
2016-11-30 12:25:00,238 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[Token]
2016-11-30 12:25:00,238 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[CaseStep.serial_no]
2016-11-30 12:25:00,239 casestep.py[line: 81] INFO: 找到待替换的非全局动态参数：[OperatorId]
2016-11-30 12:25:00,239 casestep.py[line: 104] INFO: 转换后的参数体为：{'DeviceId': '182590014248006', 'ProtocolVersion': '3.2.12C', 'ProductVersion': '3.2.12C', 'Token': '2d93ac16-f6f7-4627-b88f-2f847b33ee5f', 'Content-Type': 'application/json;charset=utf-8', 'SerialNo': 'HZ501FZA0F9M07D', 'OperatorId': 1318}
2016-11-30 12:25:00,239 InterfaceUnittestTestCase.py[line: 88] INFO: 正在发起POST请求...
2016-11-30 12:25:00,239 httpprotocol.py[line: 74] INFO: 发起的请求为：https://saofu.client.test.saofu.cn:443/saofu-client/customer/customer_bonus_update_v3
2016-11-30 12:25:00,239 httpprotocol.py[line: 75] INFO: 参数为：b'{"code": "17817738178", "bonus": 37593}'
2016-11-30 12:25:00,239 httpprotocol.py[line: 76] INFO: 请求头为：{'DeviceId': '182590014248006', 'ProtocolVersion': '3.2.12C', 'ProductVersion': '3.2.12C', 'Token': '2d93ac16-f6f7-4627-b88f-2f847b33ee5f', 'Content-Type': 'application/json;charset=utf-8', 'SerialNo': 'HZ501FZA0F9M07D', 'OperatorId': 1318}
2016-11-30 12:25:00,637 InterfaceUnittestTestCase.py[line: 98] INFO: 正在对服务器返回body进行解码
2016-11-30 12:25:00,638 InterfaceUnittestTestCase.py[line: 112] INFO: 服务器返回结果"响应体(body)": {"bonus":37593,"code":"4001","success":true}
2016-11-30 12:25:00,638 InterfaceUnittestTestCase.py[line: 113] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 04:25:04 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('Vary', 'Accept-Encoding')]
2016-11-30 12:25:00,639 InterfaceUnittestTestCase.py[line: 114] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 12:25:00,639 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为：success":true
2016-11-30 12:25:00,639 unittesttestcase.py[line: 292] WARNING: 未检测到从服务器返回中提取内容的要求，请检查是否正确填写预期结果
2016-11-30 12:25:00,639 testcase.py[line: 155] INFO: 正在更新步骤执行结果
2016-11-30 12:25:00,639 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="post", runtime="2016-11-30 12:25:00",step_action="{'请求头': {'DeviceId': '182590014248006', 'ProtocolVersion': '3.2.12C', 'ProductVersion': '3.2.12C', 'Token': '2d93ac16-f6f7-4627-b88f-2f847b33ee5f', 'Content-Type': 'application/json;charset=utf-8', 'SerialNo': 'HZ501FZA0F9M07D', 'OperatorId': 1318}, 'url': '/saofu-client/customer/customer_bonus_update_v3', '参数': {'code': '17817738178', 'bonus': 37593}, '方法': 'post', '函数': 'test_interface_of_json'}", expected_results="{'检查': 'body', '匹配规则': '包含字符串', '条件': [{'消息': '修改积分失败', '模式': 'success':true'}]}" WHERE executed_history_id = 20161130122456 AND testcase_id = 152 AND step_id = 154 AND project='pj_pos' AND testplan='plan1_of_pos'
2016-11-30 12:25:00,641 testcase.py[line: 158] INFO: 测试用例[id=152, name=test-n-修改积分]执行成功
2016-11-30 12:25:00,642 testplan.py[line: 76] INFO: 正在更新用例执行结果
2016-11-30 12:25:00,642 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 12:25:00" WHERE executed_history_id = 20161130122456 AND testcase_id = 152 AND project='pj_pos' AND testplan='plan1_of_pos'
2016-11-30 12:25:00,760 testplan.py[line: 87] INFO: 正在更新testlink上测试计划[testplan_id=146, bulid_version=v1.0.0],对应用例[testcase_id=152]的执行结果
2016-11-30 12:25:00,890 testplan.py[line: 97] INFO: 测试计划[project=pj_pos ,testplan=plan1_of_pos]已执行完
2016-11-30 12:25:00,890 main.py[line: 248] INFO: 接口测试已执行完成，正在关闭数据库连接
2016-11-30 12:25:00,891 htmlreporter.py[line: 37] INFO: 正在查询测试用例总数
2016-11-30 12:25:00,891 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE executed_history_id = %s  data：('20161130122456',)
2016-11-30 12:25:00,894 htmlreporter.py[line: 43] INFO: 正在查询执行通过的用例数
2016-11-30 12:25:00,894 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE runresult = %s AND executed_history_id = %s  data：('Pass', '20161130122456')
2016-11-30 12:25:00,896 htmlreporter.py[line: 49] INFO: 正在查询执行失败的用例数
2016-11-30 12:25:00,896 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE runresult = %s AND executed_history_id = %s  data：('Fail', '20161130122456')
2016-11-30 12:25:00,897 htmlreporter.py[line: 55] INFO: 正在查询执行出错的用例数
2016-11-30 12:25:00,897 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE runresult = %s AND executed_history_id = %s  data：('Error', '20161130122456')
2016-11-30 12:25:00,898 htmlreporter.py[line: 61] INFO: 正在查询未执行的用例数
2016-11-30 12:25:00,898 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE runresult = %s AND executed_history_id = %s  data：('Block', '20161130122456')
2016-11-30 12:25:00,900 htmlreporter.py[line: 72] INFO: 正在查询已运的测试计划
2016-11-30 12:25:00,900 mydb.py[line: 100] INFO: query：SELECT project, testplan FROM testcase_report_tb WHERE executed_history_id = %s GROUP BY project, testplan ORDER BY id ASC  data：('20161130122456',)
2016-11-30 12:25:00,902 htmlreporter.py[line: 98] INFO: 正在查询测试计划[project：pj_pos, testplan：无计划]的测试用例执行结果
2016-11-30 12:25:00,902 mydb.py[line: 100] INFO: query：SELECT id, executed_history_id, testcase_id, testcase_name,testsuit, testplan, project, runresult, runtime FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s GROUP BY testcase_id ORDER BY id ASC  data：('pj_pos', '无计划', '20161130122456')
2016-11-30 12:25:00,904 htmlreporter.py[line: 105] INFO: 正在记录测试测试计划[project：pj_pos, testplan：无计划]的测试用例运行结果到测试报告
2016-11-30 12:25:00,904 htmlreporter.py[line: 98] INFO: 正在查询测试计划[project：pj_pos, testplan：plan1_of_pos]的测试用例执行结果
2016-11-30 12:25:00,904 mydb.py[line: 100] INFO: query：SELECT id, executed_history_id, testcase_id, testcase_name,testsuit, testplan, project, runresult, runtime FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s GROUP BY testcase_id ORDER BY id ASC  data：('pj_pos', 'plan1_of_pos', '20161130122456')
2016-11-30 12:25:00,906 htmlreporter.py[line: 105] INFO: 正在记录测试测试计划[project：pj_pos, testplan：plan1_of_pos]的测试用例运行结果到测试报告
2016-11-30 12:25:00,907 htmlreporter.py[line: 115] INFO: 正在查询已运的测试计划
2016-11-30 12:25:00,907 mydb.py[line: 100] INFO: query：SELECT project, testplan FROM testcase_report_tb WHERE executed_history_id = %s GROUP BY project, testplan ORDER BY id ASC  data：('20161130122456',)
2016-11-30 12:25:00,910 htmlreporter.py[line: 127] INFO: 正在查询测试计划[project：pj_pos, testplan：无计划]已运行的测试用例
2016-11-30 12:25:00,910 mydb.py[line: 100] INFO: query：SELECT testcase_id, testcase_name, project, testplan FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s  GROUP BY testcase_id ORDER BY id ASC  data：('pj_pos', '无计划', '20161130122456')
2016-11-30 12:25:00,912 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=148]步骤运行结果
2016-11-30 12:25:00,912 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_pos', '无计划', 148, '20161130122456')
2016-11-30 12:25:00,914 htmlreporter.py[line: 127] INFO: 正在查询测试计划[project：pj_pos, testplan：plan1_of_pos]已运行的测试用例
2016-11-30 12:25:00,915 mydb.py[line: 100] INFO: query：SELECT testcase_id, testcase_name, project, testplan FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s  GROUP BY testcase_id ORDER BY id ASC  data：('pj_pos', 'plan1_of_pos', '20161130122456')
2016-11-30 12:25:00,921 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=152]步骤运行结果
2016-11-30 12:25:00,922 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_pos', 'plan1_of_pos', 152, '20161130122456')
2016-11-30 12:25:00,924 htmlreporter.py[line: 183] INFO: 正在设置测试报告结果文件名
2016-11-30 12:25:00,925 htmlreporter.py[line: 193] INFO: 测试报告文件名所在路径为：E:\\Projects\\report\\test_report20161130122456.html
2016-11-30 12:25:00,925 htmlreporter.py[line: 186] INFO: 正在生成测试报告
2016-11-30 12:25:00,926 main.py[line: 271] INFO: 生成测试报告成功
2016-11-30 12:25:01,042 main.py[line: 278] INFO: E:\\Projects\\report\\test_report20161130122456.html
2016-11-30 12:25:01,043 main.py[line: 281] INFO: 正在发送测试报告邮件...
2016-11-30 12:25:01,081 main.py[line: 285] INFO: 发送邮件成功
2016-11-30 15:42:17,229 global_var.py[line: 20] INFO: 当前运行环境：测试环境
2016-11-30 15:42:17,229 global_var.py[line: 21] INFO: 正在初始化数据库[名称：SAOFUDB1]对象
2016-11-30 15:42:17,242 global_var.py[line: 28] INFO: 正在初始化数据库[名称：TESTDB]对象
2016-11-30 15:42:17,244 global_var.py[line: 31] INFO: 正在获取testlink
2016-11-30 15:42:17,294 main.py[line: 57] INFO: 正在创建测试用例报告报表
2016-11-30 15:42:17,294 mydb.py[line: 43] INFO: query：CREATE TABLE IF NOT EXISTS testcase_report_tb                                         (id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,                                          executed_history_id varchar(50) NOT NULL,                                          testcase_id int NOT NULL,                                          testcase_name varchar(40) NOT NULL,                                          testsuit varchar(40),                                          testplan varchar(40),                                          project varchar(40),                                          runresult varchar(20),                                          runtime datetime)
2016-11-30 15:42:17,296 main.py[line: 60] INFO: 正在创建测试步骤报告报表
2016-11-30 15:42:17,296 mydb.py[line: 43] INFO: query：CREATE TABLE IF NOT EXISTS case_step_report_tb                                         (id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,                                          executed_history_id varchar(50) NOT NULL,                                          testcase_id int NOT NULL,                                          testcase_name varchar(40) NOT NULL,                                          testplan varchar(40) NOT NULL,                                          project varchar(40) NOT NULL,                                          step_id int,                                          step_num int NOT NULL,                                          step_action varchar(1000),                                           expected_results varchar(1000),                                          runresult varchar(10),                                          reason varchar(2000),                                          protocol_method varchar(40) ,                                          protocol varchar(40),                                          host varchar(40),                                          port int,                                          runtime datetime)
2016-11-30 15:42:17,297 main.py[line: 63] INFO: 正在读取运行模式配置
2016-11-30 15:42:17,299 main.py[line: 70] INFO: 正在运行全局初始化用例……
2016-11-30 15:42:17,299 main.py[line: 72] INFO: 待运行全局初始化用例id列表：[148]
2016-11-30 15:42:17,474 global_function.py[line: 19] INFO: 获取测试用例信息 [{'status': '1', 'modification_ts': '2016-11-30 15:41:36', 'author_last_name': 'Administrator', 'full_tc_external_id': 'pj_pos-1', 'preconditions': '<p>\n\t初始化用例</p>\n', 'author_login': 'admin', 'updater_last_name': 'Administrator', 'steps': [{'execution_type': '1', 'active': '1', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;branch_id&quot;:1}<br />\n\t}</p>\n', 'step_number': '1', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT branch_id FROM account_operator WHERE id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;(1318,)&quot;</p>\n<p>\n\t}</p>\n', 'id': '183'}, {'execution_type': '1', 'active': '1', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;device_no&quot;:1,&quot;serial_no&quot;:2}<br />\n\t}</p>\n', 'step_number': '2', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;([CaseStep.branch_id],)&quot;</p>\n<p>\n\t}</p>\n', 'id': '182'}, {'execution_type': '1', 'active': '1', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;：&quot;键值相等&quot;,</p>\n<p>\n\t&quot;条件&quot;：[{&quot;模式&quot;：{&quot;success&quot;:true}, &quot;消息&quot;：&ldquo;登录失败，success不为true&rdquo;},{&quot;模式&quot;：｛&quot;message&quot;: &quot;成功&quot;},&quot;消息&quot;：&ldquo;message不为成功&rdquo;}，{&quot;模式&quot;：｛&quot;code&quot;: &quot;4001&quot;},&quot;消息&quot;：&ldquo;code不为4001&rdquo;}],</p>\n<p>\n\t&quot;输出&quot;:{&quot;Token&quot;:{&quot;token&quot;:&quot;value&quot;},&quot;OperatorId&quot;:{&quot;operator&quot;:{&quot;id&quot;:&quot;value&quot;}}}</p>\n<p>\n\t}</p>\n', 'step_number': '3', 'actions': '<p>\n\t{&ldquo;函数&rdquo;：&ldquo;<span style="background-color:#e4e4ff;">test_interface_of_json</span>&rdquo;，</p>\n<p>\n\t&ldquo;请求头&rdquo;： {&quot;<span style="color:#008080;font-weight:bold;">DeviceId&quot;</span>:&quot;[CaseStep.device_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;SerialNo&quot;</span>:&quot;[CaseStep.serial_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;Content-Type&quot;</span>:&quot;<span style="color:#008080;font-weight:bold;">application/json;charset=utf-8&quot;</span>,<span style="color:#008080;font-weight:bold;">&quot;ProductVersion&quot;</span>: &quot;[global_product_version]&quot;, <span style="color:#008080;font-weight:bold;">&quot;ProtocolVersion&quot;</span>:&quot;[global_protocol_version]&quot;},</p>\n<p>\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/saofu-client/password/login&quot;,<br />\n\t&quot;参数&quot;:{&quot;id&quot;:&quot;1318&quot;,&quot;password&quot;:&quot;e10adc3949ba59abbe56e057f20f883e&quot;}<br />\n\t}</p>\n', 'id': '150'}], 'creation_ts': '2016-07-27 18:32:10', 'active': '1', 'version': '1', 'updater_first_name': 'Testlink', 'updater_id': '1', 'tc_external_id': '1', 'summary': '', 'name': 'test-n-登陆掌贝pos机', 'updater_login': 'admin', 'author_id': '1', 'node_order': '1000', 'testcase_id': '148', 'layout': '1', 'author_first_name': 'Testlink', 'execution_type': '1', 'is_open': '1', 'id': '149', 'importance': '2', 'estimated_exec_duration': '', 'testsuite_id': '147'}]
2016-11-30 15:42:17,638 global_function.py[line: 39] INFO: 正在读取套件[id=147]的协议，host，端口配置...
2016-11-30 15:42:18,258 global_function.py[line: 68] INFO: 记录测试用例到测试用例报表
2016-11-30 15:42:18,258 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130154217', 148, 'test-n-登陆掌贝pos机', '登陆接口', '无计划', 'pj_pos', 'Block', '')
2016-11-30 15:42:18,259 global_function.py[line: 71] INFO: 开始执行测试用例[id=148，name=test-n-登陆掌贝pos机]
2016-11-30 15:42:18,259 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行sql","单条查询":"SELECT branch_id FROM account_operator WHERE id = %s","参数":"(1318,)"}
2016-11-30 15:42:18,260 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","输出":{"branch_id":1}}
2016-11-30 15:42:18,260 testcase.py[line: 55] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 15:42:18,260 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130154217', 148, 'test-n-登陆掌贝pos机', '无计划', 'pj_pos', 183, 1, '', '', '192.168.9.211', '3306', '{"步骤类型":"执行sql","单条查询":"SELECT branch_id FROM account_operator WHERE id = %s","参数":"(1318,)"}', '{"检查":"body","输出":{"branch_id":1}}', 'Block', '', '')
2016-11-30 15:42:18,261 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 15:42:18,261 casestep.py[line: 108] INFO: 没找到需要替换的动态参数
2016-11-30 15:42:18,262 mydb.py[line: 84] INFO: query：SELECT branch_id FROM account_operator WHERE id = %s  data：(1318,)
2016-11-30 15:42:18,264 casestep.py[line: 188] INFO: 数据库服务器返回的查询结果为为 query_result:(1485916418,), flag:True
2016-11-30 15:42:18,264 casestep.py[line: 190] INFO: 正在保存服务器返回结果到自定义变量
2016-11-30 15:42:18,265 casestep.py[line: 225] INFO: 提取的输出结果(key-value对)为:[{'branch_id': 1485916418}]
2016-11-30 15:42:18,265 testcase.py[line: 155] INFO: 正在更新步骤执行结果
2016-11-30 15:42:18,265 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 15:42:18",step_action="{'参数': (1318,), '单条查询': 'SELECT branch_id FROM account_operator WHERE id = %s', '步骤类型': '执行sql'}", expected_results="{'检查': 'body', '输出': {'branch_id': 1}}" WHERE executed_history_id = 20161130154217 AND testcase_id = 148 AND step_id = 183 AND project='pj_pos' AND testplan='无计划'
2016-11-30 15:42:18,267 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行sql","单条查询":"SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s","参数":"([CaseStep.branch_id],)"}
2016-11-30 15:42:18,267 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","输出":{"device_no":1,"serial_no":2}}
2016-11-30 15:42:18,268 testcase.py[line: 55] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 15:42:18,268 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130154217', 148, 'test-n-登陆掌贝pos机', '无计划', 'pj_pos', 182, 2, '', '', '192.168.9.211', '3306', '{"步骤类型":"执行sql","单条查询":"SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s","参数":"([CaseStep.branch_id],)"}', '{"检查":"body","输出":{"device_no":1,"serial_no":2}}', 'Block', '', '')
2016-11-30 15:42:18,269 testcase.py[line: 77] INFO: 开始执行步骤操作[第2步]
2016-11-30 15:42:18,269 casestep.py[line: 113] INFO: 找到待替换的非全局动态参数：[CaseStep.branch_id]
2016-11-30 15:42:18,270 casestep.py[line: 136] INFO: 转换后的参数体为：(1485916418,)
2016-11-30 15:42:18,270 mydb.py[line: 84] INFO: query：SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s  data：(1485916418,)
2016-11-30 15:42:18,273 casestep.py[line: 188] INFO: 数据库服务器返回的查询结果为为 query_result:('182590014248006', 'HZ501FZA0F9M07D'), flag:True
2016-11-30 15:42:18,273 casestep.py[line: 190] INFO: 正在保存服务器返回结果到自定义变量
2016-11-30 15:42:18,274 casestep.py[line: 225] INFO: 提取的输出结果(key-value对)为:[{'branch_id': 1485916418}, {'device_no': '182590014248006'}, {'serial_no': 'HZ501FZA0F9M07D'}]
2016-11-30 15:42:18,274 testcase.py[line: 155] INFO: 正在更新步骤执行结果
2016-11-30 15:42:18,274 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 15:42:18",step_action="{'参数': (1485916418,), '单条查询': 'SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s', '步骤类型': '执行sql'}", expected_results="{'检查': 'body', '输出': {'serial_no': 2, 'device_no': 1}}" WHERE executed_history_id = 20161130154217 AND testcase_id = 148 AND step_id = 182 AND project='pj_pos' AND testplan='无计划'
2016-11-30 15:42:18,277 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"函数":"test_interface_of_json","请求头": {"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion": "[global_product_version]", "ProtocolVersion":"[global_protocol_version]"},"方法":"post","url":"/saofu-client/password/login","参数":{"id":"1318","password":"e10adc3949ba59abbe56e057f20f883e"}}
2016-11-30 15:42:18,278 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"键值相等","条件":[{"模式":{"success":true}, "消息":"登录失败,success不为true"},{"模式":{"message": "成功"},"消息":"message不为成功"},{"模式":{"code": "4001"},"消息":"code不为4001"}],"输出":{"Token":{"token":"value"},"OperatorId":{"operator":{"id":"value"}}}}
2016-11-30 15:42:18,278 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 15:42:18,278 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130154217', 148, 'test-n-登陆掌贝pos机', '无计划', 'pj_pos', 150, 3, '', 'https', 'saofu.client.test.saofu.cn', 443, '{"函数":"test_interface_of_json","请求头": {"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion": "[global_product_version]", "ProtocolVersion":"[global_protocol_version]"},"方法":"post","url":"/saofu-client/password/login","参数":{"id":"1318","password":"e10adc3949ba59abbe56e057f20f883e"}}', '{"检查":"body","匹配规则":"键值相等","条件":[{"模式":{"success":true}, "消息":"登录失败,success不为true"},{"模式":{"message": "成功"},"消息":"message不为成功"},{"模式":{"code": "4001"},"消息":"code不为4001"}],"输出":{"Token":{"token":"value"},"OperatorId":{"operator":{"id":"value"}}}}', 'Block', '', '')
2016-11-30 15:42:18,280 testcase.py[line: 77] INFO: 开始执行步骤操作[第3步]
2016-11-30 15:42:18,280 casestep.py[line: 158] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_json
2016-11-30 15:42:18,280 casestep.py[line: 102] INFO: 转换后的参数体为：{'password': 'e10adc3949ba59abbe56e057f20f883e', 'id': '1318'}
2016-11-30 15:42:18,280 casestep.py[line: 108] INFO: 没找到需要替换的动态参数
2016-11-30 15:42:18,280 casestep.py[line: 79] INFO: 找到待替换的非全局动态参数：[CaseStep.device_no]
2016-11-30 15:42:18,281 casestep.py[line: 93] INFO: 找到待替换的全局动态参数：[global_protocol_version]
2016-11-30 15:42:18,281 casestep.py[line: 93] INFO: 找到待替换的全局动态参数：[global_product_version]
2016-11-30 15:42:18,281 casestep.py[line: 79] INFO: 找到待替换的非全局动态参数：[CaseStep.serial_no]
2016-11-30 15:42:18,281 casestep.py[line: 102] INFO: 转换后的参数体为：{'DeviceId': '182590014248006', 'Content-Type': 'application/json;charset=utf-8', 'ProtocolVersion': '4.0', 'ProductVersion': '3.2.12C', 'SerialNo': 'HZ501FZA0F9M07D'}
2016-11-30 15:42:18,281 InterfaceUnittestTestCase.py[line: 88] INFO: 正在发起POST请求...
2016-11-30 15:42:18,282 httpprotocol.py[line: 74] INFO: 发起的请求为：https://saofu.client.test.saofu.cn:443/saofu-client/password/login
2016-11-30 15:42:18,282 httpprotocol.py[line: 75] INFO: 参数为：b'{"password": "e10adc3949ba59abbe56e057f20f883e", "id": "1318"}'
2016-11-30 15:42:18,282 httpprotocol.py[line: 76] INFO: 请求头为：{'DeviceId': '182590014248006', 'Content-Type': 'application/json;charset=utf-8', 'ProtocolVersion': '4.0', 'SerialNo': 'HZ501FZA0F9M07D', 'ProductVersion': '3.2.12C'}
2016-11-30 15:42:19,784 InterfaceUnittestTestCase.py[line: 98] INFO: 正在对服务器返回body进行解码
2016-11-30 15:42:19,784 InterfaceUnittestTestCase.py[line: 112] INFO: 服务器返回结果"响应体(body)": {"attach":["flag_appointment","flag_app_xiaoer","flag_cardcupon","flag_cash","flag_help_center","flag_info_center","flag_in_shop","flag_lake","flag_mt_wm","flag_order","flag_qrscan","flag_queue","flag_zhanggui"],"branchSerial":"cao","code":"4001","merchantKey":"10549840601068216320","message":"成功","operator":{"id":1318,"name":"接口测试","number":"1"},"reason":"成功","shopId":"1485916418","success":true,"token":"9eb843c6-179d-427a-8d86-2c9035fa9ae3"}
2016-11-30 15:42:19,784 InterfaceUnittestTestCase.py[line: 113] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 07:42:22 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('EXCLUDE_ENCRYPT', 'true'), ('Vary', 'Accept-Encoding')]
2016-11-30 15:42:19,784 InterfaceUnittestTestCase.py[line: 114] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 15:42:19,785 unittesttestcase.py[line: 106] INFO: 要匹配的字典key,value层级为：['success', True]
2016-11-30 15:42:19,785 unittesttestcase.py[line: 109] INFO: 找到的对应字典层级的最后值为：True
2016-11-30 15:42:19,785 unittesttestcase.py[line: 106] INFO: 要匹配的字典key,value层级为：['message', '成功']
2016-11-30 15:42:19,785 unittesttestcase.py[line: 109] INFO: 找到的对应字典层级的最后值为：成功
2016-11-30 15:42:19,785 unittesttestcase.py[line: 106] INFO: 要匹配的字典key,value层级为：['code', '4001']
2016-11-30 15:42:19,785 unittesttestcase.py[line: 109] INFO: 找到的对应字典层级的最后值为：4001
2016-11-30 15:42:19,785 unittesttestcase.py[line: 225] INFO: 要提取的字典key,value层级为：['token', 'value']
2016-11-30 15:42:19,785 unittesttestcase.py[line: 239] INFO: 找到的对应字典层级的key的值为：9eb843c6-179d-427a-8d86-2c9035fa9ae3
2016-11-30 15:42:19,785 unittesttestcase.py[line: 263] INFO: 获取到的变量的值为：9eb843c6-179d-427a-8d86-2c9035fa9ae3
2016-11-30 15:42:19,786 unittesttestcase.py[line: 225] INFO: 要提取的字典key,value层级为：['operator', 'id', 'value']
2016-11-30 15:42:19,786 unittesttestcase.py[line: 239] INFO: 找到的对应字典层级的key的值为：1318
2016-11-30 15:42:19,786 unittesttestcase.py[line: 263] INFO: 获取到的变量的值为：1318
2016-11-30 15:42:19,786 unittesttestcase.py[line: 290] INFO: 提取的输出结果(key-value对)为:[{'Token': '9eb843c6-179d-427a-8d86-2c9035fa9ae3'}, {'OperatorId': 1318}]
2016-11-30 15:42:19,786 testcase.py[line: 155] INFO: 正在更新步骤执行结果
2016-11-30 15:42:19,786 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="post", runtime="2016-11-30 15:42:18",step_action="{'请求头': {'DeviceId': '182590014248006', 'Content-Type': 'application/json;charset=utf-8', 'ProtocolVersion': '4.0', 'ProductVersion': '3.2.12C', 'SerialNo': 'HZ501FZA0F9M07D'}, 'url': '/saofu-client/password/login', '参数': {'password': 'e10adc3949ba59abbe56e057f20f883e', 'id': '1318'}, '函数': 'test_interface_of_json', '方法': 'post'}", expected_results="{'检查': 'body', '条件': [{'消息': '登录失败,success不为true', '模式': {'success': True}}, {'消息': 'message不为成功', '模式': {'message': '成功'}}, {'消息': 'code不为4001', '模式': {'code': '4001'}}], '输出': {'Token': {'token': 'value'}, 'OperatorId': {'operator': {'id': 'value'}}}, '匹配规则': '键值相等'}" WHERE executed_history_id = 20161130154217 AND testcase_id = 148 AND step_id = 150 AND project='pj_pos' AND testplan='无计划'
2016-11-30 15:42:19,788 testcase.py[line: 158] INFO: 测试用例[id=148, name=test-n-登陆掌贝pos机]执行成功
2016-11-30 15:42:19,788 global_function.py[line: 75] INFO: 正在更新用例执行结果
2016-11-30 15:42:19,789 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 15:42:18" WHERE executed_history_id = 20161130154217 and testcase_id = 148 AND project='pj_pos' AND testplan='无计划'
2016-11-30 15:42:19,790 global_function.py[line: 82] INFO: 指定用例[148]已执行完
2016-11-30 15:42:19,790 main.py[line: 75] INFO: 用例[148]运行结果：('Pass', '')
2016-11-30 15:42:19,790 main.py[line: 78] INFO: 按项目运行测试
2016-11-30 15:42:19,791 main.py[line: 115] INFO: 运行指定项目
2016-11-30 15:42:19,922 main.py[line: 131] INFO: 正在读取测项目[id：145, project：pj_pos]的协议，host，端口配置...
2016-11-30 15:42:19,922 main.py[line: 134] INFO: 成功读取配置信息：{"protocol":"https","host":"saofu.client.test.saofu.cn","port":443}
2016-11-30 15:42:19,924 main.py[line: 150] INFO: 正在执行测试项目[id：145, project：pj_pos]
2016-11-30 15:42:19,924 testproject.py[line: 23] INFO: 正在获取测试项目[id：145, name：pj_pos]对应对应的测试计划名称列表
2016-11-30 15:42:20,051 testproject.py[line: 28] INFO: 成功获取项目测试计划名称列表[list=['plan1_of_pos']]
2016-11-30 15:42:20,175 testproject.py[line: 38] INFO: 正在执行项目测试计划[project：pj_pos，testplan：plan1_of_pos]
2016-11-30 15:42:20,176 testplan.py[line: 29] INFO: 正在获取测试计划[project=pj_pos，name=plan1_of_pos]的测试用例
2016-11-30 15:42:20,332 testplan.py[line: 35] INFO: 成功获取测试计划[project=pj_pos，name=plan1_of_pos]的测试用例id：dict_keys(['152', '148'])
2016-11-30 15:42:20,487 testplan.py[line: 45] INFO: 获取测试用例信息 [{'status': '1', 'modification_ts': '2016-11-30 00:19:08', 'author_last_name': 'Administrator', 'full_tc_external_id': 'pj_pos-2', 'preconditions': '', 'author_login': 'admin', 'updater_last_name': 'Administrator', 'steps': [{'execution_type': '1', 'active': '1', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;:&quot;包含字符串&quot;,</p>\n<p>\n\t&quot;条件&quot;:[{&quot;模式&quot;:&quot;success\\&quot;:true&quot;, &quot;消息&quot;:&quot;修改积分失败&quot;}]</p>\n<p>\n\t}</p>\n', 'step_number': '1', 'actions': '<p>\n\t<br />\n\t{&quot;函数&quot;：&quot;test_interface_of_json&quot;，</p>\n<p>\n\t&quot;请求头&quot;:{&quot;DeviceId&quot;:&quot;[CaseStep.device_no]&quot;, &quot;SerialNo&quot;:&quot;[CaseStep.serial_no]&quot;, &quot;Content-Type&quot;:&quot;application/json;charset=utf-8&quot;,&quot;ProductVersion&quot;:&quot;[global_product_version]&quot;,&quot;ProtocolVersion&quot;:&quot;[global_product_version]&quot;,&quot;OperatorId&quot;:&quot;[OperatorId]&quot;, &quot;Token&quot;:&quot;[Token]&quot;},</p>\n<p>\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/saofu-client/customer/customer_bonus_update_v3&quot;,<br />\n\t&quot;参数&quot;:{&quot;bonus&quot;:37593,&quot;code&quot;:&quot;17817738178&quot;}<br />\n\t}<br />\n\t&nbsp;</p>\n', 'id': '154'}], 'creation_ts': '2016-07-28 12:10:09', 'active': '1', 'version': '1', 'updater_first_name': 'Testlink', 'updater_id': '1', 'tc_external_id': '2', 'summary': '', 'name': 'test-n-修改积分', 'updater_login': 'admin', 'author_id': '1', 'node_order': '1000', 'testcase_id': '152', 'layout': '1', 'author_first_name': 'Testlink', 'execution_type': '1', 'is_open': '1', 'id': '153', 'importance': '2', 'estimated_exec_duration': '', 'testsuite_id': '151'}]
2016-11-30 15:42:20,644 testplan.py[line: 69] INFO: 记录测试用例到测试用例报表
2016-11-30 15:42:20,644 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130154217', 152, 'test-n-修改积分', '扫码-修改积分接口', 'plan1_of_pos', 'pj_pos', 'Block', '')
2016-11-30 15:42:20,646 testplan.py[line: 72] INFO: 开始执行测试用例[id=152，name=test-n-修改积分]
2016-11-30 15:42:20,646 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"函数":"test_interface_of_json","请求头":{"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion":"[global_product_version]","ProtocolVersion":"[global_product_version]","OperatorId":"[OperatorId]", "Token":"[Token]"},"方法":"post","url":"/saofu-client/customer/customer_bonus_update_v3","参数":{"bonus":37593,"code":"17817738178"}} 
2016-11-30 15:42:20,647 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"success\":true", "消息":"修改积分失败"}]}
2016-11-30 15:42:20,647 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 15:42:20,647 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130154217', 152, 'test-n-修改积分', 'plan1_of_pos', 'pj_pos', 154, 1, '', 'https', 'saofu.client.test.saofu.cn', 443, '{"函数":"test_interface_of_json","请求头":{"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion":"[global_product_version]","ProtocolVersion":"[global_product_version]","OperatorId":"[OperatorId]", "Token":"[Token]"},"方法":"post","url":"/saofu-client/customer/customer_bonus_update_v3","参数":{"bonus":37593,"code":"17817738178"}} ', '{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"success\\":true", "消息":"修改积分失败"}]}', 'Block', '', '')
2016-11-30 15:42:20,650 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 15:42:20,650 casestep.py[line: 158] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_json
2016-11-30 15:42:20,650 casestep.py[line: 102] INFO: 转换后的参数体为：{'code': '17817738178', 'bonus': 37593}
2016-11-30 15:42:20,650 casestep.py[line: 108] INFO: 没找到需要替换的动态参数
2016-11-30 15:42:20,650 casestep.py[line: 79] INFO: 找到待替换的非全局动态参数：[Token]
2016-11-30 15:42:20,651 casestep.py[line: 79] INFO: 找到待替换的非全局动态参数：[CaseStep.device_no]
2016-11-30 15:42:20,651 casestep.py[line: 79] INFO: 找到待替换的非全局动态参数：[OperatorId]
2016-11-30 15:42:20,651 casestep.py[line: 79] INFO: 找到待替换的非全局动态参数：[CaseStep.serial_no]
2016-11-30 15:42:20,651 casestep.py[line: 93] INFO: 找到待替换的全局动态参数：[global_product_version]
2016-11-30 15:42:20,651 casestep.py[line: 93] INFO: 找到待替换的全局动态参数：[global_product_version]
2016-11-30 15:42:20,651 casestep.py[line: 102] INFO: 转换后的参数体为：{'Token': '9eb843c6-179d-427a-8d86-2c9035fa9ae3', 'DeviceId': '182590014248006', 'Content-Type': 'application/json;charset=utf-8', 'OperatorId': 1318, 'SerialNo': 'HZ501FZA0F9M07D', 'ProtocolVersion': '3.2.12C', 'ProductVersion': '3.2.12C'}
2016-11-30 15:42:20,652 InterfaceUnittestTestCase.py[line: 88] INFO: 正在发起POST请求...
2016-11-30 15:42:20,652 httpprotocol.py[line: 74] INFO: 发起的请求为：https://saofu.client.test.saofu.cn:443/saofu-client/customer/customer_bonus_update_v3
2016-11-30 15:42:20,652 httpprotocol.py[line: 75] INFO: 参数为：b'{"code": "17817738178", "bonus": 37593}'
2016-11-30 15:42:20,652 httpprotocol.py[line: 76] INFO: 请求头为：{'Token': '9eb843c6-179d-427a-8d86-2c9035fa9ae3', 'DeviceId': '182590014248006', 'Content-Type': 'application/json;charset=utf-8', 'OperatorId': 1318, 'SerialNo': 'HZ501FZA0F9M07D', 'ProtocolVersion': '3.2.12C', 'ProductVersion': '3.2.12C'}
2016-11-30 15:42:21,079 InterfaceUnittestTestCase.py[line: 98] INFO: 正在对服务器返回body进行解码
2016-11-30 15:42:21,081 InterfaceUnittestTestCase.py[line: 112] INFO: 服务器返回结果"响应体(body)": {"bonus":37593,"code":"4001","success":true}
2016-11-30 15:42:21,082 InterfaceUnittestTestCase.py[line: 113] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 07:42:23 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('Vary', 'Accept-Encoding')]
2016-11-30 15:42:21,082 InterfaceUnittestTestCase.py[line: 114] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 15:42:21,082 unittesttestcase.py[line: 64] INFO: 要匹配的模式（子字符串）为：success":true
2016-11-30 15:42:21,083 unittesttestcase.py[line: 292] WARNING: 未检测到从服务器返回中提取内容的要求，请检查是否正确填写预期结果
2016-11-30 15:42:21,083 testcase.py[line: 155] INFO: 正在更新步骤执行结果
2016-11-30 15:42:21,083 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="post", runtime="2016-11-30 15:42:20",step_action="{'请求头': {'Token': '9eb843c6-179d-427a-8d86-2c9035fa9ae3', 'DeviceId': '182590014248006', 'Content-Type': 'application/json;charset=utf-8', 'OperatorId': 1318, 'SerialNo': 'HZ501FZA0F9M07D', 'ProtocolVersion': '3.2.12C', 'ProductVersion': '3.2.12C'}, 'url': '/saofu-client/customer/customer_bonus_update_v3', '参数': {'code': '17817738178', 'bonus': 37593}, '函数': 'test_interface_of_json', '方法': 'post'}", expected_results="{'检查': 'body', '条件': [{'消息': '修改积分失败', '模式': 'success':true'}], '匹配规则': '包含字符串'}" WHERE executed_history_id = 20161130154217 AND testcase_id = 152 AND step_id = 154 AND project='pj_pos' AND testplan='plan1_of_pos'
2016-11-30 15:42:21,118 testcase.py[line: 158] INFO: 测试用例[id=152, name=test-n-修改积分]执行成功
2016-11-30 15:42:21,118 testplan.py[line: 76] INFO: 正在更新用例执行结果
2016-11-30 15:42:21,118 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 15:42:20" WHERE executed_history_id = 20161130154217 AND testcase_id = 152 AND project='pj_pos' AND testplan='plan1_of_pos'
2016-11-30 15:42:21,236 testplan.py[line: 87] INFO: 正在更新testlink上测试计划[testplan_id=146, bulid_version=v1.0.0],对应用例[testcase_id=152]的执行结果
2016-11-30 15:42:21,523 testplan.py[line: 45] INFO: 获取测试用例信息 [{'status': '1', 'modification_ts': '2016-11-30 15:41:36', 'author_last_name': 'Administrator', 'full_tc_external_id': 'pj_pos-1', 'preconditions': '<p>\n\t初始化用例</p>\n', 'author_login': 'admin', 'updater_last_name': 'Administrator', 'steps': [{'execution_type': '1', 'active': '1', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;branch_id&quot;:1}<br />\n\t}</p>\n', 'step_number': '1', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT branch_id FROM account_operator WHERE id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;(1318,)&quot;</p>\n<p>\n\t}</p>\n', 'id': '183'}, {'execution_type': '1', 'active': '1', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;device_no&quot;:1,&quot;serial_no&quot;:2}<br />\n\t}</p>\n', 'step_number': '2', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;([CaseStep.branch_id],)&quot;</p>\n<p>\n\t}</p>\n', 'id': '182'}, {'execution_type': '1', 'active': '1', 'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;：&quot;键值相等&quot;,</p>\n<p>\n\t&quot;条件&quot;：[{&quot;模式&quot;：{&quot;success&quot;:true}, &quot;消息&quot;：&ldquo;登录失败，success不为true&rdquo;},{&quot;模式&quot;：｛&quot;message&quot;: &quot;成功&quot;},&quot;消息&quot;：&ldquo;message不为成功&rdquo;}，{&quot;模式&quot;：｛&quot;code&quot;: &quot;4001&quot;},&quot;消息&quot;：&ldquo;code不为4001&rdquo;}],</p>\n<p>\n\t&quot;输出&quot;:{&quot;Token&quot;:{&quot;token&quot;:&quot;value&quot;},&quot;OperatorId&quot;:{&quot;operator&quot;:{&quot;id&quot;:&quot;value&quot;}}}</p>\n<p>\n\t}</p>\n', 'step_number': '3', 'actions': '<p>\n\t{&ldquo;函数&rdquo;：&ldquo;<span style="background-color:#e4e4ff;">test_interface_of_json</span>&rdquo;，</p>\n<p>\n\t&ldquo;请求头&rdquo;： {&quot;<span style="color:#008080;font-weight:bold;">DeviceId&quot;</span>:&quot;[CaseStep.device_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;SerialNo&quot;</span>:&quot;[CaseStep.serial_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;Content-Type&quot;</span>:&quot;<span style="color:#008080;font-weight:bold;">application/json;charset=utf-8&quot;</span>,<span style="color:#008080;font-weight:bold;">&quot;ProductVersion&quot;</span>: &quot;[global_product_version]&quot;, <span style="color:#008080;font-weight:bold;">&quot;ProtocolVersion&quot;</span>:&quot;[global_protocol_version]&quot;},</p>\n<p>\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/saofu-client/password/login&quot;,<br />\n\t&quot;参数&quot;:{&quot;id&quot;:&quot;1318&quot;,&quot;password&quot;:&quot;e10adc3949ba59abbe56e057f20f883e&quot;}<br />\n\t}</p>\n', 'id': '150'}], 'creation_ts': '2016-07-27 18:32:10', 'active': '1', 'version': '1', 'updater_first_name': 'Testlink', 'updater_id': '1', 'tc_external_id': '1', 'summary': '', 'name': 'test-n-登陆掌贝pos机', 'updater_login': 'admin', 'author_id': '1', 'node_order': '1000', 'testcase_id': '148', 'layout': '1', 'author_first_name': 'Testlink', 'execution_type': '1', 'is_open': '1', 'id': '149', 'importance': '2', 'estimated_exec_duration': '', 'testsuite_id': '147'}]
2016-11-30 15:42:21,524 testplan.py[line: 52] INFO: 用例[id=148, name=test-n-登陆掌贝pos机]为全局初始化用例，已跳过执行
2016-11-30 15:42:21,524 testplan.py[line: 97] INFO: 测试计划[project=pj_pos ,testplan=plan1_of_pos]已执行完
2016-11-30 15:42:21,524 main.py[line: 242] INFO: 接口测试已执行完成，正在关闭数据库连接
2016-11-30 15:42:21,525 htmlreporter.py[line: 37] INFO: 正在查询测试用例总数
2016-11-30 15:42:21,525 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE executed_history_id = %s  data：('20161130154217',)
2016-11-30 15:42:21,529 htmlreporter.py[line: 43] INFO: 正在查询执行通过的用例数
2016-11-30 15:42:21,529 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE runresult = %s AND executed_history_id = %s  data：('Pass', '20161130154217')
2016-11-30 15:42:21,530 htmlreporter.py[line: 49] INFO: 正在查询执行失败的用例数
2016-11-30 15:42:21,531 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE runresult = %s AND executed_history_id = %s  data：('Fail', '20161130154217')
2016-11-30 15:42:21,532 htmlreporter.py[line: 55] INFO: 正在查询执行出错的用例数
2016-11-30 15:42:21,532 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE runresult = %s AND executed_history_id = %s  data：('Error', '20161130154217')
2016-11-30 15:42:21,533 htmlreporter.py[line: 61] INFO: 正在查询未执行的用例数
2016-11-30 15:42:21,534 mydb.py[line: 84] INFO: query：SELECT count(testcase_id) FROM testcase_report_tb WHERE runresult = %s AND executed_history_id = %s  data：('Block', '20161130154217')
2016-11-30 15:42:21,535 htmlreporter.py[line: 72] INFO: 正在查询已运的测试计划
2016-11-30 15:42:21,535 mydb.py[line: 100] INFO: query：SELECT project, testplan FROM testcase_report_tb WHERE executed_history_id = %s GROUP BY project, testplan ORDER BY id ASC  data：('20161130154217',)
2016-11-30 15:42:21,537 htmlreporter.py[line: 98] INFO: 正在查询测试计划[project：pj_pos, testplan：无计划]的测试用例执行结果
2016-11-30 15:42:21,537 mydb.py[line: 100] INFO: query：SELECT id, executed_history_id, testcase_id, testcase_name,testsuit, testplan, project, runresult, runtime FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s GROUP BY testcase_id ORDER BY id ASC  data：('pj_pos', '无计划', '20161130154217')
2016-11-30 15:42:21,539 htmlreporter.py[line: 105] INFO: 正在记录测试测试计划[project：pj_pos, testplan：无计划]的测试用例运行结果到测试报告
2016-11-30 15:42:21,539 htmlreporter.py[line: 98] INFO: 正在查询测试计划[project：pj_pos, testplan：plan1_of_pos]的测试用例执行结果
2016-11-30 15:42:21,540 mydb.py[line: 100] INFO: query：SELECT id, executed_history_id, testcase_id, testcase_name,testsuit, testplan, project, runresult, runtime FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s GROUP BY testcase_id ORDER BY id ASC  data：('pj_pos', 'plan1_of_pos', '20161130154217')
2016-11-30 15:42:21,541 htmlreporter.py[line: 105] INFO: 正在记录测试测试计划[project：pj_pos, testplan：plan1_of_pos]的测试用例运行结果到测试报告
2016-11-30 15:42:21,542 htmlreporter.py[line: 115] INFO: 正在查询已运的测试计划
2016-11-30 15:42:21,542 mydb.py[line: 100] INFO: query：SELECT project, testplan FROM testcase_report_tb WHERE executed_history_id = %s GROUP BY project, testplan ORDER BY id ASC  data：('20161130154217',)
2016-11-30 15:42:21,544 htmlreporter.py[line: 127] INFO: 正在查询测试计划[project：pj_pos, testplan：无计划]已运行的测试用例
2016-11-30 15:42:21,544 mydb.py[line: 100] INFO: query：SELECT testcase_id, testcase_name, project, testplan FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s  GROUP BY testcase_id ORDER BY id ASC  data：('pj_pos', '无计划', '20161130154217')
2016-11-30 15:42:21,546 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=148]步骤运行结果
2016-11-30 15:42:21,546 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_pos', '无计划', 148, '20161130154217')
2016-11-30 15:42:21,548 htmlreporter.py[line: 127] INFO: 正在查询测试计划[project：pj_pos, testplan：plan1_of_pos]已运行的测试用例
2016-11-30 15:42:21,549 mydb.py[line: 100] INFO: query：SELECT testcase_id, testcase_name, project, testplan FROM testcase_report_tb WHERE project=%s AND testplan=%s AND executed_history_id = %s  GROUP BY testcase_id ORDER BY id ASC  data：('pj_pos', 'plan1_of_pos', '20161130154217')
2016-11-30 15:42:21,551 htmlreporter.py[line: 158] INFO: 正在查询测试用例[id=152]步骤运行结果
2016-11-30 15:42:21,551 mydb.py[line: 100] INFO: query：SELECT step_id, step_num, protocol_method, protocol, HOST, PORT, step_action, expected_results, runresult, reason, runtime FROM case_step_report_tb WHERE project= %s AND testplan= %s AND testcase_id = %s AND executed_history_id = %s GROUP BY step_num ORDER BY step_num ASC  data：('pj_pos', 'plan1_of_pos', 152, '20161130154217')
2016-11-30 15:42:21,553 htmlreporter.py[line: 183] INFO: 正在设置测试报告结果文件名
2016-11-30 15:42:21,553 htmlreporter.py[line: 193] INFO: 测试报告文件名所在路径为：E:\\Projects\\report\\test_report20161130154217.html
2016-11-30 15:42:21,554 htmlreporter.py[line: 186] INFO: 正在生成测试报告
2016-11-30 15:42:21,555 main.py[line: 265] INFO: 生成测试报告成功
2016-11-30 15:42:21,652 main.py[line: 272] INFO: E:\\Projects\\report\\test_report20161130154217.html
2016-11-30 15:42:21,653 main.py[line: 275] INFO: 正在发送测试报告邮件...
2016-11-30 15:42:21,691 main.py[line: 279] INFO: 发送邮件成功
2016-11-30 15:42:23,139 global_var.py[line: 20] INFO: 当前运行环境：测试环境
2016-11-30 15:42:23,139 global_var.py[line: 21] INFO: 正在初始化数据库[名称：SAOFUDB1]对象
2016-11-30 15:42:23,159 global_var.py[line: 28] INFO: 正在初始化数据库[名称：TESTDB]对象
2016-11-30 15:42:23,162 global_var.py[line: 31] INFO: 正在获取testlink
2016-11-30 15:42:23,222 main.py[line: 57] INFO: 正在创建测试用例报告报表
2016-11-30 15:42:23,222 mydb.py[line: 43] INFO: query：CREATE TABLE IF NOT EXISTS testcase_report_tb                                         (id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,                                          executed_history_id varchar(50) NOT NULL,                                          testcase_id int NOT NULL,                                          testcase_name varchar(40) NOT NULL,                                          testsuit varchar(40),                                          testplan varchar(40),                                          project varchar(40),                                          runresult varchar(20),                                          runtime datetime)
2016-11-30 15:42:23,223 main.py[line: 60] INFO: 正在创建测试步骤报告报表
2016-11-30 15:42:23,223 mydb.py[line: 43] INFO: query：CREATE TABLE IF NOT EXISTS case_step_report_tb                                         (id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,                                          executed_history_id varchar(50) NOT NULL,                                          testcase_id int NOT NULL,                                          testcase_name varchar(40) NOT NULL,                                          testplan varchar(40) NOT NULL,                                          project varchar(40) NOT NULL,                                          step_id int,                                          step_num int NOT NULL,                                          step_action varchar(1000),                                           expected_results varchar(1000),                                          runresult varchar(10),                                          reason varchar(2000),                                          protocol_method varchar(40) ,                                          protocol varchar(40),                                          host varchar(40),                                          port int,                                          runtime datetime)
2016-11-30 15:42:23,225 main.py[line: 63] INFO: 正在读取运行模式配置
2016-11-30 15:42:23,227 main.py[line: 70] INFO: 正在运行全局初始化用例……
2016-11-30 15:42:23,228 main.py[line: 72] INFO: 待运行全局初始化用例id列表：[148]
2016-11-30 15:42:23,453 global_function.py[line: 19] INFO: 获取测试用例信息 [{'estimated_exec_duration': '', 'author_first_name': 'Testlink', 'updater_first_name': 'Testlink', 'testcase_id': '148', 'updater_last_name': 'Administrator', 'layout': '1', 'name': 'test-n-登陆掌贝pos机', 'full_tc_external_id': 'pj_pos-1', 'node_order': '1000', 'updater_id': '1', 'is_open': '1', 'version': '1', 'execution_type': '1', 'tc_external_id': '1', 'active': '1', 'id': '149', 'steps': [{'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;branch_id&quot;:1}<br />\n\t}</p>\n', 'step_number': '1', 'execution_type': '1', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT branch_id FROM account_operator WHERE id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;(1318,)&quot;</p>\n<p>\n\t}</p>\n', 'active': '1', 'id': '183'}, {'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;device_no&quot;:1,&quot;serial_no&quot;:2}<br />\n\t}</p>\n', 'step_number': '2', 'execution_type': '1', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;([CaseStep.branch_id],)&quot;</p>\n<p>\n\t}</p>\n', 'active': '1', 'id': '182'}, {'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;：&quot;键值相等&quot;,</p>\n<p>\n\t&quot;条件&quot;：[{&quot;模式&quot;：{&quot;success&quot;:true}, &quot;消息&quot;：&ldquo;登录失败，success不为true&rdquo;},{&quot;模式&quot;：｛&quot;message&quot;: &quot;成功&quot;},&quot;消息&quot;：&ldquo;message不为成功&rdquo;}，{&quot;模式&quot;：｛&quot;code&quot;: &quot;4001&quot;},&quot;消息&quot;：&ldquo;code不为4001&rdquo;}],</p>\n<p>\n\t&quot;输出&quot;:{&quot;Token&quot;:{&quot;token&quot;:&quot;value&quot;},&quot;OperatorId&quot;:{&quot;operator&quot;:{&quot;id&quot;:&quot;value&quot;}}}</p>\n<p>\n\t}</p>\n', 'step_number': '3', 'execution_type': '1', 'actions': '<p>\n\t{&ldquo;函数&rdquo;：&ldquo;<span style="background-color:#e4e4ff;">test_interface_of_json</span>&rdquo;，</p>\n<p>\n\t&ldquo;请求头&rdquo;： {&quot;<span style="color:#008080;font-weight:bold;">DeviceId&quot;</span>:&quot;[CaseStep.device_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;SerialNo&quot;</span>:&quot;[CaseStep.serial_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;Content-Type&quot;</span>:&quot;<span style="color:#008080;font-weight:bold;">application/json;charset=utf-8&quot;</span>,<span style="color:#008080;font-weight:bold;">&quot;ProductVersion&quot;</span>: &quot;[global_product_version]&quot;, <span style="color:#008080;font-weight:bold;">&quot;ProtocolVersion&quot;</span>:&quot;[global_protocol_version]&quot;},</p>\n<p>\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/saofu-client/password/login&quot;,<br />\n\t&quot;参数&quot;:{&quot;id&quot;:&quot;1318&quot;,&quot;password&quot;:&quot;e10adc3949ba59abbe56e057f20f883e&quot;}<br />\n\t}</p>\n', 'active': '1', 'id': '150'}], 'creation_ts': '2016-07-27 18:32:10', 'modification_ts': '2016-11-30 15:41:36', 'updater_login': 'admin', 'author_login': 'admin', 'status': '1', 'author_last_name': 'Administrator', 'importance': '2', 'author_id': '1', 'preconditions': '<p>\n\t初始化用例</p>\n', 'testsuite_id': '147', 'summary': ''}]
2016-11-30 15:42:23,610 global_function.py[line: 39] INFO: 正在读取套件[id=147]的协议，host，端口配置...
2016-11-30 15:42:24,235 global_function.py[line: 68] INFO: 记录测试用例到测试用例报表
2016-11-30 15:42:24,235 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130154223', 148, 'test-n-登陆掌贝pos机', '登陆接口', '无计划', 'pj_pos', 'Block', '')
2016-11-30 15:42:24,236 global_function.py[line: 71] INFO: 开始执行测试用例[id=148，name=test-n-登陆掌贝pos机]
2016-11-30 15:42:24,236 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行sql","单条查询":"SELECT branch_id FROM account_operator WHERE id = %s","参数":"(1318,)"}
2016-11-30 15:42:24,236 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","输出":{"branch_id":1}}
2016-11-30 15:42:24,237 testcase.py[line: 55] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 15:42:24,237 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130154223', 148, 'test-n-登陆掌贝pos机', '无计划', 'pj_pos', 183, 1, '', '', '192.168.9.211', '3306', '{"步骤类型":"执行sql","单条查询":"SELECT branch_id FROM account_operator WHERE id = %s","参数":"(1318,)"}', '{"检查":"body","输出":{"branch_id":1}}', 'Block', '', '')
2016-11-30 15:42:24,238 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 15:42:24,238 casestep.py[line: 108] INFO: 没找到需要替换的动态参数
2016-11-30 15:42:24,238 mydb.py[line: 84] INFO: query：SELECT branch_id FROM account_operator WHERE id = %s  data：(1318,)
2016-11-30 15:42:24,241 casestep.py[line: 188] INFO: 数据库服务器返回的查询结果为为 query_result:(1485916418,), flag:True
2016-11-30 15:42:24,242 casestep.py[line: 190] INFO: 正在保存服务器返回结果到自定义变量
2016-11-30 15:42:24,242 casestep.py[line: 225] INFO: 提取的输出结果(key-value对)为:[{'branch_id': 1485916418}]
2016-11-30 15:42:24,242 testcase.py[line: 155] INFO: 正在更新步骤执行结果
2016-11-30 15:42:24,242 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 15:42:24",step_action="{'步骤类型': '执行sql', '参数': (1318,), '单条查询': 'SELECT branch_id FROM account_operator WHERE id = %s'}", expected_results="{'检查': 'body', '输出': {'branch_id': 1}}" WHERE executed_history_id = 20161130154223 AND testcase_id = 148 AND step_id = 183 AND project='pj_pos' AND testplan='无计划'
2016-11-30 15:42:24,244 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"步骤类型":"执行sql","单条查询":"SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s","参数":"([CaseStep.branch_id],)"}
2016-11-30 15:42:24,245 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","输出":{"device_no":1,"serial_no":2}}
2016-11-30 15:42:24,245 testcase.py[line: 55] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 15:42:24,245 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130154223', 148, 'test-n-登陆掌贝pos机', '无计划', 'pj_pos', 182, 2, '', '', '192.168.9.211', '3306', '{"步骤类型":"执行sql","单条查询":"SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s","参数":"([CaseStep.branch_id],)"}', '{"检查":"body","输出":{"device_no":1,"serial_no":2}}', 'Block', '', '')
2016-11-30 15:42:24,246 testcase.py[line: 77] INFO: 开始执行步骤操作[第2步]
2016-11-30 15:42:24,247 casestep.py[line: 113] INFO: 找到待替换的非全局动态参数：[CaseStep.branch_id]
2016-11-30 15:42:24,247 casestep.py[line: 136] INFO: 转换后的参数体为：(1485916418,)
2016-11-30 15:42:24,247 mydb.py[line: 84] INFO: query：SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s  data：(1485916418,)
2016-11-30 15:42:24,250 casestep.py[line: 188] INFO: 数据库服务器返回的查询结果为为 query_result:('182590014248006', 'HZ501FZA0F9M07D'), flag:True
2016-11-30 15:42:24,250 casestep.py[line: 190] INFO: 正在保存服务器返回结果到自定义变量
2016-11-30 15:42:24,250 casestep.py[line: 225] INFO: 提取的输出结果(key-value对)为:[{'branch_id': 1485916418}, {'device_no': '182590014248006'}, {'serial_no': 'HZ501FZA0F9M07D'}]
2016-11-30 15:42:24,250 testcase.py[line: 155] INFO: 正在更新步骤执行结果
2016-11-30 15:42:24,250 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="无", runtime="2016-11-30 15:42:24",step_action="{'步骤类型': '执行sql', '参数': (1485916418,), '单条查询': 'SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s'}", expected_results="{'检查': 'body', '输出': {'serial_no': 2, 'device_no': 1}}" WHERE executed_history_id = 20161130154223 AND testcase_id = 148 AND step_id = 182 AND project='pj_pos' AND testplan='无计划'
2016-11-30 15:42:24,252 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"函数":"test_interface_of_json","请求头": {"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion": "[global_product_version]", "ProtocolVersion":"[global_protocol_version]"},"方法":"post","url":"/saofu-client/password/login","参数":{"id":"1318","password":"e10adc3949ba59abbe56e057f20f883e"}}
2016-11-30 15:42:24,253 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"键值相等","条件":[{"模式":{"success":true}, "消息":"登录失败,success不为true"},{"模式":{"message": "成功"},"消息":"message不为成功"},{"模式":{"code": "4001"},"消息":"code不为4001"}],"输出":{"Token":{"token":"value"},"OperatorId":{"operator":{"id":"value"}}}}
2016-11-30 15:42:24,253 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 15:42:24,253 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130154223', 148, 'test-n-登陆掌贝pos机', '无计划', 'pj_pos', 150, 3, '', 'https', 'saofu.client.test.saofu.cn', 443, '{"函数":"test_interface_of_json","请求头": {"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion": "[global_product_version]", "ProtocolVersion":"[global_protocol_version]"},"方法":"post","url":"/saofu-client/password/login","参数":{"id":"1318","password":"e10adc3949ba59abbe56e057f20f883e"}}', '{"检查":"body","匹配规则":"键值相等","条件":[{"模式":{"success":true}, "消息":"登录失败,success不为true"},{"模式":{"message": "成功"},"消息":"message不为成功"},{"模式":{"code": "4001"},"消息":"code不为4001"}],"输出":{"Token":{"token":"value"},"OperatorId":{"operator":{"id":"value"}}}}', 'Block', '', '')
2016-11-30 15:42:24,254 testcase.py[line: 77] INFO: 开始执行步骤操作[第3步]
2016-11-30 15:42:24,255 casestep.py[line: 158] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_json
2016-11-30 15:42:24,255 casestep.py[line: 102] INFO: 转换后的参数体为：{'password': 'e10adc3949ba59abbe56e057f20f883e', 'id': '1318'}
2016-11-30 15:42:24,255 casestep.py[line: 108] INFO: 没找到需要替换的动态参数
2016-11-30 15:42:24,255 casestep.py[line: 79] INFO: 找到待替换的非全局动态参数：[CaseStep.device_no]
2016-11-30 15:42:24,255 casestep.py[line: 93] INFO: 找到待替换的全局动态参数：[global_protocol_version]
2016-11-30 15:42:24,255 casestep.py[line: 93] INFO: 找到待替换的全局动态参数：[global_product_version]
2016-11-30 15:42:24,255 casestep.py[line: 79] INFO: 找到待替换的非全局动态参数：[CaseStep.serial_no]
2016-11-30 15:42:24,255 casestep.py[line: 102] INFO: 转换后的参数体为：{'Content-Type': 'application/json;charset=utf-8', 'DeviceId': '182590014248006', 'ProtocolVersion': '4.0', 'ProductVersion': '3.2.12C', 'SerialNo': 'HZ501FZA0F9M07D'}
2016-11-30 15:42:24,255 InterfaceUnittestTestCase.py[line: 88] INFO: 正在发起POST请求...
2016-11-30 15:42:24,256 httpprotocol.py[line: 74] INFO: 发起的请求为：https://saofu.client.test.saofu.cn:443/saofu-client/password/login
2016-11-30 15:42:24,256 httpprotocol.py[line: 75] INFO: 参数为：b'{"password": "e10adc3949ba59abbe56e057f20f883e", "id": "1318"}'
2016-11-30 15:42:24,256 httpprotocol.py[line: 76] INFO: 请求头为：{'Content-Type': 'application/json;charset=utf-8', 'DeviceId': '182590014248006', 'ProductVersion': '3.2.12C', 'SerialNo': 'HZ501FZA0F9M07D', 'ProtocolVersion': '4.0'}
2016-11-30 15:42:27,326 InterfaceUnittestTestCase.py[line: 98] INFO: 正在对服务器返回body进行解码
2016-11-30 15:42:27,326 InterfaceUnittestTestCase.py[line: 112] INFO: 服务器返回结果"响应体(body)": {"attach":["flag_appointment","flag_app_xiaoer","flag_cardcupon","flag_cash","flag_help_center","flag_info_center","flag_in_shop","flag_lake","flag_mt_wm","flag_order","flag_qrscan","flag_queue","flag_zhanggui"],"branchSerial":"cao","code":"4001","merchantKey":"10549840601068216320","message":"成功","operator":{"id":1318,"name":"接口测试","number":"1"},"reason":"成功","shopId":"1485916418","success":true,"token":"b02b084d-54e7-44fc-bac9-451d34f4382f"}
2016-11-30 15:42:27,326 InterfaceUnittestTestCase.py[line: 113] INFO: 服务器返回结果"请求头(headers)": [('Server', 'nginx/1.8.0'), ('Date', 'Wed, 30 Nov 2016 07:42:29 GMT'), ('Content-Type', 'application/json;charset=UTF-8'), ('Transfer-Encoding', 'chunked'), ('Connection', 'close'), ('EXCLUDE_ENCRYPT', 'true'), ('Vary', 'Accept-Encoding')]
2016-11-30 15:42:27,326 InterfaceUnittestTestCase.py[line: 114] INFO: 服务器返回结果"状态码(code)": 200
2016-11-30 15:42:27,327 unittesttestcase.py[line: 106] INFO: 要匹配的字典key,value层级为：['success', True]
2016-11-30 15:42:27,327 unittesttestcase.py[line: 109] INFO: 找到的对应字典层级的最后值为：True
2016-11-30 15:42:27,327 unittesttestcase.py[line: 106] INFO: 要匹配的字典key,value层级为：['message', '成功']
2016-11-30 15:42:27,327 unittesttestcase.py[line: 109] INFO: 找到的对应字典层级的最后值为：成功
2016-11-30 15:42:27,327 unittesttestcase.py[line: 106] INFO: 要匹配的字典key,value层级为：['code', '4001']
2016-11-30 15:42:27,327 unittesttestcase.py[line: 109] INFO: 找到的对应字典层级的最后值为：4001
2016-11-30 15:42:27,327 unittesttestcase.py[line: 225] INFO: 要提取的字典key,value层级为：['token', 'value']
2016-11-30 15:42:27,328 unittesttestcase.py[line: 239] INFO: 找到的对应字典层级的key的值为：b02b084d-54e7-44fc-bac9-451d34f4382f
2016-11-30 15:42:27,328 unittesttestcase.py[line: 263] INFO: 获取到的变量的值为：b02b084d-54e7-44fc-bac9-451d34f4382f
2016-11-30 15:42:27,328 unittesttestcase.py[line: 225] INFO: 要提取的字典key,value层级为：['operator', 'id', 'value']
2016-11-30 15:42:27,328 unittesttestcase.py[line: 239] INFO: 找到的对应字典层级的key的值为：1318
2016-11-30 15:42:27,328 unittesttestcase.py[line: 263] INFO: 获取到的变量的值为：1318
2016-11-30 15:42:27,328 unittesttestcase.py[line: 290] INFO: 提取的输出结果(key-value对)为:[{'Token': 'b02b084d-54e7-44fc-bac9-451d34f4382f'}, {'OperatorId': 1318}]
2016-11-30 15:42:27,328 testcase.py[line: 155] INFO: 正在更新步骤执行结果
2016-11-30 15:42:27,328 mydb.py[line: 70] INFO: query：UPDATE case_step_report_tb SET runresult="Pass",reason="", protocol_method="post", runtime="2016-11-30 15:42:24",step_action="{'请求头': {'Content-Type': 'application/json;charset=utf-8', 'DeviceId': '182590014248006', 'ProtocolVersion': '4.0', 'ProductVersion': '3.2.12C', 'SerialNo': 'HZ501FZA0F9M07D'}, '参数': {'password': 'e10adc3949ba59abbe56e057f20f883e', 'id': '1318'}, 'url': '/saofu-client/password/login', '方法': 'post', '函数': 'test_interface_of_json'}", expected_results="{'检查': 'body', '条件': [{'消息': '登录失败,success不为true', '模式': {'success': True}}, {'消息': 'message不为成功', '模式': {'message': '成功'}}, {'消息': 'code不为4001', '模式': {'code': '4001'}}], '输出': {'Token': {'token': 'value'}, 'OperatorId': {'operator': {'id': 'value'}}}, '匹配规则': '键值相等'}" WHERE executed_history_id = 20161130154223 AND testcase_id = 148 AND step_id = 150 AND project='pj_pos' AND testplan='无计划'
2016-11-30 15:42:27,334 testcase.py[line: 158] INFO: 测试用例[id=148, name=test-n-登陆掌贝pos机]执行成功
2016-11-30 15:42:27,334 global_function.py[line: 75] INFO: 正在更新用例执行结果
2016-11-30 15:42:27,334 mydb.py[line: 70] INFO: query：UPDATE testcase_report_tb SET runresult="Pass", runtime="2016-11-30 15:42:24" WHERE executed_history_id = 20161130154223 and testcase_id = 148 AND project='pj_pos' AND testplan='无计划'
2016-11-30 15:42:27,335 global_function.py[line: 82] INFO: 指定用例[148]已执行完
2016-11-30 15:42:27,336 main.py[line: 75] INFO: 用例[148]运行结果：('Pass', '')
2016-11-30 15:42:27,336 main.py[line: 78] INFO: 按项目运行测试
2016-11-30 15:42:27,336 main.py[line: 115] INFO: 运行指定项目
2016-11-30 15:42:27,448 main.py[line: 131] INFO: 正在读取测项目[id：145, project：pj_pos]的协议，host，端口配置...
2016-11-30 15:42:27,448 main.py[line: 134] INFO: 成功读取配置信息：{"protocol":"https","host":"saofu.client.test.saofu.cn","port":443}
2016-11-30 15:42:27,449 main.py[line: 150] INFO: 正在执行测试项目[id：145, project：pj_pos]
2016-11-30 15:42:27,450 testproject.py[line: 23] INFO: 正在获取测试项目[id：145, name：pj_pos]对应对应的测试计划名称列表
2016-11-30 15:42:27,585 testproject.py[line: 28] INFO: 成功获取项目测试计划名称列表[list=['plan1_of_pos']]
2016-11-30 15:42:27,740 testproject.py[line: 38] INFO: 正在执行项目测试计划[project：pj_pos，testplan：plan1_of_pos]
2016-11-30 15:42:27,741 testplan.py[line: 29] INFO: 正在获取测试计划[project=pj_pos，name=plan1_of_pos]的测试用例
2016-11-30 15:42:27,873 testplan.py[line: 35] INFO: 成功获取测试计划[project=pj_pos，name=plan1_of_pos]的测试用例id：dict_keys(['148', '152'])
2016-11-30 15:42:27,994 testplan.py[line: 45] INFO: 获取测试用例信息 [{'estimated_exec_duration': '', 'author_first_name': 'Testlink', 'updater_first_name': 'Testlink', 'testcase_id': '148', 'updater_last_name': 'Administrator', 'layout': '1', 'name': 'test-n-登陆掌贝pos机', 'full_tc_external_id': 'pj_pos-1', 'node_order': '1000', 'updater_id': '1', 'is_open': '1', 'version': '1', 'execution_type': '1', 'tc_external_id': '1', 'active': '1', 'id': '149', 'steps': [{'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;branch_id&quot;:1}<br />\n\t}</p>\n', 'step_number': '1', 'execution_type': '1', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT branch_id FROM account_operator WHERE id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;(1318,)&quot;</p>\n<p>\n\t}</p>\n', 'active': '1', 'id': '183'}, {'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,<br />\n\t&quot;输出&quot;:{&quot;device_no&quot;:1,&quot;serial_no&quot;:2}<br />\n\t}</p>\n', 'step_number': '2', 'execution_type': '1', 'actions': '<p>\n\t{</p>\n<p>\n\t&quot;步骤类型&quot;:&quot;执行sql&quot;,</p>\n<p>\n\t&quot;单条查询&quot;:&quot;SELECT device_no, serial_no FROM device WHERE shop_branch_id = %s&quot;,</p>\n<p>\n\t&quot;参数&quot;:&quot;([CaseStep.branch_id],)&quot;</p>\n<p>\n\t}</p>\n', 'active': '1', 'id': '182'}, {'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;：&quot;键值相等&quot;,</p>\n<p>\n\t&quot;条件&quot;：[{&quot;模式&quot;：{&quot;success&quot;:true}, &quot;消息&quot;：&ldquo;登录失败，success不为true&rdquo;},{&quot;模式&quot;：｛&quot;message&quot;: &quot;成功&quot;},&quot;消息&quot;：&ldquo;message不为成功&rdquo;}，{&quot;模式&quot;：｛&quot;code&quot;: &quot;4001&quot;},&quot;消息&quot;：&ldquo;code不为4001&rdquo;}],</p>\n<p>\n\t&quot;输出&quot;:{&quot;Token&quot;:{&quot;token&quot;:&quot;value&quot;},&quot;OperatorId&quot;:{&quot;operator&quot;:{&quot;id&quot;:&quot;value&quot;}}}</p>\n<p>\n\t}</p>\n', 'step_number': '3', 'execution_type': '1', 'actions': '<p>\n\t{&ldquo;函数&rdquo;：&ldquo;<span style="background-color:#e4e4ff;">test_interface_of_json</span>&rdquo;，</p>\n<p>\n\t&ldquo;请求头&rdquo;： {&quot;<span style="color:#008080;font-weight:bold;">DeviceId&quot;</span>:&quot;[CaseStep.device_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;SerialNo&quot;</span>:&quot;[CaseStep.serial_no]&quot;, <span style="color:#008080;font-weight:bold;">&quot;Content-Type&quot;</span>:&quot;<span style="color:#008080;font-weight:bold;">application/json;charset=utf-8&quot;</span>,<span style="color:#008080;font-weight:bold;">&quot;ProductVersion&quot;</span>: &quot;[global_product_version]&quot;, <span style="color:#008080;font-weight:bold;">&quot;ProtocolVersion&quot;</span>:&quot;[global_protocol_version]&quot;},</p>\n<p>\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/saofu-client/password/login&quot;,<br />\n\t&quot;参数&quot;:{&quot;id&quot;:&quot;1318&quot;,&quot;password&quot;:&quot;e10adc3949ba59abbe56e057f20f883e&quot;}<br />\n\t}</p>\n', 'active': '1', 'id': '150'}], 'creation_ts': '2016-07-27 18:32:10', 'modification_ts': '2016-11-30 15:41:36', 'updater_login': 'admin', 'author_login': 'admin', 'status': '1', 'author_last_name': 'Administrator', 'importance': '2', 'author_id': '1', 'preconditions': '<p>\n\t初始化用例</p>\n', 'testsuite_id': '147', 'summary': ''}]
2016-11-30 15:42:27,994 testplan.py[line: 52] INFO: 用例[id=148, name=test-n-登陆掌贝pos机]为全局初始化用例，已跳过执行
2016-11-30 15:42:28,120 testplan.py[line: 45] INFO: 获取测试用例信息 [{'estimated_exec_duration': '', 'author_first_name': 'Testlink', 'updater_first_name': 'Testlink', 'testcase_id': '152', 'updater_last_name': 'Administrator', 'layout': '1', 'name': 'test-n-修改积分', 'full_tc_external_id': 'pj_pos-2', 'node_order': '1000', 'updater_id': '1', 'is_open': '1', 'version': '1', 'execution_type': '1', 'tc_external_id': '2', 'active': '1', 'id': '153', 'steps': [{'expected_results': '<p>\n\t{&quot;检查&quot;:&quot;body&quot;,</p>\n<p>\n\t&quot;匹配规则&quot;:&quot;包含字符串&quot;,</p>\n<p>\n\t&quot;条件&quot;:[{&quot;模式&quot;:&quot;success\\&quot;:true&quot;, &quot;消息&quot;:&quot;修改积分失败&quot;}]</p>\n<p>\n\t}</p>\n', 'step_number': '1', 'execution_type': '1', 'actions': '<p>\n\t<br />\n\t{&quot;函数&quot;：&quot;test_interface_of_json&quot;，</p>\n<p>\n\t&quot;请求头&quot;:{&quot;DeviceId&quot;:&quot;[CaseStep.device_no]&quot;, &quot;SerialNo&quot;:&quot;[CaseStep.serial_no]&quot;, &quot;Content-Type&quot;:&quot;application/json;charset=utf-8&quot;,&quot;ProductVersion&quot;:&quot;[global_product_version]&quot;,&quot;ProtocolVersion&quot;:&quot;[global_product_version]&quot;,&quot;OperatorId&quot;:&quot;[OperatorId]&quot;, &quot;Token&quot;:&quot;[Token]&quot;},</p>\n<p>\n\t&quot;方法&quot;:&quot;post&quot;,<br />\n\t&quot;url&quot;:&quot;/saofu-client/customer/customer_bonus_update_v3&quot;,<br />\n\t&quot;参数&quot;:{&quot;bonus&quot;:37593,&quot;code&quot;:&quot;17817738178&quot;}<br />\n\t}<br />\n\t&nbsp;</p>\n', 'active': '1', 'id': '154'}], 'creation_ts': '2016-07-28 12:10:09', 'modification_ts': '2016-11-30 00:19:08', 'updater_login': 'admin', 'author_login': 'admin', 'status': '1', 'author_last_name': 'Administrator', 'importance': '2', 'author_id': '1', 'preconditions': '', 'testsuite_id': '151', 'summary': ''}]
2016-11-30 15:42:28,233 testplan.py[line: 69] INFO: 记录测试用例到测试用例报表
2016-11-30 15:42:28,233 mydb.py[line: 56] INFO: query：INSERT INTO testcase_report_tb(executed_history_id, testcase_id, testcase_name, testsuit, testplan, project, runresult, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130154223', 152, 'test-n-修改积分', '扫码-修改积分接口', 'plan1_of_pos', 'pj_pos', 'Block', '')
2016-11-30 15:42:28,234 testplan.py[line: 72] INFO: 开始执行测试用例[id=152，name=test-n-修改积分]
2016-11-30 15:42:28,234 testcase.py[line: 39] INFO: 转换来自test_link 的step_action值为：{"函数":"test_interface_of_json","请求头":{"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion":"[global_product_version]","ProtocolVersion":"[global_product_version]","OperatorId":"[OperatorId]", "Token":"[Token]"},"方法":"post","url":"/saofu-client/customer/customer_bonus_update_v3","参数":{"bonus":37593,"code":"17817738178"}} 
2016-11-30 15:42:28,235 testcase.py[line: 41] INFO: 转换来自test_link 的expected_results值为：{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"success\":true", "消息":"修改积分失败"}]}
2016-11-30 15:42:28,235 testcase.py[line: 60] INFO: 记录测试步骤到测试步骤报告表
2016-11-30 15:42:28,235 mydb.py[line: 56] INFO: query：INSERT INTO case_step_report_tb(executed_history_id, testcase_id, testcase_name, testplan, project, step_id, step_num, protocol_method, protocol, host, port, step_action, expected_results, runresult, reason, runtime) VALUES(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)  data：('20161130154223', 152, 'test-n-修改积分', 'plan1_of_pos', 'pj_pos', 154, 1, '', 'https', 'saofu.client.test.saofu.cn', 443, '{"函数":"test_interface_of_json","请求头":{"DeviceId":"[CaseStep.device_no]", "SerialNo":"[CaseStep.serial_no]", "Content-Type":"application/json;charset=utf-8","ProductVersion":"[global_product_version]","ProtocolVersion":"[global_product_version]","OperatorId":"[OperatorId]", "Token":"[Token]"},"方法":"post","url":"/saofu-client/customer/customer_bonus_update_v3","参数":{"bonus":37593,"code":"17817738178"}} ', '{"检查":"body","匹配规则":"包含字符串","条件":[{"模式":"success\\":true", "消息":"修改积分失败"}]}', 'Block', '', '')
2016-11-30 15:42:28,236 testcase.py[line: 77] INFO: 开始执行步骤操作[第1步]
2016-11-30 15:42:28,236 casestep.py[line: 158] INFO: 调用的方法为：InterfaceUnittestTestCase.test_interface_of_json
